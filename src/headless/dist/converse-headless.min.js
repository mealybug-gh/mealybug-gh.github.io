!function(e){function t(t){for(var n,i,o=t[0],s=t[1],a=0,c=[];a<o.length;a++)i=o[a],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&c.push(r[i][0]),r[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(u&&u(t);c.length;)c.shift()()}var n={},r={1:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,i){n=r[e]=[t,i]}));t.push(n[2]=o);var s,a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(e){return i.p+""+({0:"emojis"}[e]||e)+".js"}(e);var u=new Error;s=function(t){a.onerror=a.onload=null,clearTimeout(c);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",u.name="ChunkLoadError",u.type=i,u.request=o,n[1](u)}r[e]=void 0}};var c=setTimeout((function(){s({type:"timeout",target:a})}),12e4);a.onerror=a.onload=s,document.head.appendChild(a)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp=window.webpackJsonp||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var a=0;a<o.length;a++)t(o[a]);var u=s;i(i.s=325)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return w})),n.d(t,"f",(function(){return S})),n.d(t,"e",(function(){return m.a}));var r=n(5);const i=function(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n},o=function(e){if("string"!=typeof e)throw new Error("str2binl was passed a non-string");const t=[];for(let n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t},s=function(e,t,n,r,o,s){return i((a=i(i(t,e),i(r,s)))<<(u=o)|a>>>32-u,n);var a,u},a=function(e,t,n,r,i,o,a){return s(t&n|~t&r,e,t,i,o,a)},u=function(e,t,n,r,i,o,a){return s(t&r|n&~r,e,t,i,o,a)},c=function(e,t,n,r,i,o,a){return s(t^n^r,e,t,i,o,a)},d=function(e,t,n,r,i,o,a){return s(n^(t|~r),e,t,i,o,a)},l=function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let n,r,o,s,l=1732584193,f=-271733879,h=-1732584194,p=271733878;for(let t=0;t<e.length;t+=16)n=l,r=f,o=h,s=p,l=a(l,f,h,p,e[t+0],7,-680876936),p=a(p,l,f,h,e[t+1],12,-389564586),h=a(h,p,l,f,e[t+2],17,606105819),f=a(f,h,p,l,e[t+3],22,-1044525330),l=a(l,f,h,p,e[t+4],7,-176418897),p=a(p,l,f,h,e[t+5],12,1200080426),h=a(h,p,l,f,e[t+6],17,-1473231341),f=a(f,h,p,l,e[t+7],22,-45705983),l=a(l,f,h,p,e[t+8],7,1770035416),p=a(p,l,f,h,e[t+9],12,-1958414417),h=a(h,p,l,f,e[t+10],17,-42063),f=a(f,h,p,l,e[t+11],22,-1990404162),l=a(l,f,h,p,e[t+12],7,1804603682),p=a(p,l,f,h,e[t+13],12,-40341101),h=a(h,p,l,f,e[t+14],17,-1502002290),f=a(f,h,p,l,e[t+15],22,1236535329),l=u(l,f,h,p,e[t+1],5,-165796510),p=u(p,l,f,h,e[t+6],9,-1069501632),h=u(h,p,l,f,e[t+11],14,643717713),f=u(f,h,p,l,e[t+0],20,-373897302),l=u(l,f,h,p,e[t+5],5,-701558691),p=u(p,l,f,h,e[t+10],9,38016083),h=u(h,p,l,f,e[t+15],14,-660478335),f=u(f,h,p,l,e[t+4],20,-405537848),l=u(l,f,h,p,e[t+9],5,568446438),p=u(p,l,f,h,e[t+14],9,-1019803690),h=u(h,p,l,f,e[t+3],14,-187363961),f=u(f,h,p,l,e[t+8],20,1163531501),l=u(l,f,h,p,e[t+13],5,-1444681467),p=u(p,l,f,h,e[t+2],9,-51403784),h=u(h,p,l,f,e[t+7],14,1735328473),f=u(f,h,p,l,e[t+12],20,-1926607734),l=c(l,f,h,p,e[t+5],4,-378558),p=c(p,l,f,h,e[t+8],11,-2022574463),h=c(h,p,l,f,e[t+11],16,1839030562),f=c(f,h,p,l,e[t+14],23,-35309556),l=c(l,f,h,p,e[t+1],4,-1530992060),p=c(p,l,f,h,e[t+4],11,1272893353),h=c(h,p,l,f,e[t+7],16,-155497632),f=c(f,h,p,l,e[t+10],23,-1094730640),l=c(l,f,h,p,e[t+13],4,681279174),p=c(p,l,f,h,e[t+0],11,-358537222),h=c(h,p,l,f,e[t+3],16,-722521979),f=c(f,h,p,l,e[t+6],23,76029189),l=c(l,f,h,p,e[t+9],4,-640364487),p=c(p,l,f,h,e[t+12],11,-421815835),h=c(h,p,l,f,e[t+15],16,530742520),f=c(f,h,p,l,e[t+2],23,-995338651),l=d(l,f,h,p,e[t+0],6,-198630844),p=d(p,l,f,h,e[t+7],10,1126891415),h=d(h,p,l,f,e[t+14],15,-1416354905),f=d(f,h,p,l,e[t+5],21,-57434055),l=d(l,f,h,p,e[t+12],6,1700485571),p=d(p,l,f,h,e[t+3],10,-1894986606),h=d(h,p,l,f,e[t+10],15,-1051523),f=d(f,h,p,l,e[t+1],21,-2054922799),l=d(l,f,h,p,e[t+8],6,1873313359),p=d(p,l,f,h,e[t+15],10,-30611744),h=d(h,p,l,f,e[t+6],15,-1560198380),f=d(f,h,p,l,e[t+13],21,1309151649),l=d(l,f,h,p,e[t+4],6,-145523070),p=d(p,l,f,h,e[t+11],10,-1120210379),h=d(h,p,l,f,e[t+2],15,718787259),f=d(f,h,p,l,e[t+9],21,-343485551),l=i(l,n),f=i(f,r),h=i(h,o),p=i(p,s);return[l,f,h,p]},f={hexdigest:function(e){return function(e){let t="";for(let n=0;n<4*e.length;n++)t+="0123456789abcdef".charAt(e[n>>2]>>n%4*8+4&15)+"0123456789abcdef".charAt(e[n>>2]>>n%4*8&15);return t}(l(o(e),8*e.length))},hash:function(e){return function(e){let t="";for(let n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}(l(o(e),8*e.length))}};class h{constructor(e,t,n){this.mechname=e,this.isClientFirst=t,this.priority=n}test(){return!0}onStart(e){this._connection=e}onChallenge(e,t){throw new Error("You should implement challenge handling!")}clientChallenge(e){if(!this.isClientFirst)throw new Error("clientChallenge should not be called if isClientFirst is false!");return this.onChallenge(e)}onFailure(){this._connection=null}onSuccess(){this._connection=null}}const p=function(e){var t,n,r="",i=e.length;for(t=0;t<i;t++)(n=e.charCodeAt(t))>=0&&n<=127?r+=e.charAt(t):n>2047?(r+=String.fromCharCode(224|n>>12&15),r+=String.fromCharCode(128|n>>6&63),r+=String.fromCharCode(128|n>>0&63)):(r+=String.fromCharCode(192|n>>6&31),r+=String.fromCharCode(128|n>>0&63));return r},g=function(e){e=e||{};for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let n="",r="",i="";const o=e[t],s="object"==typeof o,a=escape(unescape(s?o.value:o));s&&(n=o.expires?";expires="+o.expires:"",r=o.domain?";domain="+o.domain:"",i=o.path?";path="+o.path:""),document.cookie=t+"="+a+n+r+i}};var m=n(4);var v=n(34);function _(e,t){return new S.Builder(e,t)}function y(e){return new S.Builder("message",e)}function b(e){return new S.Builder("iq",e)}function w(e){return new S.Builder("presence",e)}const S={VERSION:"1.4.1",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag(e){for(let t=0;t<S.XHTML.tags.length;t++)if(e===S.XHTML.tags[t])return!0;return!1},validAttribute(e,t){if(void 0!==S.XHTML.attributes[e]&&S.XHTML.attributes[e].length>0)for(let n=0;n<S.XHTML.attributes[e].length;n++)if(t===S.XHTML.attributes[e][n])return!0;return!1},validCSS(e){for(let t=0;t<S.XHTML.css.length;t++)if(e===S.XHTML.css[t])return!0;return!1}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8,REDIRECT:9,CONNTIMEOUT:10,BINDREQUIRED:11,ATTACHFAIL:12},ErrorCondition:{BAD_FORMAT:"bad-format",CONFLICT:"conflict",MISSING_JID_NODE:"x-strophe-bad-non-anon-jid",NO_AUTH_MECH:"no-auth-mech",UNKNOWN_REASON:"unknown"},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace(e,t){S.NS[e]=t},forEachChild(e,t,n){for(let r=0;r<e.childNodes.length;r++){const i=e.childNodes[r];i.nodeType!==S.ElementType.NORMAL||t&&!this.isTagEqual(i,t)||n(i)}},isTagEqual:(e,t)=>e.tagName===t,_xmlGenerator:null,xmlGenerator:()=>(S._xmlGenerator||(S._xmlGenerator=r.c()),S._xmlGenerator),xmlElement(e){if(!e)return null;const t=S.xmlGenerator().createElement(e);for(let e=1;e<arguments.length;e++){const n=arguments[e];if(n)if("string"==typeof n||"number"==typeof n)t.appendChild(S.xmlTextNode(n));else if("object"==typeof n&&"function"==typeof n.sort)for(let e=0;e<n.length;e++){const r=n[e];"object"==typeof r&&"function"==typeof r.sort&&void 0!==r[1]&&null!==r[1]&&t.setAttribute(r[0],r[1])}else if("object"==typeof n)for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&void 0!==n[e]&&null!==n[e]&&t.setAttribute(e,n[e])}return t},xmlescape:e=>e=(e=(e=(e=(e=e.replace(/\&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;"),xmlunescape:e=>e=(e=(e=(e=(e=e.replace(/\&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"'),xmlTextNode:e=>S.xmlGenerator().createTextNode(e),xmlHtmlNode(e){let t;if(r.a){t=(new r.a).parseFromString(e,"text/xml")}else t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e);return t},getText(e){if(!e)return null;let t="";0===e.childNodes.length&&e.nodeType===S.ElementType.TEXT&&(t+=e.nodeValue);for(let n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType===S.ElementType.TEXT&&(t+=e.childNodes[n].nodeValue);return S.xmlescape(t)},copyElement(e){let t;if(e.nodeType===S.ElementType.NORMAL){t=S.xmlElement(e.tagName);for(let n=0;n<e.attributes.length;n++)t.setAttribute(e.attributes[n].nodeName,e.attributes[n].value);for(let n=0;n<e.childNodes.length;n++)t.appendChild(S.copyElement(e.childNodes[n]))}else e.nodeType===S.ElementType.TEXT&&(t=S.xmlGenerator().createTextNode(e.nodeValue));return t},createHtml(e){let t;if(e.nodeType===S.ElementType.NORMAL){const n=e.nodeName.toLowerCase();if(S.XHTML.validTag(n))try{t=S.xmlElement(n);for(let r=0;r<S.XHTML.attributes[n].length;r++){const i=S.XHTML.attributes[n][r];let o=e.getAttribute(i);if(null!=o&&""!==o&&!1!==o&&0!==o)if("style"===i&&"object"==typeof o&&void 0!==o.cssText&&(o=o.cssText),"style"===i){const e=[],n=o.split(";");for(let t=0;t<n.length;t++){const r=n[t].split(":"),i=r[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();if(S.XHTML.validCSS(i)){const t=r[1].replace(/^\s*/,"").replace(/\s*$/,"");e.push(i+": "+t)}}e.length>0&&(o=e.join("; "),t.setAttribute(i,o))}else t.setAttribute(i,o)}for(let n=0;n<e.childNodes.length;n++)t.appendChild(S.createHtml(e.childNodes[n]))}catch(e){t=S.xmlTextNode("")}else{t=S.xmlGenerator().createDocumentFragment();for(let n=0;n<e.childNodes.length;n++)t.appendChild(S.createHtml(e.childNodes[n]))}}else if(e.nodeType===S.ElementType.FRAGMENT){t=S.xmlGenerator().createDocumentFragment();for(let n=0;n<e.childNodes.length;n++)t.appendChild(S.createHtml(e.childNodes[n]))}else e.nodeType===S.ElementType.TEXT&&(t=S.xmlTextNode(e.nodeValue));return t},escapeNode:e=>"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40"),unescapeNode:e=>"string"!=typeof e?e:e.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\"),getNodeFromJid:e=>e.indexOf("@")<0?null:e.split("@")[0],getDomainFromJid(e){const t=S.getBareJidFromJid(e);if(t.indexOf("@")<0)return t;{const e=t.split("@");return e.splice(0,1),e.join("@")}},getResourceFromJid(e){if(!e)return null;const t=e.split("/");return t.length<2?null:(t.splice(0,1),t.join("/"))},getBareJidFromJid:e=>e?e.split("/")[0]:null,_handleError(e){void 0!==e.stack&&S.fatal(e.stack),e.sourceURL?S.fatal("error: "+this.handler+" "+e.sourceURL+":"+e.line+" - "+e.name+": "+e.message):e.fileName?S.fatal("error: "+this.handler+" "+e.fileName+":"+e.lineNumber+" - "+e.name+": "+e.message):S.fatal("error: "+e.message)},log(e,t){var n;e===this.LogLevel.FATAL&&(null===(n=console)||void 0===n||n.error(t))},debug(e){this.log(this.LogLevel.DEBUG,e)},info(e){this.log(this.LogLevel.INFO,e)},warn(e){this.log(this.LogLevel.WARN,e)},error(e){this.log(this.LogLevel.ERROR,e)},fatal(e){this.log(this.LogLevel.FATAL,e)},serialize(e){if(!e)return null;"function"==typeof e.tree&&(e=e.tree());const t=[...Array(e.attributes.length).keys()].map(t=>e.attributes[t].nodeName);t.sort();let n=t.reduce((t,n)=>`${t} ${n}="${S.xmlescape(e.attributes.getNamedItem(n).value)}"`,"<"+e.nodeName);if(e.childNodes.length>0){n+=">";for(let t=0;t<e.childNodes.length;t++){const r=e.childNodes[t];switch(r.nodeType){case S.ElementType.NORMAL:n+=S.serialize(r);break;case S.ElementType.TEXT:n+=S.xmlescape(r.nodeValue);break;case S.ElementType.CDATA:n+="<![CDATA["+r.nodeValue+"]]>"}}n+="</"+e.nodeName+">"}else n+="/>";return n},_requestId:0,_connectionPlugins:{},addConnectionPlugin(e,t){S._connectionPlugins[e]=t},Builder:class{constructor(e,t){"presence"!==e&&"message"!==e&&"iq"!==e||(t&&!t.xmlns?t.xmlns=S.NS.CLIENT:t||(t={xmlns:S.NS.CLIENT})),this.nodeTree=S.xmlElement(e,t),this.node=this.nodeTree}tree(){return this.nodeTree}toString(){return S.serialize(this.nodeTree)}up(){return this.node=this.node.parentNode,this}root(){return this.node=this.nodeTree,this}attrs(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(void 0===e[t]?this.node.removeAttribute(t):this.node.setAttribute(t,e[t]));return this}c(e,t,n){const r=S.xmlElement(e,t,n);return this.node.appendChild(r),"string"!=typeof n&&"number"!=typeof n&&(this.node=r),this}cnode(e){let t;const n=S.xmlGenerator();try{t=void 0!==n.importNode}catch(e){t=!1}const r=t?n.importNode(e,!0):S.copyElement(e);return this.node.appendChild(r),this.node=r,this}t(e){const t=S.xmlTextNode(e);return this.node.appendChild(t),this}h(e){const t=S.xmlGenerator().createElement("body");t.innerHTML=e;const n=S.createHtml(t);for(;n.childNodes.length>0;)this.node.appendChild(n.childNodes[0]);return this}},Handler:function(e,t,n,r,i,o,s){this.handler=e,this.ns=t,this.name=n,this.type=r,this.id=i,this.options=s||{matchBareFromJid:!1,ignoreNamespaceFragment:!1},this.options.matchBare&&(S.warn('The "matchBare" option is deprecated, use "matchBareFromJid" instead.'),this.options.matchBareFromJid=this.options.matchBare,delete this.options.matchBare),this.options.matchBareFromJid?this.from=o?S.getBareJidFromJid(o):null:this.from=o,this.user=!0}};S.Handler.prototype={getNamespace(e){let t=e.getAttribute("xmlns");return t&&this.options.ignoreNamespaceFragment&&(t=t.split("#")[0]),t},namespaceMatch(e){let t=!1;return!this.ns||(S.forEachChild(e,null,e=>{this.getNamespace(e)===this.ns&&(t=!0)}),t||this.getNamespace(e)===this.ns)},isMatch(e){let t=e.getAttribute("from");this.options.matchBareFromJid&&(t=S.getBareJidFromJid(t));const n=e.getAttribute("type");return!(!this.namespaceMatch(e)||this.name&&!S.isTagEqual(e,this.name)||this.type&&(Array.isArray(this.type)?-1===this.type.indexOf(n):n!==this.type)||this.id&&e.getAttribute("id")!==this.id||this.from&&t!==this.from)},run(e){let t=null;try{t=this.handler(e)}catch(e){throw S._handleError(e),e}return t},toString(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}},S.TimedHandler=class{constructor(e,t){this.period=e,this.handler=t,this.lastCalled=(new Date).getTime(),this.user=!0}run(){return this.lastCalled=(new Date).getTime(),this.handler()}reset(){this.lastCalled=(new Date).getTime()}toString(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}},S.Connection=class{constructor(e,t){this.service=e,this.options=t||{},this.setProtocol(),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_bind=!1,this.do_session=!1,this.mechanisms={},this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.protocolErrorHandlers={HTTP:{},websocket:{}},this._idleTimeout=null,this._disconnectTimeout=null,this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.do_authentication=!0,this.paused=!1,this.restored=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout(()=>this._onIdle(),100),g(this.options.cookies),this.registerSASLMechanisms(this.options.mechanisms);for(const e in S._connectionPlugins)if(Object.prototype.hasOwnProperty.call(S._connectionPlugins,e)){const t=function(){};t.prototype=S._connectionPlugins[e],this[e]=new t,this[e].init(this)}}setProtocol(){const e=this.options.protocol||"";this.options.worker?this._proto=new S.WorkerWebsocket(this):0===this.service.indexOf("ws:")||0===this.service.indexOf("wss:")||0===e.indexOf("ws")?this._proto=new S.Websocket(this):this._proto=new S.Bosh(this)}reset(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.restored=!1,this._data=[],this._requests=[],this._uniqueId=0}pause(){this.paused=!0}resume(){this.paused=!1}getUniqueId(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));return"string"==typeof e||"number"==typeof e?t+":"+e:t+""}addProtocolErrorHandler(e,t,n){this.protocolErrorHandlers[e][t]=n}connect(e,t,n,r,i,o,s){this.jid=e,this.authzid=S.getBareJidFromJid(this.jid),this.authcid=s||S.getNodeFromJid(this.jid),this.pass=t,this.connect_callback=n,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.restored=!1,this.domain=S.getDomainFromJid(this.jid),this._changeConnectStatus(S.Status.CONNECTING,null),this._proto._connect(r,i,o)}attach(e,t,n,r,i,o,s){if(this._proto._attach)return this._proto._attach(e,t,n,r,i,o,s);{const e=new Error('The "attach" method is not available for your connection protocol');throw e.name="StropheSessionError",e}}restore(e,t,n,r,i){if(!this._sessionCachingSupported()){const e=new Error('The "restore" method can only be used with a BOSH connection.');throw e.name="StropheSessionError",e}this._proto._restore(e,t,n,r,i)}_sessionCachingSupported(){if(this._proto instanceof S.Bosh){if(!JSON)return!1;try{sessionStorage.setItem("_strophe_","_strophe_"),sessionStorage.removeItem("_strophe_")}catch(e){return!1}return!0}return!1}xmlInput(e){}xmlOutput(e){}rawInput(e){}rawOutput(e){}nextValidRid(e){}send(e){if(null!==e){if("function"==typeof e.sort)for(let t=0;t<e.length;t++)this._queueData(e[t]);else"function"==typeof e.tree?this._queueData(e.tree()):this._queueData(e);this._proto._send()}}flush(){clearTimeout(this._idleTimeout),this._onIdle()}sendPresence(e,t,n,r){let i=null;"function"==typeof e.tree&&(e=e.tree());let o=e.getAttribute("id");if(o||(o=this.getUniqueId("sendPresence"),e.setAttribute("id",o)),"function"==typeof t||"function"==typeof n){const e=this.addHandler(e=>{i&&this.deleteTimedHandler(i),"error"===e.getAttribute("type")?n&&n(e):t&&t(e)},null,"presence",null,o);r&&(i=this.addTimedHandler(r,()=>(this.deleteHandler(e),n&&n(null),!1)))}return this.send(e),o}sendIQ(e,t,n,r){let i=null;"function"==typeof e.tree&&(e=e.tree());let o=e.getAttribute("id");if(o||(o=this.getUniqueId("sendIQ"),e.setAttribute("id",o)),"function"==typeof t||"function"==typeof n){const e=this.addHandler(e=>{i&&this.deleteTimedHandler(i);const r=e.getAttribute("type");if("result"===r)t&&t(e);else{if("error"!==r){const e=new Error("Got bad IQ type of "+r);throw e.name="StropheError",e}n&&n(e)}},null,"iq",["error","result"],o);r&&(i=this.addTimedHandler(r,()=>(this.deleteHandler(e),n&&n(null),!1)))}return this.send(e),o}_queueData(e){if(null===e||!e.tagName||!e.childNodes){const e=new Error("Cannot queue non-DOMElement.");throw e.name="StropheError",e}this._data.push(e)}_sendRestart(){this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout(()=>this._onIdle(),100)}addTimedHandler(e,t){const n=new S.TimedHandler(e,t);return this.addTimeds.push(n),n}deleteTimedHandler(e){this.removeTimeds.push(e)}addHandler(e,t,n,r,i,o,s){const a=new S.Handler(e,t,n,r,i,o,s);return this.addHandlers.push(a),a}deleteHandler(e){this.removeHandlers.push(e);const t=this.addHandlers.indexOf(e);t>=0&&this.addHandlers.splice(t,1)}registerSASLMechanisms(e){this.mechanisms={},(e=e||[S.SASLAnonymous,S.SASLExternal,S.SASLOAuthBearer,S.SASLXOAuth2,S.SASLPlain,S.SASLSHA1]).forEach(e=>this.registerSASLMechanism(e))}registerSASLMechanism(e){const t=new e;this.mechanisms[t.mechname]=t}disconnect(e){if(this._changeConnectStatus(S.Status.DISCONNECTING,e),e?S.warn("Disconnect was called because: "+e):S.info("Disconnect was called"),this.connected){let e=!1;this.disconnecting=!0,this.authenticated&&(e=w({xmlns:S.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(3e3,this._onDisconnectTimeout.bind(this)),this._proto._disconnect(e)}else S.warn("Disconnect was called before Strophe connected to the server"),this._proto._abortAllRequests(),this._doDisconnect()}_changeConnectStatus(e,t,n){for(const n in S._connectionPlugins)if(Object.prototype.hasOwnProperty.call(S._connectionPlugins,n)){const r=this[n];if(r.statusChanged)try{r.statusChanged(e,t)}catch(e){S.error(`${n} plugin caused an exception changing status: ${e}`)}}if(this.connect_callback)try{this.connect_callback(e,t,n)}catch(e){S._handleError(e),S.error("User connection callback caused an exception: "+e)}}_doDisconnect(e){"number"==typeof this._idleTimeout&&clearTimeout(this._idleTimeout),null!==this._disconnectTimeout&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),S.debug("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.restored=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(S.Status.DISCONNECTED,e),this.connected=!1}_dataRecv(e,t){const n=this._proto._reqToData(e);if(null===n)return;for(this.xmlInput!==S.Connection.prototype.xmlInput&&(n.nodeName===this._proto.strip&&n.childNodes.length?this.xmlInput(n.childNodes[0]):this.xmlInput(n)),this.rawInput!==S.Connection.prototype.rawInput&&(t?this.rawInput(t):this.rawInput(S.serialize(n)));this.removeHandlers.length>0;){const e=this.removeHandlers.pop(),t=this.handlers.indexOf(e);t>=0&&this.handlers.splice(t,1)}for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue())return void this._doDisconnect();const r=n.getAttribute("type");if(null!==r&&"terminate"===r){if(this.disconnecting)return;let e=n.getAttribute("condition");const t=n.getElementsByTagName("conflict");return null!==e?("remote-stream-error"===e&&t.length>0&&(e="conflict"),this._changeConnectStatus(S.Status.CONNFAIL,e)):this._changeConnectStatus(S.Status.CONNFAIL,S.ErrorCondition.UNKOWN_REASON),void this._doDisconnect(e)}S.forEachChild(n,null,e=>{const t=this.handlers;this.handlers=[];for(let n=0;n<t.length;n++){const r=t[n];try{(!r.isMatch(e)||!this.authenticated&&r.user||r.run(e))&&this.handlers.push(r)}catch(e){S.warn("Removing Strophe handlers due to uncaught exception: "+e.message)}}})}_connect_cb(e,t,n){let r;S.debug("_connect_cb was called"),this.connected=!0;try{r=this._proto._reqToData(e)}catch(e){if(e.name!==S.ErrorCondition.BAD_FORMAT)throw e;this._changeConnectStatus(S.Status.CONNFAIL,S.ErrorCondition.BAD_FORMAT),this._doDisconnect(S.ErrorCondition.BAD_FORMAT)}if(!r)return;this.xmlInput!==S.Connection.prototype.xmlInput&&(r.nodeName===this._proto.strip&&r.childNodes.length?this.xmlInput(r.childNodes[0]):this.xmlInput(r)),this.rawInput!==S.Connection.prototype.rawInput&&(n?this.rawInput(n):this.rawInput(S.serialize(r)));if(this._proto._connect_cb(r)===S.Status.CONNFAIL)return;let i;if(i=r.getElementsByTagNameNS?r.getElementsByTagNameNS(S.NS.STREAM,"features").length>0:r.getElementsByTagName("stream:features").length>0||r.getElementsByTagName("features").length>0,!i)return void this._proto._no_auth_received(t);const o=Array.from(r.getElementsByTagName("mechanism")).map(e=>this.mechanisms[e.textContent]).filter(e=>e);0!==o.length||0!==r.getElementsByTagName("auth").length?!1!==this.do_authentication&&this.authenticate(o):this._proto._no_auth_received(t)}sortMechanismsByPriority(e){for(let t=0;t<e.length-1;++t){let n=t;for(let r=t+1;r<e.length;++r)e[r].priority>e[n].priority&&(n=r);if(n!==t){const r=e[t];e[t]=e[n],e[n]=r}}return e}authenticate(e){this._attemptSASLAuth(e)||this._attemptLegacyAuth()}_attemptSASLAuth(e){e=this.sortMechanismsByPriority(e||[]);let t=!1;for(let n=0;n<e.length;++n){if(!e[n].test(this))continue;this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null),this._sasl_mechanism=e[n],this._sasl_mechanism.onStart(this);const r=_("auth",{xmlns:S.NS.SASL,mechanism:this._sasl_mechanism.mechname});if(this._sasl_mechanism.isClientFirst){const e=this._sasl_mechanism.clientChallenge(this);r.t(Object(v.btoa)(e))}this.send(r.tree()),t=!0;break}return t}_sasl_challenge_cb(e){const t=Object(v.atob)(S.getText(e)),n=this._sasl_mechanism.onChallenge(this,t),r=_("response",{xmlns:S.NS.SASL});return""!==n&&r.t(Object(v.btoa)(n)),this.send(r.tree()),!0}_attemptLegacyAuth(){null===S.getNodeFromJid(this.jid)?(this._changeConnectStatus(S.Status.CONNFAIL,S.ErrorCondition.MISSING_JID_NODE),this.disconnect(S.ErrorCondition.MISSING_JID_NODE)):(this._changeConnectStatus(S.Status.AUTHENTICATING,null),this._addSysHandler(this._onLegacyAuthIQResult.bind(this),null,null,null,"_auth_1"),this.send(b({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:S.NS.AUTH}).c("username",{}).t(S.getNodeFromJid(this.jid)).tree()))}_onLegacyAuthIQResult(e){const t=b({type:"set",id:"_auth_2"}).c("query",{xmlns:S.NS.AUTH}).c("username",{}).t(S.getNodeFromJid(this.jid)).up().c("password").t(this.pass);return S.getResourceFromJid(this.jid)||(this.jid=S.getBareJidFromJid(this.jid)+"/strophe"),t.up().c("resource",{}).t(S.getResourceFromJid(this.jid)),this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2"),this.send(t.tree()),!1}_sasl_success_cb(e){if(this._sasl_data["server-signature"]){let t;const n=/([a-z]+)=([^,]+)(,|$)/,r=Object(v.atob)(S.getText(e)).match(n);if("v"===r[1]&&(t=r[2]),t!==this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}S.info("SASL authentication succeeded."),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null);const t=[],n=(e,t)=>{for(;e.length;)this.deleteHandler(e.pop());return this._onStreamFeaturesAfterSASL(t),!1};return t.push(this._addSysHandler(e=>n(t,e),null,"stream:features",null,null)),t.push(this._addSysHandler(e=>n(t,e),S.NS.STREAM,"features",null,null)),this._sendRestart(),!1}_onStreamFeaturesAfterSASL(e){this.features=e;for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];"bind"===n.nodeName&&(this.do_bind=!0),"session"===n.nodeName&&(this.do_session=!0)}return this.do_bind?(this.options.explicitResourceBinding?this._changeConnectStatus(S.Status.BINDREQUIRED,null):this.bind(),!1):(this._changeConnectStatus(S.Status.AUTHFAIL,null),!1)}bind(){if(!this.do_bind)return void S.log(S.LogLevel.INFO,'Strophe.Connection.prototype.bind called but "do_bind" is false');this._addSysHandler(this._onResourceBindResultIQ.bind(this),null,null,null,"_bind_auth_2");const e=S.getResourceFromJid(this.jid);e?this.send(b({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:S.NS.BIND}).c("resource",{}).t(e).tree()):this.send(b({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:S.NS.BIND}).tree())}_onResourceBindResultIQ(e){if("error"===e.getAttribute("type")){S.warn("Resource binding failed.");let t;return e.getElementsByTagName("conflict").length>0&&(t=S.ErrorCondition.CONFLICT),this._changeConnectStatus(S.Status.AUTHFAIL,t,e),!1}const t=e.getElementsByTagName("bind");if(!(t.length>0))return S.warn("Resource binding failed."),this._changeConnectStatus(S.Status.AUTHFAIL,null,e),!1;{const e=t[0].getElementsByTagName("jid");e.length>0&&(this.authenticated=!0,this.jid=S.getText(e[0]),this.do_session?this._establishSession():this._changeConnectStatus(S.Status.CONNECTED,null))}}_establishSession(){if(!this.do_session)throw new Error(`Strophe.Connection.prototype._establishSession called but apparently ${S.NS.SESSION} wasn't advertised by the server`);this._addSysHandler(this._onSessionResultIQ.bind(this),null,null,null,"_session_auth_2"),this.send(b({type:"set",id:"_session_auth_2"}).c("session",{xmlns:S.NS.SESSION}).tree())}_onSessionResultIQ(e){if("result"===e.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(S.Status.CONNECTED,null);else if("error"===e.getAttribute("type"))return this.authenticated=!1,S.warn("Session creation failed."),this._changeConnectStatus(S.Status.AUTHFAIL,null,e),!1;return!1}_sasl_failure_cb(e){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(S.Status.AUTHFAIL,null,e),!1}_auth2_cb(e){return"result"===e.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(S.Status.CONNECTED,null)):"error"===e.getAttribute("type")&&(this._changeConnectStatus(S.Status.AUTHFAIL,null,e),this.disconnect("authentication failed")),!1}_addSysTimedHandler(e,t){const n=new S.TimedHandler(e,t);return n.user=!1,this.addTimeds.push(n),n}_addSysHandler(e,t,n,r,i){const o=new S.Handler(e,t,n,r,i);return o.user=!1,this.addHandlers.push(o),o}_onDisconnectTimeout(){return S.debug("_onDisconnectTimeout was called"),this._changeConnectStatus(S.Status.CONNTIMEOUT,null),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1}_onIdle(){for(;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;){const e=this.removeTimeds.pop(),t=this.timedHandlers.indexOf(e);t>=0&&this.timedHandlers.splice(t,1)}const e=(new Date).getTime(),t=[];for(let n=0;n<this.timedHandlers.length;n++){const r=this.timedHandlers[n];if(this.authenticated||!r.user){r.lastCalled+r.period-e<=0?r.run()&&t.push(r):t.push(r)}}this.timedHandlers=t,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout(()=>this._onIdle(),100))}},S.SASLMechanism=h,S.SASLAnonymous=class extends h{constructor(e="ANONYMOUS",t=!1,n=20){super(e,t,n)}test(e){return null===e.authcid}},S.SASLPlain=class extends h{constructor(e="PLAIN",t=!0,n=50){super(e,t,n)}test(e){return null!==e.authcid}onChallenge(e){const{authcid:t,authzid:n,domain:r,pass:i}=e;if(!r)throw new Error("SASLPlain onChallenge: domain is not defined!");let o=n!==`${t}@${r}`?n:"";return o+="\0",o+=t,o+="\0",o+=i,p(o)}},S.SASLSHA1=class extends h{constructor(e="SCRAM-SHA-1",t=!0,n=60){super(e,t,n)}test(e){return null!==e.authcid}onChallenge(e,t){let n,r,i,o,s,a,u,c,d="c=biws,",l=`${e._sasl_data["client-first-message-bare"]},${t},`;const f=e._sasl_data.cnonce,h=/([a-z]+)=([^,]+)(,|$)/;for(;t.match(h);){const e=t.match(h);switch(t=t.replace(e[0],""),e[1]){case"r":n=e[2];break;case"s":r=e[2];break;case"i":i=e[2]}}if(n.substr(0,f.length)!==f)return e._sasl_data={},e._sasl_failure_cb();d+="r="+n,l+=d,r=atob(r),r+="\0\0\0";const g=p(e.pass);for(o=a=m.a.core_hmac_sha1(g,r),u=1;u<i;u++){for(s=m.a.core_hmac_sha1(g,m.a.binb2str(a)),c=0;c<5;c++)o[c]^=s[c];a=s}o=m.a.binb2str(o);const v=m.a.core_hmac_sha1(o,"Client Key"),_=m.a.str_hmac_sha1(o,"Server Key"),y=m.a.core_hmac_sha1(m.a.str_sha1(m.a.binb2str(v)),l);for(e._sasl_data["server-signature"]=m.a.b64_hmac_sha1(_,l),c=0;c<5;c++)v[c]^=y[c];return d+=",p="+btoa(m.a.binb2str(v)),d}clientChallenge(e,t){const n=t||f.hexdigest(""+1234567890*Math.random());let r="n="+p(e.authcid);return r+=",r=",r+=n,e._sasl_data.cnonce=n,e._sasl_data["client-first-message-bare"]=r,r="n,,"+r,r}},S.SASLOAuthBearer=class extends h{constructor(e="OAUTHBEARER",t=!0,n=40){super(e,t,n)}test(e){return null!==e.pass}onChallenge(e){let t="n,";return null!==e.authcid&&(t=t+"a="+e.authzid),t+=",",t+="",t+="auth=Bearer ",t+=e.pass,t+="",t+="",p(t)}},S.SASLExternal=class extends h{constructor(e="EXTERNAL",t=!0,n=10){super(e,t,n)}onChallenge(e){return e.authcid===e.authzid?"":e.authzid}},S.SASLXOAuth2=class extends h{constructor(e="X-OAUTH2",t=!0,n=30){super(e,t,n)}test(e){return null!==e.pass}onChallenge(e){let t="\0";return null!==e.authcid&&(t+=e.authzid),t+="\0",t+=e.pass,p(t)}};t.g={Strophe:S,$build:_,$iq:b,$msg:y,$pres:w,SHA1:m.a,MD5:f,b64_hmac_sha1:m.a.b64_hmac_sha1,b64_sha1:m.a.b64_sha1,str_hmac_sha1:m.a.str_hmac_sha1,str_sha1:m.a.str_sha1}},function(e,t,n){"use strict";(function(e){n(142),n(55),n(324);var r=n(0);n.d(t,"e",(function(){return r.f})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c})),n.d(t,"d",(function(){return r.d})),e.$build=r.g.$build,e.$iq=r.g.$iq,e.$msg=r.g.$msg,e.$pres=r.g.$pres,e.Strophe=r.g.Strophe;const{b64_sha1:i}=r.e}).call(this,n(17))},function(e,t,n){var r;
/*!
 * Sizzle CSS Selector Engine v2.3.6
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2021-02-16
 */!function(i){var o,s,a,u,c,d,l,f,h,p,g,m,v,_,y,b,w,S,x,E="sizzle"+1*new Date,A=i.document,N=0,T=0,O=fe(),j=fe(),C=fe(),I=fe(),R=function(e,t){return e===t&&(g=!0),0},M={}.hasOwnProperty,k=[],D=k.pop,P=k.push,F=k.push,L=k.slice,U=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},z="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",B="[\\x20\\t\\r\\n\\f]",$="(?:\\\\[\\da-fA-F]{1,6}"+B+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",H="\\["+B+"*("+$+")(?:"+B+"*([*^$|!~]?=)"+B+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+$+"))|)"+B+"*\\]",q=":("+$+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+H+")*)|.*)\\)|)",J=new RegExp(B+"+","g"),W=new RegExp("^"+B+"+|((?:^|[^\\\\])(?:\\\\.)*)"+B+"+$","g"),V=new RegExp("^"+B+"*,"+B+"*"),G=new RegExp("^"+B+"*([>+~]|"+B+")"+B+"*"),Y=new RegExp(B+"|>"),X=new RegExp(q),Q=new RegExp("^"+$+"$"),K={ID:new RegExp("^#("+$+")"),CLASS:new RegExp("^\\.("+$+")"),TAG:new RegExp("^("+$+"|[*])"),ATTR:new RegExp("^"+H),PSEUDO:new RegExp("^"+q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+B+"*(even|odd|(([+-]|)(\\d*)n|)"+B+"*(?:([+-]|)"+B+"*(\\d+)|))"+B+"*\\)|)","i"),bool:new RegExp("^(?:"+z+")$","i"),needsContext:new RegExp("^"+B+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+B+"*((?:-\\d)?\\d*)"+B+"*\\)|)(?=[^-]|$)","i")},Z=/HTML$/i,ee=/^(?:input|select|textarea|button)$/i,te=/^h\d$/i,ne=/^[^{]+\{\s*\[native \w/,re=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ie=/[+~]/,oe=new RegExp("\\\\[\\da-fA-F]{1,6}"+B+"?|\\\\([^\\r\\n\\f])","g"),se=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},ae=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ue=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ce=function(){m()},de=Ee((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{F.apply(k=L.call(A.childNodes),A.childNodes),k[A.childNodes.length].nodeType}catch(e){F={apply:k.length?function(e,t){P.apply(e,L.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function le(e,t,n,r){var i,o,a,u,c,l,h,p=t&&t.ownerDocument,g=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==g&&9!==g&&11!==g)return n;if(!r&&(m(t),t=t||v,y)){if(11!==g&&(c=re.exec(e)))if(i=c[1]){if(9===g){if(!(a=t.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(p&&(a=p.getElementById(i))&&x(t,a)&&a.id===i)return n.push(a),n}else{if(c[2])return F.apply(n,t.getElementsByTagName(e)),n;if((i=c[3])&&s.getElementsByClassName&&t.getElementsByClassName)return F.apply(n,t.getElementsByClassName(i)),n}if(s.qsa&&!I[e+" "]&&(!b||!b.test(e))&&(1!==g||"object"!==t.nodeName.toLowerCase())){if(h=e,p=t,1===g&&(Y.test(e)||G.test(e))){for((p=ie.test(e)&&we(t.parentNode)||t)===t&&s.scope||((u=t.getAttribute("id"))?u=u.replace(ae,ue):t.setAttribute("id",u=E)),o=(l=d(e)).length;o--;)l[o]=(u?"#"+u:":scope")+" "+xe(l[o]);h=l.join(",")}try{return F.apply(n,p.querySelectorAll(h)),n}catch(t){I(e,!0)}finally{u===E&&t.removeAttribute("id")}}}return f(e.replace(W,"$1"),t,n,r)}function fe(){var e=[];return function t(n,r){return e.push(n+" ")>a.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function he(e){return e[E]=!0,e}function pe(e){var t=v.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ge(e,t){for(var n=e.split("|"),r=n.length;r--;)a.attrHandle[n[r]]=t}function me(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ve(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function _e(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ye(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&de(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function be(e){return he((function(t){return t=+t,he((function(n,r){for(var i,o=e([],n.length,t),s=o.length;s--;)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))}))}))}function we(e){return e&&void 0!==e.getElementsByTagName&&e}for(o in s=le.support={},c=le.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Z.test(t||n&&n.nodeName||"HTML")},m=le.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:A;return r!=v&&9===r.nodeType&&r.documentElement?(_=(v=r).documentElement,y=!c(v),A!=v&&(n=v.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",ce,!1):n.attachEvent&&n.attachEvent("onunload",ce)),s.scope=pe((function(e){return _.appendChild(e).appendChild(v.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length})),s.attributes=pe((function(e){return e.className="i",!e.getAttribute("className")})),s.getElementsByTagName=pe((function(e){return e.appendChild(v.createComment("")),!e.getElementsByTagName("*").length})),s.getElementsByClassName=ne.test(v.getElementsByClassName),s.getById=pe((function(e){return _.appendChild(e).id=E,!v.getElementsByName||!v.getElementsByName(E).length})),s.getById?(a.filter.ID=function(e){var t=e.replace(oe,se);return function(e){return e.getAttribute("id")===t}},a.find.ID=function(e,t){if(void 0!==t.getElementById&&y){var n=t.getElementById(e);return n?[n]:[]}}):(a.filter.ID=function(e){var t=e.replace(oe,se);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},a.find.ID=function(e,t){if(void 0!==t.getElementById&&y){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),a.find.TAG=s.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):s.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},a.find.CLASS=s.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&y)return t.getElementsByClassName(e)},w=[],b=[],(s.qsa=ne.test(v.querySelectorAll))&&(pe((function(e){var t;_.appendChild(e).innerHTML="<a id='"+E+"'></a><select id='"+E+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&b.push("[*^$]="+B+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||b.push("\\["+B+"*(?:value|"+z+")"),e.querySelectorAll("[id~="+E+"-]").length||b.push("~="),(t=v.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||b.push("\\["+B+"*name"+B+"*="+B+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||b.push(":checked"),e.querySelectorAll("a#"+E+"+*").length||b.push(".#.+[+~]"),e.querySelectorAll("\\\f"),b.push("[\\r\\n\\f]")})),pe((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=v.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&b.push("name"+B+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&b.push(":enabled",":disabled"),_.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&b.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),b.push(",.*:")}))),(s.matchesSelector=ne.test(S=_.matches||_.webkitMatchesSelector||_.mozMatchesSelector||_.oMatchesSelector||_.msMatchesSelector))&&pe((function(e){s.disconnectedMatch=S.call(e,"*"),S.call(e,"[s!='']:x"),w.push("!=",q)})),b=b.length&&new RegExp(b.join("|")),w=w.length&&new RegExp(w.join("|")),t=ne.test(_.compareDocumentPosition),x=t||ne.test(_.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},R=t?function(e,t){if(e===t)return g=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!s.sortDetached&&t.compareDocumentPosition(e)===n?e==v||e.ownerDocument==A&&x(A,e)?-1:t==v||t.ownerDocument==A&&x(A,t)?1:p?U(p,e)-U(p,t):0:4&n?-1:1)}:function(e,t){if(e===t)return g=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,s=[e],a=[t];if(!i||!o)return e==v?-1:t==v?1:i?-1:o?1:p?U(p,e)-U(p,t):0;if(i===o)return me(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;s[r]===a[r];)r++;return r?me(s[r],a[r]):s[r]==A?-1:a[r]==A?1:0},v):v},le.matches=function(e,t){return le(e,null,null,t)},le.matchesSelector=function(e,t){if(m(e),s.matchesSelector&&y&&!I[t+" "]&&(!w||!w.test(t))&&(!b||!b.test(t)))try{var n=S.call(e,t);if(n||s.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){I(t,!0)}return le(t,v,null,[e]).length>0},le.contains=function(e,t){return(e.ownerDocument||e)!=v&&m(e),x(e,t)},le.attr=function(e,t){(e.ownerDocument||e)!=v&&m(e);var n=a.attrHandle[t.toLowerCase()],r=n&&M.call(a.attrHandle,t.toLowerCase())?n(e,t,!y):void 0;return void 0!==r?r:s.attributes||!y?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},le.escape=function(e){return(e+"").replace(ae,ue)},le.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},le.uniqueSort=function(e){var t,n=[],r=0,i=0;if(g=!s.detectDuplicates,p=!s.sortStable&&e.slice(0),e.sort(R),g){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return p=null,e},u=le.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=u(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=u(t);return n},(a=le.selectors={cacheLength:50,createPseudo:he,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(oe,se),e[3]=(e[3]||e[4]||e[5]||"").replace(oe,se),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||le.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&le.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return K.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=d(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(oe,se).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=O[e+" "];return t||(t=new RegExp("(^|"+B+")"+e+"("+B+"|$)"))&&O(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var i=le.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(J," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var c,d,l,f,h,p,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,v=a&&t.nodeName.toLowerCase(),_=!u&&!a,y=!1;if(m){if(o){for(;g;){for(f=t;f=f[g];)if(a?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[s?m.firstChild:m.lastChild],s&&_){for(y=(h=(c=(d=(l=(f=m)[E]||(f[E]={}))[f.uniqueID]||(l[f.uniqueID]={}))[e]||[])[0]===N&&c[1])&&c[2],f=h&&m.childNodes[h];f=++h&&f&&f[g]||(y=h=0)||p.pop();)if(1===f.nodeType&&++y&&f===t){d[e]=[N,h,y];break}}else if(_&&(y=h=(c=(d=(l=(f=t)[E]||(f[E]={}))[f.uniqueID]||(l[f.uniqueID]={}))[e]||[])[0]===N&&c[1]),!1===y)for(;(f=++h&&f&&f[g]||(y=h=0)||p.pop())&&((a?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++y||(_&&((d=(l=f[E]||(f[E]={}))[f.uniqueID]||(l[f.uniqueID]={}))[e]=[N,y]),f!==t)););return(y-=i)===r||y%r==0&&y/r>=0}}},PSEUDO:function(e,t){var n,r=a.pseudos[e]||a.setFilters[e.toLowerCase()]||le.error("unsupported pseudo: "+e);return r[E]?r(t):r.length>1?(n=[e,e,"",t],a.setFilters.hasOwnProperty(e.toLowerCase())?he((function(e,n){for(var i,o=r(e,t),s=o.length;s--;)e[i=U(e,o[s])]=!(n[i]=o[s])})):function(e){return r(e,0,n)}):r}},pseudos:{not:he((function(e){var t=[],n=[],r=l(e.replace(W,"$1"));return r[E]?he((function(e,t,n,i){for(var o,s=r(e,null,i,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))})):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}})),has:he((function(e){return function(t){return le(e,t).length>0}})),contains:he((function(e){return e=e.replace(oe,se),function(t){return(t.textContent||u(t)).indexOf(e)>-1}})),lang:he((function(e){return Q.test(e||"")||le.error("unsupported lang: "+e),e=e.replace(oe,se).toLowerCase(),function(t){var n;do{if(n=y?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=i.location&&i.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===_},focus:function(e){return e===v.activeElement&&(!v.hasFocus||v.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ye(!1),disabled:ye(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!a.pseudos.empty(e)},header:function(e){return te.test(e.nodeName)},input:function(e){return ee.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:be((function(){return[0]})),last:be((function(e,t){return[t-1]})),eq:be((function(e,t,n){return[n<0?n+t:n]})),even:be((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:be((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:be((function(e,t,n){for(var r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e})),gt:be((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}}).pseudos.nth=a.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})a.pseudos[o]=ve(o);for(o in{submit:!0,reset:!0})a.pseudos[o]=_e(o);function Se(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function Ee(e,t,n){var r=t.dir,i=t.next,o=i||r,s=n&&"parentNode"===o,a=T++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||s)return e(t,n,i);return!1}:function(t,n,u){var c,d,l,f=[N,a];if(u){for(;t=t[r];)if((1===t.nodeType||s)&&e(t,n,u))return!0}else for(;t=t[r];)if(1===t.nodeType||s)if(d=(l=t[E]||(t[E]={}))[t.uniqueID]||(l[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((c=d[o])&&c[0]===N&&c[1]===a)return f[2]=c[2];if(d[o]=f,f[2]=e(t,n,u))return!0}return!1}}function Ae(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function Ne(e,t,n,r,i){for(var o,s=[],a=0,u=e.length,c=null!=t;a<u;a++)(o=e[a])&&(n&&!n(o,r,i)||(s.push(o),c&&t.push(a)));return s}function Te(e,t,n,r,i,o){return r&&!r[E]&&(r=Te(r)),i&&!i[E]&&(i=Te(i,o)),he((function(o,s,a,u){var c,d,l,f=[],h=[],p=s.length,g=o||function(e,t,n){for(var r=0,i=t.length;r<i;r++)le(e,t[r],n);return n}(t||"*",a.nodeType?[a]:a,[]),m=!e||!o&&t?g:Ne(g,f,e,a,u),v=n?i||(o?e:p||r)?[]:s:m;if(n&&n(m,v,a,u),r)for(c=Ne(v,h),r(c,[],a,u),d=c.length;d--;)(l=c[d])&&(v[h[d]]=!(m[h[d]]=l));if(o){if(i||e){if(i){for(c=[],d=v.length;d--;)(l=v[d])&&c.push(m[d]=l);i(null,v=[],c,u)}for(d=v.length;d--;)(l=v[d])&&(c=i?U(o,l):f[d])>-1&&(o[c]=!(s[c]=l))}}else v=Ne(v===s?v.splice(p,v.length):v),i?i(null,s,v,u):F.apply(s,v)}))}function Oe(e){for(var t,n,r,i=e.length,o=a.relative[e[0].type],s=o||a.relative[" "],u=o?1:0,c=Ee((function(e){return e===t}),s,!0),d=Ee((function(e){return U(t,e)>-1}),s,!0),l=[function(e,n,r){var i=!o&&(r||n!==h)||((t=n).nodeType?c(e,n,r):d(e,n,r));return t=null,i}];u<i;u++)if(n=a.relative[e[u].type])l=[Ee(Ae(l),n)];else{if((n=a.filter[e[u].type].apply(null,e[u].matches))[E]){for(r=++u;r<i&&!a.relative[e[r].type];r++);return Te(u>1&&Ae(l),u>1&&xe(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(W,"$1"),n,u<r&&Oe(e.slice(u,r)),r<i&&Oe(e=e.slice(r)),r<i&&xe(e))}l.push(n)}return Ae(l)}Se.prototype=a.filters=a.pseudos,a.setFilters=new Se,d=le.tokenize=function(e,t){var n,r,i,o,s,u,c,d=j[e+" "];if(d)return t?0:d.slice(0);for(s=e,u=[],c=a.preFilter;s;){for(o in n&&!(r=V.exec(s))||(r&&(s=s.slice(r[0].length)||s),u.push(i=[])),n=!1,(r=G.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(W," ")}),s=s.slice(n.length)),a.filter)!(r=K[o].exec(s))||c[o]&&!(r=c[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?le.error(e):j(e,u).slice(0)},l=le.compile=function(e,t){var n,r=[],i=[],o=C[e+" "];if(!o){for(t||(t=d(e)),n=t.length;n--;)(o=Oe(t[n]))[E]?r.push(o):i.push(o);(o=C(e,function(e,t){var n=t.length>0,r=e.length>0,i=function(i,o,s,u,c){var d,l,f,p=0,g="0",_=i&&[],b=[],w=h,S=i||r&&a.find.TAG("*",c),x=N+=null==w?1:Math.random()||.1,E=S.length;for(c&&(h=o==v||o||c);g!==E&&null!=(d=S[g]);g++){if(r&&d){for(l=0,o||d.ownerDocument==v||(m(d),s=!y);f=e[l++];)if(f(d,o||v,s)){u.push(d);break}c&&(N=x)}n&&((d=!f&&d)&&p--,i&&_.push(d))}if(p+=g,n&&g!==p){for(l=0;f=t[l++];)f(_,b,o,s);if(i){if(p>0)for(;g--;)_[g]||b[g]||(b[g]=D.call(u));b=Ne(b)}F.apply(u,b),c&&!i&&b.length>0&&p+t.length>1&&le.uniqueSort(u)}return c&&(N=x,h=w),_};return n?he(i):i}(i,r))).selector=e}return o},f=le.select=function(e,t,n,r){var i,o,s,u,c,f="function"==typeof e&&e,h=!r&&d(e=f.selector||e);if(n=n||[],1===h.length){if((o=h[0]=h[0].slice(0)).length>2&&"ID"===(s=o[0]).type&&9===t.nodeType&&y&&a.relative[o[1].type]){if(!(t=(a.find.ID(s.matches[0].replace(oe,se),t)||[])[0]))return n;f&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=K.needsContext.test(e)?0:o.length;i--&&(s=o[i],!a.relative[u=s.type]);)if((c=a.find[u])&&(r=c(s.matches[0].replace(oe,se),ie.test(o[0].type)&&we(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return F.apply(n,r),n;break}}return(f||l(e,h))(r,t,!y,n,!t||ie.test(e)&&we(t.parentNode)||t),n},s.sortStable=E.split("").sort(R).join("")===E,s.detectDuplicates=!!g,m(),s.sortDetached=pe((function(e){return 1&e.compareDocumentPosition(v.createElement("fieldset"))})),pe((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||ge("type|href|height|width",(function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),s.attributes&&pe((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||ge("value",(function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),pe((function(e){return null==e.getAttribute("disabled")}))||ge(z,(function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}));var je=i.Sizzle;le.noConflict=function(){return i.Sizzle===le&&(i.Sizzle=je),le},void 0===(r=function(){return le}.call(t,n,t,e))||(e.exports=r)}(window)},function(e,t,n){"use strict";var r=n(53),i="object"==typeof self&&self&&self.Object===Object&&self,o=r.a||i||Function("return this")();t.a=o},function(e,t,n){"use strict";function r(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;var n,r,s,c,d,l,f,h,p=new Array(80),g=1732584193,m=-271733879,v=-1732584194,_=271733878,y=-1009589776;for(n=0;n<e.length;n+=16){for(c=g,d=m,l=v,f=_,h=y,r=0;r<80;r++)p[r]=r<16?e[n+r]:u(p[r-3]^p[r-8]^p[r-14]^p[r-16],1),s=a(a(u(g,5),i(r,m,v,_)),a(a(y,p[r]),o(r))),y=_,_=v,v=u(m,30),m=g,g=s;g=a(g,c),m=a(m,d),v=a(v,l),_=a(_,f),y=a(y,h)}return[g,m,v,_,y]}function i(e,t,n,r){return e<20?t&n|~t&r:e<40?t^n^r:e<60?t&n|t&r|n&r:t^n^r}function o(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function s(e,t){var n=c(e);n.length>16&&(n=r(n,8*e.length));for(var i=new Array(16),o=new Array(16),s=0;s<16;s++)i[s]=909522486^n[s],o[s]=1549556828^n[s];var a=r(i.concat(c(t)),512+8*t.length);return r(o.concat(a),672)}function a(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function u(e,t){return e<<t|e>>>32-t}function c(e){for(var t=[],n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t}function d(e){for(var t,n,r="",i=0;i<4*e.length;i+=3)for(t=(e[i>>2]>>8*(3-i%4)&255)<<16|(e[i+1>>2]>>8*(3-(i+1)%4)&255)<<8|e[i+2>>2]>>8*(3-(i+2)%4)&255,n=0;n<4;n++)8*i+6*n>32*e.length?r+="=":r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>6*(3-n)&63);return r}function l(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>24-n%32&255);return t}n.d(t,"a",(function(){return f}));const f={b64_hmac_sha1:function(e,t){return d(s(e,t))},b64_sha1:function(e){return d(r(c(e),8*e.length))},binb2str:l,core_hmac_sha1:s,str_hmac_sha1:function(e,t){return l(s(e,t))},str_sha1:function(e){return l(r(c(e),8*e.length))}}},function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));const r=function(){let t=e.WebSocket;if(void 0===t)try{t=n(155)}catch(e){throw new Error('You must install the "ws" package to use Strophe in nodejs.')}return t}();const i=function(){let t=e.DOMParser;if(void 0===t)try{t=n(83).DOMParser}catch(e){throw new Error('You must install the "xmldom" package to use Strophe in nodejs.')}return t}();function o(){if("undefined"==typeof document)try{return(new(0,n(83).DOMImplementation)).createDocument("jabber:client","strophe",null)}catch(e){throw new Error('You must install the "xmldom" package to use Strophe in nodejs.')}if(void 0===document.implementation.createDocument||document.implementation.createDocument&&document.documentMode&&document.documentMode<10){const e=function(){const e=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"];for(let t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(e){}}();return e.appendChild(e.createElement("strophe")),e}return document.implementation.createDocument("jabber:client","strophe",null)}}).call(this,n(17))},function(e,t,n){var r=n(85),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){"use strict";(function(e){var r=n(53),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i&&r.a.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();t.a=a}).call(this,n(56)(e))},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){var r=n(132)("wks"),i=n(133),o=n(7).Symbol,s="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=s&&o[e]||(s?o:i)("Symbol."+e))}).store=r},function(e,t){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},,function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,n){"use strict";(function(e){var r=n(3),i=n(143),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=s&&s.exports===o?r.a.Buffer:void 0,u=(a?a.isBuffer:void 0)||i.a;t.a=u}).call(this,n(56)(e))},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){e.exports=function(){"use strict";var e="millisecond",t="second",n="minute",r="hour",i="day",o="week",s="month",a="quarter",u="year",c=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,d=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,l=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},f={s:l,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+l(r,2,"0")+":"+l(i,2,"0")},m:function(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,s),i=t-r<0,o=e.clone().add(n+(i?-1:1),s);return Number(-(n+(t-r)/(i?r-o:o-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(c){return{M:s,y:u,w:o,d:i,D:"date",h:r,m:n,s:t,ms:e,Q:a}[c]||String(c||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},p="en",g={};g[p]=h;var m=function(e){return e instanceof b},v=function(e,t,n){var r;if(!e)return p;if("string"==typeof e)g[e]&&(r=e),t&&(g[e]=t,r=e);else{var i=e.name;g[i]=e,r=i}return!n&&r&&(p=r),r||!n&&p},_=function(e,t){if(m(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new b(n)},y=f;y.l=v,y.i=m,y.w=function(e,t){return _(e,{locale:t.$L,utc:t.$u,$offset:t.$offset})};var b=function(){function l(e){this.$L=this.$L||v(e.locale,null,!0),this.parse(e)}var f=l.prototype;return f.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(y.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(c);if(r)return n?new Date(Date.UTC(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)):new Date(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)}return new Date(t)}(e),this.init()},f.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},f.$utils=function(){return y},f.isValid=function(){return!("Invalid Date"===this.$d.toString())},f.isSame=function(e,t){var n=_(e);return this.startOf(t)<=n&&n<=this.endOf(t)},f.isAfter=function(e,t){return _(e)<this.startOf(t)},f.isBefore=function(e,t){return this.endOf(t)<_(e)},f.$g=function(e,t,n){return y.u(e)?this[t]:this.set(n,e)},f.year=function(e){return this.$g(e,"$y",u)},f.month=function(e){return this.$g(e,"$M",s)},f.day=function(e){return this.$g(e,"$W",i)},f.date=function(e){return this.$g(e,"$D","date")},f.hour=function(e){return this.$g(e,"$H",r)},f.minute=function(e){return this.$g(e,"$m",n)},f.second=function(e){return this.$g(e,"$s",t)},f.millisecond=function(t){return this.$g(t,"$ms",e)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(e,a){var c=this,d=!!y.u(a)||a,l=y.p(e),f=function(e,t){var n=y.w(c.$u?Date.UTC(c.$y,t,e):new Date(c.$y,t,e),c);return d?n:n.endOf(i)},h=function(e,t){return y.w(c.toDate()[e].apply(c.toDate("s"),(d?[0,0,0,0]:[23,59,59,999]).slice(t)),c)},p=this.$W,g=this.$M,m=this.$D,v="set"+(this.$u?"UTC":"");switch(l){case u:return d?f(1,0):f(31,11);case s:return d?f(1,g):f(0,g+1);case o:var _=this.$locale().weekStart||0,b=(p<_?p+7:p)-_;return f(d?m-b:m+(6-b),g);case i:case"date":return h(v+"Hours",0);case r:return h(v+"Minutes",1);case n:return h(v+"Seconds",2);case t:return h(v+"Milliseconds",3);default:return this.clone()}},f.endOf=function(e){return this.startOf(e,!1)},f.$set=function(o,a){var c,d=y.p(o),l="set"+(this.$u?"UTC":""),f=(c={},c.day=l+"Date",c.date=l+"Date",c[s]=l+"Month",c[u]=l+"FullYear",c[r]=l+"Hours",c[n]=l+"Minutes",c[t]=l+"Seconds",c[e]=l+"Milliseconds",c)[d],h=d===i?this.$D+(a-this.$W):a;if(d===s||d===u){var p=this.clone().set("date",1);p.$d[f](h),p.init(),this.$d=p.set("date",Math.min(this.$D,p.daysInMonth())).$d}else f&&this.$d[f](h);return this.init(),this},f.set=function(e,t){return this.clone().$set(e,t)},f.get=function(e){return this[y.p(e)]()},f.add=function(e,a){var c,d=this;e=Number(e);var l=y.p(a),f=function(t){var n=_(d);return y.w(n.date(n.date()+Math.round(t*e)),d)};if(l===s)return this.set(s,this.$M+e);if(l===u)return this.set(u,this.$y+e);if(l===i)return f(1);if(l===o)return f(7);var h=(c={},c[n]=6e4,c[r]=36e5,c[t]=1e3,c)[l]||1,p=this.$d.getTime()+e*h;return y.w(p,this)},f.subtract=function(e,t){return this.add(-1*e,t)},f.format=function(e){var t=this;if(!this.isValid())return"Invalid Date";var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=y.z(this),i=this.$locale(),o=this.$H,s=this.$m,a=this.$M,u=i.weekdays,c=i.months,l=function(e,r,i,o){return e&&(e[r]||e(t,n))||i[r].substr(0,o)},f=function(e){return y.s(o%12||12,e,"0")},h=i.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:y.s(a+1,2,"0"),MMM:l(i.monthsShort,a,c,3),MMMM:l(c,a),D:this.$D,DD:y.s(this.$D,2,"0"),d:String(this.$W),dd:l(i.weekdaysMin,this.$W,u,2),ddd:l(i.weekdaysShort,this.$W,u,3),dddd:u[this.$W],H:String(o),HH:y.s(o,2,"0"),h:f(1),hh:f(2),a:h(o,s,!0),A:h(o,s,!1),m:String(s),mm:y.s(s,2,"0"),s:String(this.$s),ss:y.s(this.$s,2,"0"),SSS:y.s(this.$ms,3,"0"),Z:r};return n.replace(d,(function(e,t){return t||p[e]||r.replace(":","")}))},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(e,i,c){var d,l=y.p(i),f=_(e),h=6e4*(f.utcOffset()-this.utcOffset()),p=this-f,g=y.m(this,f);return g=(d={},d[u]=g/12,d[s]=g,d[a]=g/3,d[o]=(p-h)/6048e5,d.day=(p-h)/864e5,d[r]=p/36e5,d[n]=p/6e4,d[t]=p/1e3,d)[l]||p,c?g:y.a(g)},f.daysInMonth=function(){return this.endOf(s).$D},f.$locale=function(){return g[this.$L]},f.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=v(e,t,!0);return r&&(n.$L=r),n},f.clone=function(){return y.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},l}();return _.prototype=b.prototype,_.extend=function(e,t){return e(t,b,_),_},_.locale=v,_.isDayjs=m,_.unix=function(e){return _(1e3*e)},_.en=g[p],_.Ls=g,_}()},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(39),i=n(165),o=n(166),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?i(e):o(e)}},function(e,t,n){var r=n(183),i=n(186);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(32);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){(function(t){e.exports=function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};t[s][0].call(c.exports,(function(e){var n=t[s][1][e];return i(n||e)}),c,c.exports,e,t,n,r)}return n[s].exports}for(var o=!1,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,n,r){(function(e){"use strict";var t,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,s=new i(d),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),t=function(){a.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)t="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var u=new e.MessageChannel;u.port1.onmessage=d,t=function(){u.port2.postMessage(0)}}var c=[];function d(){var e,t;r=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}r=!1}n.exports=function(e){1!==c.push(e)||r||t()}}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";var r=e(1);function i(){}var o={},s=["REJECTED"],a=["FULFILLED"],u=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,e!==i&&h(this,e)}function d(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function l(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return o.reject(e,t)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function f(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function i(t){n||(n=!0,o.resolve(e,t))}var s=p((function(){t(i,r)}));"error"===s.status&&r(s.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var n=new this.constructor(i);return this.state!==u?l(n,this.state===a?e:t,this.outcome):this.queue.push(new d(n,e,t)),n},d.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){l(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){o.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){l(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=p(f,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)h(e,r);else{e.state=a,e.outcome=t;for(var i=-1,s=e.queue.length;++i<s;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=s,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:o.resolve(new this(i),e)},c.reject=function(e){var t=new this(i);return o.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,u=-1,c=new this(i);++u<n;)d(e[u],u);return c;function d(e,i){t.resolve(e).then((function(e){s[i]=e,++a!==n||r||(r=!0,o.resolve(c,s))}),(function(e){r||(r=!0,o.reject(c,e))}))}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s,a=-1,u=new this(i);++a<n;)s=e[a],t.resolve(s).then((function(e){r||(r=!0,o.resolve(u,e))}),(function(e){r||(r=!0,o.reject(u,e))}));return u}},{1:1}],3:[function(e,n,r){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function o(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var s=Promise;function a(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function u(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function c(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function d(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var l=void 0,f={},h=Object.prototype.toString;function p(e){return"boolean"==typeof l?s.resolve(l):function(e){return new s((function(t){var n=e.transaction("local-forage-detect-blob-support","readwrite"),r=o([""]);n.objectStore("local-forage-detect-blob-support").put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return l=e}))}function g(e){var t=f[e.name],n={};n.promise=new s((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function m(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function v(e,t){var n=f[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function _(e,t){return new s((function(n,r){if(f[e.name]=f[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return n(e.db);g(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var s=i.open.apply(i,o);t&&(s.onupgradeneeded=function(t){var n=s.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore("local-forage-detect-blob-support")}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),s.onerror=function(e){e.preventDefault(),r(s.error)},s.onsuccess=function(){n(s.result),m(e)}}))}function y(e){return _(e,!1)}function b(e){return _(e,!0)}function w(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function S(e){return o([function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}(atob(e.data))],{type:e.type})}function x(e){return e&&e.__local_forage_encoded_blob}function E(e){var t=this,n=t._initReady().then((function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return u(n,e,e),n}function A(e,t,n,r){void 0===r&&(r=1);try{var i=e.db.transaction(e.storeName,t);n(null,i)}catch(i){if(r>0&&(!e.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return s.resolve().then((function(){if(!e.db||"NotFoundError"===i.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),b(e)})).then((function(){return function(e){g(e);for(var t=f[e.name],n=t.forages,r=0;r<n.length;r++){var i=n[r];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,y(e).then((function(t){return e.db=t,w(e)?b(e):t})).then((function(r){e.db=t.db=r;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=r})).catch((function(t){throw v(e,t),t}))}(e).then((function(){A(e,t,n,r-1)}))})).catch(n);n(i)}}var N={_driver:"asyncStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var i=f[n.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},f[n.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=E);var o=[];function a(){return s.resolve()}for(var u=0;u<i.forages.length;u++){var c=i.forages[u];c!==t&&o.push(c._initReady().catch(a))}var d=i.forages.slice(0);return s.all(o).then((function(){return n.db=i.db,y(n)})).then((function(e){return n.db=e,w(n,t._defaultConfig.version)?b(n):e})).then((function(e){n.db=i.db=e,t._dbInfo=n;for(var r=0;r<d.length;r++){var o=d[r];o!==t&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}}))},_support:function(){try{if(!i||!i.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=new s((function(t,r){n.ready().then((function(){A(n._dbInfo,"readonly",(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var n=s.result;if(n){var r=n.value;x(r)&&(r=S(r));var i=e(r,n.key,a++);void 0!==i?t(i):n.continue()}else t()},s.onerror=function(){r(s.error)}}catch(e){r(e)}}))})).catch(r)}));return a(r,t),r},getItem:function(e,t){var n=this;e=c(e);var r=new s((function(t,r){n.ready().then((function(){A(n._dbInfo,"readonly",(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),x(e)&&(e=S(e)),t(e)},s.onerror=function(){r(s.error)}}catch(e){r(e)}}))})).catch(r)}));return a(r,t),r},setItem:function(e,t,n){var r=this;e=c(e);var i=new s((function(n,i){var o;r.ready().then((function(){return o=r._dbInfo,"[object Blob]"===h.call(t)?p(o.db).then((function(e){return e?t:(n=t,new s((function(e,t){var r=new FileReader;r.onerror=t,r.onloadend=function(t){var r=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:n.type})},r.readAsBinaryString(n)})));var n})):t})).then((function(t){A(r._dbInfo,"readwrite",(function(o,s){if(o)return i(o);try{var a=s.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var u=a.put(t,e);s.oncomplete=function(){void 0===t&&(t=null),n(t)},s.onabort=s.onerror=function(){var e=u.error?u.error:u.transaction.error;i(e)}}catch(e){i(e)}}))})).catch(i)}));return a(i,n),i},removeItem:function(e,t){var n=this;e=c(e);var r=new s((function(t,r){n.ready().then((function(){A(n._dbInfo,"readwrite",(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){r(s.error)},o.onabort=function(){var e=s.error?s.error:s.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return a(r,t),r},clear:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){A(t._dbInfo,"readwrite",(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=o.error?o.error:o.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return a(n,e),n},length:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){A(t._dbInfo,"readonly",(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return a(n,e),n},key:function(e,t){var n=this,r=new s((function(t,r){e<0?t(null):n.ready().then((function(){A(n._dbInfo,"readonly",(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName),a=!1,u=s.openKeyCursor();u.onsuccess=function(){var n=u.result;n?0===e||a?t(n.key):(a=!0,n.advance(e)):t(null)},u.onerror=function(){r(u.error)}}catch(e){r(e)}}))})).catch(r)}));return a(r,t),r},keys:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){A(t._dbInfo,"readonly",(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).openKeyCursor(),s=[];o.onsuccess=function(){var t=o.result;t?(s.push(t.key),t.continue()):e(s)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return a(n,e),n},dropInstance:function(e,t){t=d.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;if(e.name){var u=e.name===n.name&&o._dbInfo.db,c=u?s.resolve(o._dbInfo.db):y(e).then((function(t){var n=f[e.name],r=n.forages;n.db=t;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=t;return t}));r=e.storeName?c.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;g(e);var r=f[e.name],o=r.forages;t.close();for(var a=0;a<o.length;a++){var u=o[a];u._dbInfo.db=null,u._dbInfo.version=n}return new s((function(t,r){var o=i.open(e.name,n);o.onerror=function(e){o.result.close(),r(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<o.length;t++){var n=o[t];n._dbInfo.db=e,m(n._dbInfo)}})).catch((function(t){throw(v(e,t)||s.resolve()).catch((function(){})),t}))}})):c.then((function(t){g(e);var n=f[e.name],r=n.forages;t.close();for(var o=0;o<r.length;o++)r[o]._dbInfo.db=null;return new s((function(t,n){var r=i.deleteDatabase(e.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),n(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<r.length;t++)m(r[t]._dbInfo)})).catch((function(t){throw(v(e,t)||s.resolve()).catch((function(){})),t}))}))}else r=s.reject("Invalid arguments");return a(r,t),r}},T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",O=/^~~local_forage_type~([^~]+)~/,j="__lfsc__:".length,C=j+"arbf".length,I=Object.prototype.toString;function R(e){var t,n,r,i,o,s=.75*e.length,a=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),d=new Uint8Array(c);for(t=0;t<a;t+=4)n=T.indexOf(e[t]),r=T.indexOf(e[t+1]),i=T.indexOf(e[t+2]),o=T.indexOf(e[t+3]),d[u++]=n<<2|r>>4,d[u++]=(15&r)<<4|i>>2,d[u++]=(3&i)<<6|63&o;return c}function M(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=T[n[t]>>2],r+=T[(3&n[t])<<4|n[t+1]>>4],r+=T[(15&n[t+1])<<2|n[t+2]>>6],r+=T[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var k={serialize:function(e,t){var n="";if(e&&(n=I.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===I.call(e.buffer))){var r,i="__lfsc__:";e instanceof ArrayBuffer?(r=e,i+="arbf"):(r=e.buffer,"[object Int8Array]"===n?i+="si08":"[object Uint8Array]"===n?i+="ui08":"[object Uint8ClampedArray]"===n?i+="uic8":"[object Int16Array]"===n?i+="si16":"[object Uint16Array]"===n?i+="ur16":"[object Int32Array]"===n?i+="si32":"[object Uint32Array]"===n?i+="ui32":"[object Float32Array]"===n?i+="fl32":"[object Float64Array]"===n?i+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(i+M(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n="~~local_forage_type~"+e.type+"~"+M(this.result);t("__lfsc__:blob"+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,j))return JSON.parse(e);var t,n=e.substring(C),r=e.substring(j,C);if("blob"===r&&O.test(n)){var i=n.match(O);t=i[1],n=n.substring(i[0].length)}var s=R(n);switch(r){case"arbf":return s;case"blob":return o([s],{type:t});case"si08":return new Int8Array(s);case"ui08":return new Uint8Array(s);case"uic8":return new Uint8ClampedArray(s);case"si16":return new Int16Array(s);case"ur16":return new Uint16Array(s);case"si32":return new Int32Array(s);case"ui32":return new Uint32Array(s);case"fl32":return new Float32Array(s);case"fl64":return new Float64Array(s);default:throw new Error("Unkown type: "+r)}},stringToBuffer:R,bufferToString:M};function D(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function P(e,t,n,r,i,o){e.executeSql(n,r,i,(function(e,s){s.code===s.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?o(e,s):D(e,t,(function(){e.executeSql(n,r,i,o)}),o)}),o):o(e,s)}),o)}function F(e,t,n,r){var i=this;e=c(e);var o=new s((function(o,s){i.ready().then((function(){void 0===t&&(t=null);var a=t,u=i._dbInfo;u.serializer.serialize(t,(function(t,c){c?s(c):u.db.transaction((function(n){P(n,u,"INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(a)}),(function(e,t){s(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void o(F.apply(i,[e,a,n,r-1]));s(t)}}))}))})).catch(s)}));return a(o,n),o}function L(e){return new s((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var i=[],o=0;o<r.rows.length;o++)i.push(r.rows.item(o).name);t({db:e,storeNames:i})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}var U={_driver:"webSQLStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var i=new s((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(i){D(i,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=k,i},_support:"function"==typeof openDatabase,iterate:function(e,t){var n=this,r=new s((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){P(n,i,"SELECT * FROM "+i.storeName,[],(function(n,r){for(var o=r.rows,s=o.length,a=0;a<s;a++){var u=o.item(a),c=u.value;if(c&&(c=i.serializer.deserialize(c)),void 0!==(c=e(c,u.key,a+1)))return void t(c)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},getItem:function(e,t){var n=this;e=c(e);var r=new s((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){P(n,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},setItem:function(e,t,n){return F.apply(this,[e,t,n,1])},removeItem:function(e,t){var n=this;e=c(e);var r=new s((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){P(n,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},clear:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){P(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,e),n},length:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){P(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,e),n},key:function(e,t){var n=this,r=new s((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){P(n,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},keys:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){P(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,e),n},dropInstance:function(e,t){t=d.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,i=this;return a(r=e.name?new s((function(t){var r;r=e.name===n.name?i._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(L(r))})).then((function(e){return new s((function(t,n){e.db.transaction((function(r){function i(e){return new s((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var o=[],a=0,u=e.storeNames.length;a<u;a++)o.push(i(e.storeNames[a]));s.all(o).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):s.reject("Invalid arguments"),t),r}};function z(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function B(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0}var $={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return t.keyPrefix=z(e,this._defaultConfig),B()?(this._dbInfo=t,t.serializer=k,s.resolve()):s.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,i=r.length,o=localStorage.length,s=1,a=0;a<o;a++){var u=localStorage.key(a);if(0===u.indexOf(r)){var c=localStorage.getItem(u);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,u.substring(i),s++)))return c}}}));return a(r,t),r},getItem:function(e,t){var n=this;e=c(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return a(r,t),r},setItem:function(e,t,n){var r=this;e=c(e);var i=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new s((function(i,o){var s=r._dbInfo;s.serializer.serialize(t,(function(t,r){if(r)o(r);else try{localStorage.setItem(s.keyPrefix+e,t),i(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return a(i,n),i},removeItem:function(e,t){var n=this;e=c(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return a(r,t),r},clear:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return a(n,e),n},length:function(e){var t=this.keys().then((function(e){return e.length}));return a(t,e),t},key:function(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return a(r,t),r},keys:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++){var o=localStorage.key(i);0===o.indexOf(e.keyPrefix)&&r.push(o.substring(e.keyPrefix.length))}return r}));return a(n,e),n},dropInstance:function(e,t){if(t=d.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,i=this;return a(r=e.name?new s((function(t){e.storeName?t(z(e,i._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):s.reject("Invalid arguments"),t),r}},H=function(e,t){for(var n,r,i=e.length,o=0;o<i;){if((n=e[o])===(r=t)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return!0;o++}return!1},q=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},J={},W={},V={INDEXEDDB:N,WEBSQL:U,LOCALSTORAGE:$},G=[V.INDEXEDDB._driver,V.WEBSQL._driver,V.LOCALSTORAGE._driver],Y=["dropInstance"],X=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Y),Q={description:"",driver:G.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function K(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function Z(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(q(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var ee=new(function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),V)if(V.hasOwnProperty(n)){var r=V[n],i=r._driver;this[n]=i,J[i]||this.defineDriver(r)}this._defaultConfig=Z({},Q),this._config=Z({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new s((function(t,n){try{var r=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(i);for(var o=X.concat("_initStorage"),u=0,c=o.length;u<c;u++){var d=o[u];if((!H(Y,d)||e[d])&&"function"!=typeof e[d])return void n(i)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=s.reject(t);return a(n,arguments[arguments.length-1]),n}},n=0,r=Y.length;n<r;n++){var i=Y[n];e[i]||(e[i]=t(i))}}();var l=function(n){J[r]&&console.info("Redefining LocalForage driver: "+r),J[r]=e,W[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(l,n):l(!!e._support):l(!0)}catch(e){n(e)}}));return u(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=J[e]?s.resolve(J[e]):s.reject(new Error("Driver not found."));return u(r,t,n),r},e.prototype.getSerializer=function(e){var t=s.resolve(k);return u(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return u(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;q(e)||(e=[e]);var i=this._getSupportedDrivers(e);function o(){r._config.driver=r.driver()}function a(e){return r._extend(e),o(),r._ready=r._initStorage(r._config),r._ready}var c=null!==this._driverSet?this._driverSet.catch((function(){return s.resolve()})):s.resolve();return this._driverSet=c.then((function(){var e=i[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,o(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(e){return function(){var t=0;return function n(){for(;t<e.length;){var i=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(i).then(a).catch(n)}o();var u=new Error("No available storage method found.");return r._driverSet=s.reject(u),r._driverSet}()}}(i)}))})).catch((function(){o();var e=new Error("No available storage method found.");return r._driverSet=s.reject(e),r._driverSet})),u(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!W[e]},e.prototype._extend=function(e){Z(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=X.length;e<t;e++)K(this,X[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=ee},{3:3}]},{},[4])(4)}).call(this,n(17))},function(e,t,n){var r=n(52),i=n(59);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},function(e,t,n){var r=n(7),i=n(11),o=n(48),s=n(24),a=n(50),u=function(e,t,n){var c,d,l,f=e&u.F,h=e&u.G,p=e&u.S,g=e&u.P,m=e&u.B,v=e&u.W,_=h?i:i[t]||(i[t]={}),y=_.prototype,b=h?r:p?r[t]:(r[t]||{}).prototype;for(c in h&&(n=t),n)(d=!f&&b&&void 0!==b[c])&&a(_,c)||(l=d?b[c]:n[c],_[c]=h&&"function"!=typeof b[c]?n[c]:m&&d?o(l,r):v&&b[c]==l?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(l):g&&"function"==typeof l?o(Function.call,l):l,g&&((_.virtual||(_.virtual={}))[c]=l,e&u.R&&y&&!y[c]&&s(y,c,l)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t,n){var r=n(31),i=n(128);e.exports=n(25)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){e.exports=!n(70)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(87),i=n(91),o=n(22);e.exports=function(e){return o(e)?r(e):i(e)}},function(e,t,n){var r=n(102),i=n(22),o=n(103),s=n(57),a=n(80),u=Math.max;e.exports=function(e,t,n,c){e=i(e)?e:a(e),n=n&&!c?s(n):0;var d=e.length;return n<0&&(n=u(d+n,0)),o(e)?n<=d&&e.indexOf(t,n)>-1:!!d&&r(e,t,n)>-1}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(38);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(e,t,n){var r=n(20),i=n(282),o=n(283),s=Object.defineProperty;t.f=n(25)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports={}},function(e,t,n){"use strict";const r=n(158),i=n(159);e.exports={atob:r,btoa:i}},function(e,t,n){e.exports=n(167)},function(e,t,n){e.exports=n(181)},,function(e,t,n){var r=n(18),i=n(15);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},function(e,t,n){var r=n(6).Symbol;e.exports=r},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(62),i=n(13);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=r(e.prototype),o=e.apply(n,t);return i(o)?o:n}}},function(e,t){e.exports=function(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n];s!==t&&"__lodash_placeholder__"!==s||(e[n]="__lodash_placeholder__",o[i++]=n)}return o}},function(e,t,n){var r=n(218),i=n(219),o=n(220),s=n(221),a=n(222);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,e.exports=u},function(e,t,n){var r=n(40);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(19)(Object,"create");e.exports=r},function(e,t,n){var r=n(236);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(9),i=n(69),o=n(259),s=n(262);e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:o(s(e))}},function(e,t,n){var r=n(49);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(18),i=n(13);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(17))},function(e,t,n){(function(e,r){var i;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var o="Expected a function",s="__lodash_placeholder__",a=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],u="[object Arguments]",c="[object Array]",d="[object Boolean]",l="[object Date]",f="[object Error]",h="[object Function]",p="[object GeneratorFunction]",g="[object Map]",m="[object Number]",v="[object Object]",_="[object RegExp]",y="[object Set]",b="[object String]",w="[object Symbol]",S="[object WeakMap]",x="[object ArrayBuffer]",E="[object DataView]",A="[object Float32Array]",N="[object Float64Array]",T="[object Int8Array]",O="[object Int16Array]",j="[object Int32Array]",C="[object Uint8Array]",I="[object Uint16Array]",R="[object Uint32Array]",M=/\b__p \+= '';/g,k=/\b(__p \+=) '' \+/g,D=/(__e\(.*?\)|\b__t\)) \+\n'';/g,P=/&(?:amp|lt|gt|quot|#39);/g,F=/[&<>"']/g,L=RegExp(P.source),U=RegExp(F.source),z=/<%-([\s\S]+?)%>/g,B=/<%([\s\S]+?)%>/g,$=/<%=([\s\S]+?)%>/g,H=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,q=/^\w*$/,J=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,W=/[\\^$.*+?()[\]{}|]/g,V=RegExp(W.source),G=/^\s+/,Y=/\s/,X=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Q=/\{\n\/\* \[wrapped with (.+)\] \*/,K=/,? & /,Z=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ee=/[()=,{}\[\]\/\s]/,te=/\\(\\)?/g,ne=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,re=/\w*$/,ie=/^[-+]0x[0-9a-f]+$/i,oe=/^0b[01]+$/i,se=/^\[object .+?Constructor\]$/,ae=/^0o[0-7]+$/i,ue=/^(?:0|[1-9]\d*)$/,ce=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,de=/($^)/,le=/['\n\r\u2028\u2029\\]/g,fe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",he="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pe="[\\ud800-\\udfff]",ge="["+he+"]",me="["+fe+"]",ve="\\d+",_e="[\\u2700-\\u27bf]",ye="[a-z\\xdf-\\xf6\\xf8-\\xff]",be="[^\\ud800-\\udfff"+he+ve+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",we="\\ud83c[\\udffb-\\udfff]",Se="[^\\ud800-\\udfff]",xe="(?:\\ud83c[\\udde6-\\uddff]){2}",Ee="[\\ud800-\\udbff][\\udc00-\\udfff]",Ae="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Ne="(?:"+ye+"|"+be+")",Te="(?:"+Ae+"|"+be+")",Oe="(?:"+me+"|"+we+")"+"?",je="[\\ufe0e\\ufe0f]?"+Oe+("(?:\\u200d(?:"+[Se,xe,Ee].join("|")+")[\\ufe0e\\ufe0f]?"+Oe+")*"),Ce="(?:"+[_e,xe,Ee].join("|")+")"+je,Ie="(?:"+[Se+me+"?",me,xe,Ee,pe].join("|")+")",Re=RegExp("['’]","g"),Me=RegExp(me,"g"),ke=RegExp(we+"(?="+we+")|"+Ie+je,"g"),De=RegExp([Ae+"?"+ye+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[ge,Ae,"$"].join("|")+")",Te+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[ge,Ae+Ne,"$"].join("|")+")",Ae+"?"+Ne+"+(?:['’](?:d|ll|m|re|s|t|ve))?",Ae+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ve,Ce].join("|"),"g"),Pe=RegExp("[\\u200d\\ud800-\\udfff"+fe+"\\ufe0e\\ufe0f]"),Fe=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Le=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ue=-1,ze={};ze[A]=ze[N]=ze[T]=ze[O]=ze[j]=ze[C]=ze["[object Uint8ClampedArray]"]=ze[I]=ze[R]=!0,ze[u]=ze[c]=ze[x]=ze[d]=ze[E]=ze[l]=ze[f]=ze[h]=ze[g]=ze[m]=ze[v]=ze[_]=ze[y]=ze[b]=ze[S]=!1;var Be={};Be[u]=Be[c]=Be[x]=Be[E]=Be[d]=Be[l]=Be[A]=Be[N]=Be[T]=Be[O]=Be[j]=Be[g]=Be[m]=Be[v]=Be[_]=Be[y]=Be[b]=Be[w]=Be[C]=Be["[object Uint8ClampedArray]"]=Be[I]=Be[R]=!0,Be[f]=Be[h]=Be[S]=!1;var $e={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},He=parseFloat,qe=parseInt,Je="object"==typeof e&&e&&e.Object===Object&&e,We="object"==typeof self&&self&&self.Object===Object&&self,Ve=Je||We||Function("return this")(),Ge=t&&!t.nodeType&&t,Ye=Ge&&"object"==typeof r&&r&&!r.nodeType&&r,Xe=Ye&&Ye.exports===Ge,Qe=Xe&&Je.process,Ke=function(){try{var e=Ye&&Ye.require&&Ye.require("util").types;return e||Qe&&Qe.binding&&Qe.binding("util")}catch(e){}}(),Ze=Ke&&Ke.isArrayBuffer,et=Ke&&Ke.isDate,tt=Ke&&Ke.isMap,nt=Ke&&Ke.isRegExp,rt=Ke&&Ke.isSet,it=Ke&&Ke.isTypedArray;function ot(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function st(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}function at(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function ut(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function ct(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function dt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}function lt(e,t){return!!(null==e?0:e.length)&&wt(e,t,0)>-1}function ft(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function ht(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function pt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function gt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function mt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function vt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var _t=At("length");function yt(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function bt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function wt(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):bt(e,xt,n)}function St(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function xt(e){return e!=e}function Et(e,t){var n=null==e?0:e.length;return n?Ot(e,t)/n:NaN}function At(e){return function(t){return null==t?void 0:t[e]}}function Nt(e){return function(t){return null==e?void 0:e[t]}}function Tt(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function Ot(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}function jt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Ct(e){return e?e.slice(0,Gt(e)+1).replace(G,""):e}function It(e){return function(t){return e(t)}}function Rt(e,t){return ht(t,(function(t){return e[t]}))}function Mt(e,t){return e.has(t)}function kt(e,t){for(var n=-1,r=e.length;++n<r&&wt(t,e[n],0)>-1;);return n}function Dt(e,t){for(var n=e.length;n--&&wt(t,e[n],0)>-1;);return n}function Pt(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var Ft=Nt({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Lt=Nt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Ut(e){return"\\"+$e[e]}function zt(e){return Pe.test(e)}function Bt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function $t(e,t){return function(n){return e(t(n))}}function Ht(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==s||(e[n]=s,o[i++]=n)}return o}function qt(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function Jt(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function Wt(e){return zt(e)?function(e){var t=ke.lastIndex=0;for(;ke.test(e);)++t;return t}(e):_t(e)}function Vt(e){return zt(e)?function(e){return e.match(ke)||[]}(e):function(e){return e.split("")}(e)}function Gt(e){for(var t=e.length;t--&&Y.test(e.charAt(t)););return t}var Yt=Nt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Xt=function e(t){var n,r=(t=null==t?Ve:Xt.defaults(Ve.Object(),t,Xt.pick(Ve,Le))).Array,i=t.Date,Y=t.Error,fe=t.Function,he=t.Math,pe=t.Object,ge=t.RegExp,me=t.String,ve=t.TypeError,_e=r.prototype,ye=fe.prototype,be=pe.prototype,we=t["__core-js_shared__"],Se=ye.toString,xe=be.hasOwnProperty,Ee=0,Ae=(n=/[^.]+$/.exec(we&&we.keys&&we.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Ne=be.toString,Te=Se.call(pe),Oe=Ve._,je=ge("^"+Se.call(xe).replace(W,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ce=Xe?t.Buffer:void 0,Ie=t.Symbol,ke=t.Uint8Array,Pe=Ce?Ce.allocUnsafe:void 0,$e=$t(pe.getPrototypeOf,pe),Je=pe.create,We=be.propertyIsEnumerable,Ge=_e.splice,Ye=Ie?Ie.isConcatSpreadable:void 0,Qe=Ie?Ie.iterator:void 0,Ke=Ie?Ie.toStringTag:void 0,_t=function(){try{var e=eo(pe,"defineProperty");return e({},"",{}),e}catch(e){}}(),Nt=t.clearTimeout!==Ve.clearTimeout&&t.clearTimeout,Qt=i&&i.now!==Ve.Date.now&&i.now,Kt=t.setTimeout!==Ve.setTimeout&&t.setTimeout,Zt=he.ceil,en=he.floor,tn=pe.getOwnPropertySymbols,nn=Ce?Ce.isBuffer:void 0,rn=t.isFinite,on=_e.join,sn=$t(pe.keys,pe),an=he.max,un=he.min,cn=i.now,dn=t.parseInt,ln=he.random,fn=_e.reverse,hn=eo(t,"DataView"),pn=eo(t,"Map"),gn=eo(t,"Promise"),mn=eo(t,"Set"),vn=eo(t,"WeakMap"),_n=eo(pe,"create"),yn=vn&&new vn,bn={},wn=Oo(hn),Sn=Oo(pn),xn=Oo(gn),En=Oo(mn),An=Oo(vn),Nn=Ie?Ie.prototype:void 0,Tn=Nn?Nn.valueOf:void 0,On=Nn?Nn.toString:void 0;function jn(e){if(Js(e)&&!ks(e)&&!(e instanceof Mn)){if(e instanceof Rn)return e;if(xe.call(e,"__wrapped__"))return jo(e)}return new Rn(e)}var Cn=function(){function e(){}return function(t){if(!qs(t))return{};if(Je)return Je(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function In(){}function Rn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function Mn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function kn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Dn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Pn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Fn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Pn;++t<n;)this.add(e[t])}function Ln(e){var t=this.__data__=new Dn(e);this.size=t.size}function Un(e,t){var n=ks(e),r=!n&&Ms(e),i=!n&&!r&&Ls(e),o=!n&&!r&&!i&&Zs(e),s=n||r||i||o,a=s?jt(e.length,me):[],u=a.length;for(var c in e)!t&&!xe.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ao(c,u))||a.push(c);return a}function zn(e){var t=e.length;return t?e[Fr(0,t-1)]:void 0}function Bn(e,t){return Ao(_i(e),Xn(t,0,e.length))}function $n(e){return Ao(_i(e))}function Hn(e,t,n){(void 0!==n&&!Cs(e[t],n)||void 0===n&&!(t in e))&&Gn(e,t,n)}function qn(e,t,n){var r=e[t];xe.call(e,t)&&Cs(r,n)&&(void 0!==n||t in e)||Gn(e,t,n)}function Jn(e,t){for(var n=e.length;n--;)if(Cs(e[n][0],t))return n;return-1}function Wn(e,t,n,r){return tr(e,(function(e,i,o){t(r,e,n(e),o)})),r}function Vn(e,t){return e&&yi(t,wa(t),e)}function Gn(e,t,n){"__proto__"==t&&_t?_t(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Yn(e,t){for(var n=-1,i=t.length,o=r(i),s=null==e;++n<i;)o[n]=s?void 0:ma(e,t[n]);return o}function Xn(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function Qn(e,t,n,r,i,o){var s,a=1&t,c=2&t,f=4&t;if(n&&(s=i?n(e,r,i,o):n(e)),void 0!==s)return s;if(!qs(e))return e;var S=ks(e);if(S){if(s=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&xe.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!a)return _i(e,s)}else{var M=ro(e),k=M==h||M==p;if(Ls(e))return fi(e,a);if(M==v||M==u||k&&!i){if(s=c||k?{}:oo(e),!a)return c?function(e,t){return yi(e,no(e),t)}(e,function(e,t){return e&&yi(t,Sa(t),e)}(s,e)):function(e,t){return yi(e,to(e),t)}(e,Vn(s,e))}else{if(!Be[M])return i?e:{};s=function(e,t,n){var r=e.constructor;switch(t){case x:return hi(e);case d:case l:return new r(+e);case E:return function(e,t){var n=t?hi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case A:case N:case T:case O:case j:case C:case"[object Uint8ClampedArray]":case I:case R:return pi(e,n);case g:return new r;case m:case b:return new r(e);case _:return function(e){var t=new e.constructor(e.source,re.exec(e));return t.lastIndex=e.lastIndex,t}(e);case y:return new r;case w:return i=e,Tn?pe(Tn.call(i)):{}}var i}(e,M,a)}}o||(o=new Ln);var D=o.get(e);if(D)return D;o.set(e,s),Xs(e)?e.forEach((function(r){s.add(Qn(r,t,n,r,e,o))})):Ws(e)&&e.forEach((function(r,i){s.set(i,Qn(r,t,n,i,e,o))}));var P=S?void 0:(f?c?Vi:Wi:c?Sa:wa)(e);return at(P||e,(function(r,i){P&&(r=e[i=r]),qn(s,i,Qn(r,t,n,i,e,o))})),s}function Kn(e,t,n){var r=n.length;if(null==e)return!r;for(e=pe(e);r--;){var i=n[r],o=t[i],s=e[i];if(void 0===s&&!(i in e)||!o(s))return!1}return!0}function Zn(e,t,n){if("function"!=typeof e)throw new ve(o);return wo((function(){e.apply(void 0,n)}),t)}function er(e,t,n,r){var i=-1,o=lt,s=!0,a=e.length,u=[],c=t.length;if(!a)return u;n&&(t=ht(t,It(n))),r?(o=ft,s=!1):t.length>=200&&(o=Mt,s=!1,t=new Fn(t));e:for(;++i<a;){var d=e[i],l=null==n?d:n(d);if(d=r||0!==d?d:0,s&&l==l){for(var f=c;f--;)if(t[f]===l)continue e;u.push(d)}else o(t,l,r)||u.push(d)}return u}jn.templateSettings={escape:z,evaluate:B,interpolate:$,variable:"",imports:{_:jn}},jn.prototype=In.prototype,jn.prototype.constructor=jn,Rn.prototype=Cn(In.prototype),Rn.prototype.constructor=Rn,Mn.prototype=Cn(In.prototype),Mn.prototype.constructor=Mn,kn.prototype.clear=function(){this.__data__=_n?_n(null):{},this.size=0},kn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},kn.prototype.get=function(e){var t=this.__data__;if(_n){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return xe.call(t,e)?t[e]:void 0},kn.prototype.has=function(e){var t=this.__data__;return _n?void 0!==t[e]:xe.call(t,e)},kn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=_n&&void 0===t?"__lodash_hash_undefined__":t,this},Dn.prototype.clear=function(){this.__data__=[],this.size=0},Dn.prototype.delete=function(e){var t=this.__data__,n=Jn(t,e);return!(n<0)&&(n==t.length-1?t.pop():Ge.call(t,n,1),--this.size,!0)},Dn.prototype.get=function(e){var t=this.__data__,n=Jn(t,e);return n<0?void 0:t[n][1]},Dn.prototype.has=function(e){return Jn(this.__data__,e)>-1},Dn.prototype.set=function(e,t){var n=this.__data__,r=Jn(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Pn.prototype.clear=function(){this.size=0,this.__data__={hash:new kn,map:new(pn||Dn),string:new kn}},Pn.prototype.delete=function(e){var t=Ki(this,e).delete(e);return this.size-=t?1:0,t},Pn.prototype.get=function(e){return Ki(this,e).get(e)},Pn.prototype.has=function(e){return Ki(this,e).has(e)},Pn.prototype.set=function(e,t){var n=Ki(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Fn.prototype.add=Fn.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Fn.prototype.has=function(e){return this.__data__.has(e)},Ln.prototype.clear=function(){this.__data__=new Dn,this.size=0},Ln.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Ln.prototype.get=function(e){return this.__data__.get(e)},Ln.prototype.has=function(e){return this.__data__.has(e)},Ln.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Dn){var r=n.__data__;if(!pn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Pn(r)}return n.set(e,t),this.size=n.size,this};var tr=Si(cr),nr=Si(dr,!0);function rr(e,t){var n=!0;return tr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function ir(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],s=t(o);if(null!=s&&(void 0===a?s==s&&!Ks(s):n(s,a)))var a=s,u=o}return u}function or(e,t){var n=[];return tr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function sr(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=so),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?sr(a,t-1,n,r,i):pt(i,a):r||(i[i.length]=a)}return i}var ar=xi(),ur=xi(!0);function cr(e,t){return e&&ar(e,t,wa)}function dr(e,t){return e&&ur(e,t,wa)}function lr(e,t){return dt(t,(function(t){return Bs(e[t])}))}function fr(e,t){for(var n=0,r=(t=ui(t,e)).length;null!=e&&n<r;)e=e[To(t[n++])];return n&&n==r?e:void 0}function hr(e,t,n){var r=t(e);return ks(e)?r:pt(r,n(e))}function pr(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Ke&&Ke in pe(e)?function(e){var t=xe.call(e,Ke),n=e[Ke];try{e[Ke]=void 0;var r=!0}catch(e){}var i=Ne.call(e);r&&(t?e[Ke]=n:delete e[Ke]);return i}(e):function(e){return Ne.call(e)}(e)}function gr(e,t){return e>t}function mr(e,t){return null!=e&&xe.call(e,t)}function vr(e,t){return null!=e&&t in pe(e)}function _r(e,t,n){for(var i=n?ft:lt,o=e[0].length,s=e.length,a=s,u=r(s),c=1/0,d=[];a--;){var l=e[a];a&&t&&(l=ht(l,It(t))),c=un(l.length,c),u[a]=!n&&(t||o>=120&&l.length>=120)?new Fn(a&&l):void 0}l=e[0];var f=-1,h=u[0];e:for(;++f<o&&d.length<c;){var p=l[f],g=t?t(p):p;if(p=n||0!==p?p:0,!(h?Mt(h,g):i(d,g,n))){for(a=s;--a;){var m=u[a];if(!(m?Mt(m,g):i(e[a],g,n)))continue e}h&&h.push(g),d.push(p)}}return d}function yr(e,t,n){var r=null==(e=vo(e,t=ui(t,e)))?e:e[To(zo(t))];return null==r?void 0:ot(r,e,n)}function br(e){return Js(e)&&pr(e)==u}function wr(e,t,n,r,i){return e===t||(null==e||null==t||!Js(e)&&!Js(t)?e!=e&&t!=t:function(e,t,n,r,i,o){var s=ks(e),a=ks(t),h=s?c:ro(e),p=a?c:ro(t),S=(h=h==u?v:h)==v,A=(p=p==u?v:p)==v,N=h==p;if(N&&Ls(e)){if(!Ls(t))return!1;s=!0,S=!1}if(N&&!S)return o||(o=new Ln),s||Zs(e)?qi(e,t,n,r,i,o):function(e,t,n,r,i,o,s){switch(n){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case x:return!(e.byteLength!=t.byteLength||!o(new ke(e),new ke(t)));case d:case l:case m:return Cs(+e,+t);case f:return e.name==t.name&&e.message==t.message;case _:case b:return e==t+"";case g:var a=Bt;case y:var u=1&r;if(a||(a=qt),e.size!=t.size&&!u)return!1;var c=s.get(e);if(c)return c==t;r|=2,s.set(e,t);var h=qi(a(e),a(t),r,i,o,s);return s.delete(e),h;case w:if(Tn)return Tn.call(e)==Tn.call(t)}return!1}(e,t,h,n,r,i,o);if(!(1&n)){var T=S&&xe.call(e,"__wrapped__"),O=A&&xe.call(t,"__wrapped__");if(T||O){var j=T?e.value():e,C=O?t.value():t;return o||(o=new Ln),i(j,C,n,r,o)}}if(!N)return!1;return o||(o=new Ln),function(e,t,n,r,i,o){var s=1&n,a=Wi(e),u=a.length,c=Wi(t).length;if(u!=c&&!s)return!1;var d=u;for(;d--;){var l=a[d];if(!(s?l in t:xe.call(t,l)))return!1}var f=o.get(e),h=o.get(t);if(f&&h)return f==t&&h==e;var p=!0;o.set(e,t),o.set(t,e);var g=s;for(;++d<u;){l=a[d];var m=e[l],v=t[l];if(r)var _=s?r(v,m,l,t,e,o):r(m,v,l,e,t,o);if(!(void 0===_?m===v||i(m,v,n,r,o):_)){p=!1;break}g||(g="constructor"==l)}if(p&&!g){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(p=!1)}return o.delete(e),o.delete(t),p}(e,t,n,r,i,o)}(e,t,n,r,wr,i))}function Sr(e,t,n,r){var i=n.length,o=i,s=!r;if(null==e)return!o;for(e=pe(e);i--;){var a=n[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var u=(a=n[i])[0],c=e[u],d=a[1];if(s&&a[2]){if(void 0===c&&!(u in e))return!1}else{var l=new Ln;if(r)var f=r(c,d,u,e,t,l);if(!(void 0===f?wr(d,c,3,r,l):f))return!1}}return!0}function xr(e){return!(!qs(e)||(t=e,Ae&&Ae in t))&&(Bs(e)?je:se).test(Oo(e));var t}function Er(e){return"function"==typeof e?e:null==e?Va:"object"==typeof e?ks(e)?Cr(e[0],e[1]):jr(e):nu(e)}function Ar(e){if(!ho(e))return sn(e);var t=[];for(var n in pe(e))xe.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Nr(e){if(!qs(e))return function(e){var t=[];if(null!=e)for(var n in pe(e))t.push(n);return t}(e);var t=ho(e),n=[];for(var r in e)("constructor"!=r||!t&&xe.call(e,r))&&n.push(r);return n}function Tr(e,t){return e<t}function Or(e,t){var n=-1,i=Ps(e)?r(e.length):[];return tr(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function jr(e){var t=Zi(e);return 1==t.length&&t[0][2]?go(t[0][0],t[0][1]):function(n){return n===e||Sr(n,e,t)}}function Cr(e,t){return co(e)&&po(t)?go(To(e),t):function(n){var r=ma(n,e);return void 0===r&&r===t?va(n,e):wr(t,r,3)}}function Ir(e,t,n,r,i){e!==t&&ar(t,(function(o,s){if(i||(i=new Ln),qs(o))!function(e,t,n,r,i,o,s){var a=yo(e,n),u=yo(t,n),c=s.get(u);if(c)return void Hn(e,n,c);var d=o?o(a,u,n+"",e,t,s):void 0,l=void 0===d;if(l){var f=ks(u),h=!f&&Ls(u),p=!f&&!h&&Zs(u);d=u,f||h||p?ks(a)?d=a:Fs(a)?d=_i(a):h?(l=!1,d=fi(u,!0)):p?(l=!1,d=pi(u,!0)):d=[]:Gs(u)||Ms(u)?(d=a,Ms(a)?d=aa(a):qs(a)&&!Bs(a)||(d=oo(u))):l=!1}l&&(s.set(u,d),i(d,u,r,o,s),s.delete(u));Hn(e,n,d)}(e,t,s,n,Ir,r,i);else{var a=r?r(yo(e,s),o,s+"",e,t,i):void 0;void 0===a&&(a=o),Hn(e,s,a)}}),Sa)}function Rr(e,t){var n=e.length;if(n)return ao(t+=t<0?n:0,n)?e[t]:void 0}function Mr(e,t,n){t=t.length?ht(t,(function(e){return ks(e)?function(t){return fr(t,1===e.length?e[0]:e)}:e})):[Va];var r=-1;return t=ht(t,It(Qi())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(Or(e,(function(e,n,i){return{criteria:ht(t,(function(t){return t(e)})),index:++r,value:e}})),(function(e,t){return function(e,t,n){var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;for(;++r<s;){var u=gi(i[r],o[r]);if(u){if(r>=a)return u;var c=n[r];return u*("desc"==c?-1:1)}}return e.index-t.index}(e,t,n)}))}function kr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=fr(e,s);n(a,s)&&$r(o,ui(s,e),a)}return o}function Dr(e,t,n,r){var i=r?St:wt,o=-1,s=t.length,a=e;for(e===t&&(t=_i(t)),n&&(a=ht(e,It(n)));++o<s;)for(var u=0,c=t[o],d=n?n(c):c;(u=i(a,d,u,r))>-1;)a!==e&&Ge.call(a,u,1),Ge.call(e,u,1);return e}function Pr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;ao(i)?Ge.call(e,i,1):ei(e,i)}}return e}function Fr(e,t){return e+en(ln()*(t-e+1))}function Lr(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=en(t/2))&&(e+=e)}while(t);return n}function Ur(e,t){return So(mo(e,t,Va),e+"")}function zr(e){return zn(Ca(e))}function Br(e,t){var n=Ca(e);return Ao(n,Xn(t,0,n.length))}function $r(e,t,n,r){if(!qs(e))return e;for(var i=-1,o=(t=ui(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var u=To(t[i]),c=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(i!=s){var d=a[u];void 0===(c=r?r(d,u,a):void 0)&&(c=qs(d)?d:ao(t[i+1])?[]:{})}qn(a,u,c),a=a[u]}return e}var Hr=yn?function(e,t){return yn.set(e,t),e}:Va,qr=_t?function(e,t){return _t(e,"toString",{configurable:!0,enumerable:!1,value:qa(t),writable:!0})}:Va;function Jr(e){return Ao(Ca(e))}function Wr(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var s=r(o);++i<o;)s[i]=e[i+t];return s}function Vr(e,t){var n;return tr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function Gr(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=e[o];null!==s&&!Ks(s)&&(n?s<=t:s<t)?r=o+1:i=o}return i}return Yr(e,t,Va,n)}function Yr(e,t,n,r){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var s=(t=n(t))!=t,a=null===t,u=Ks(t),c=void 0===t;i<o;){var d=en((i+o)/2),l=n(e[d]),f=void 0!==l,h=null===l,p=l==l,g=Ks(l);if(s)var m=r||p;else m=c?p&&(r||f):a?p&&f&&(r||!h):u?p&&f&&!h&&(r||!g):!h&&!g&&(r?l<=t:l<t);m?i=d+1:o=d}return un(o,4294967294)}function Xr(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n],a=t?t(s):s;if(!n||!Cs(a,u)){var u=a;o[i++]=0===s?0:s}}return o}function Qr(e){return"number"==typeof e?e:Ks(e)?NaN:+e}function Kr(e){if("string"==typeof e)return e;if(ks(e))return ht(e,Kr)+"";if(Ks(e))return On?On.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Zr(e,t,n){var r=-1,i=lt,o=e.length,s=!0,a=[],u=a;if(n)s=!1,i=ft;else if(o>=200){var c=t?null:Li(e);if(c)return qt(c);s=!1,i=Mt,u=new Fn}else u=t?[]:a;e:for(;++r<o;){var d=e[r],l=t?t(d):d;if(d=n||0!==d?d:0,s&&l==l){for(var f=u.length;f--;)if(u[f]===l)continue e;t&&u.push(l),a.push(d)}else i(u,l,n)||(u!==a&&u.push(l),a.push(d))}return a}function ei(e,t){return null==(e=vo(e,t=ui(t,e)))||delete e[To(zo(t))]}function ti(e,t,n,r){return $r(e,t,n(fr(e,t)),r)}function ni(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Wr(e,r?0:o,r?o+1:i):Wr(e,r?o+1:0,r?i:o)}function ri(e,t){var n=e;return n instanceof Mn&&(n=n.value()),gt(t,(function(e,t){return t.func.apply(t.thisArg,pt([e],t.args))}),n)}function ii(e,t,n){var i=e.length;if(i<2)return i?Zr(e[0]):[];for(var o=-1,s=r(i);++o<i;)for(var a=e[o],u=-1;++u<i;)u!=o&&(s[o]=er(s[o]||a,e[u],t,n));return Zr(sr(s,1),t,n)}function oi(e,t,n){for(var r=-1,i=e.length,o=t.length,s={};++r<i;){var a=r<o?t[r]:void 0;n(s,e[r],a)}return s}function si(e){return Fs(e)?e:[]}function ai(e){return"function"==typeof e?e:Va}function ui(e,t){return ks(e)?e:co(e,t)?[e]:No(ua(e))}var ci=Ur;function di(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:Wr(e,t,n)}var li=Nt||function(e){return Ve.clearTimeout(e)};function fi(e,t){if(t)return e.slice();var n=e.length,r=Pe?Pe(n):new e.constructor(n);return e.copy(r),r}function hi(e){var t=new e.constructor(e.byteLength);return new ke(t).set(new ke(e)),t}function pi(e,t){var n=t?hi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function gi(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=Ks(e),s=void 0!==t,a=null===t,u=t==t,c=Ks(t);if(!a&&!c&&!o&&e>t||o&&s&&u&&!a&&!c||r&&s&&u||!n&&u||!i)return 1;if(!r&&!o&&!c&&e<t||c&&n&&i&&!r&&!o||a&&n&&i||!s&&i||!u)return-1}return 0}function mi(e,t,n,i){for(var o=-1,s=e.length,a=n.length,u=-1,c=t.length,d=an(s-a,0),l=r(c+d),f=!i;++u<c;)l[u]=t[u];for(;++o<a;)(f||o<s)&&(l[n[o]]=e[o]);for(;d--;)l[u++]=e[o++];return l}function vi(e,t,n,i){for(var o=-1,s=e.length,a=-1,u=n.length,c=-1,d=t.length,l=an(s-u,0),f=r(l+d),h=!i;++o<l;)f[o]=e[o];for(var p=o;++c<d;)f[p+c]=t[c];for(;++a<u;)(h||o<s)&&(f[p+n[a]]=e[o++]);return f}function _i(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function yi(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],u=r?r(n[a],e[a],a,n,e):void 0;void 0===u&&(u=e[a]),i?Gn(n,a,u):qn(n,a,u)}return n}function bi(e,t){return function(n,r){var i=ks(n)?st:Wn,o=t?t():{};return i(n,e,Qi(r,2),o)}}function wi(e){return Ur((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&uo(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=pe(t);++r<i;){var a=n[r];a&&e(t,a,r,o)}return t}))}function Si(e,t){return function(n,r){if(null==n)return n;if(!Ps(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=pe(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}function xi(e){return function(t,n,r){for(var i=-1,o=pe(t),s=r(t),a=s.length;a--;){var u=s[e?a:++i];if(!1===n(o[u],u,o))break}return t}}function Ei(e){return function(t){var n=zt(t=ua(t))?Vt(t):void 0,r=n?n[0]:t.charAt(0),i=n?di(n,1).join(""):t.slice(1);return r[e]()+i}}function Ai(e){return function(t){return gt(Ba(Ma(t).replace(Re,"")),e,"")}}function Ni(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Cn(e.prototype),r=e.apply(n,t);return qs(r)?r:n}}function Ti(e){return function(t,n,r){var i=pe(t);if(!Ps(t)){var o=Qi(n,3);t=wa(t),n=function(e){return o(i[e],e,i)}}var s=e(t,n,r);return s>-1?i[o?t[s]:s]:void 0}}function Oi(e){return Ji((function(t){var n=t.length,r=n,i=Rn.prototype.thru;for(e&&t.reverse();r--;){var s=t[r];if("function"!=typeof s)throw new ve(o);if(i&&!a&&"wrapper"==Yi(s))var a=new Rn([],!0)}for(r=a?r:n;++r<n;){var u=Yi(s=t[r]),c="wrapper"==u?Gi(s):void 0;a=c&&lo(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?a[Yi(c[0])].apply(a,c[3]):1==s.length&&lo(s)?a[u]():a.thru(s)}return function(){var e=arguments,r=e[0];if(a&&1==e.length&&ks(r))return a.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function ji(e,t,n,i,o,s,a,u,c,d){var l=128&t,f=1&t,h=2&t,p=24&t,g=512&t,m=h?void 0:Ni(e);return function v(){for(var _=arguments.length,y=r(_),b=_;b--;)y[b]=arguments[b];if(p)var w=Xi(v),S=Pt(y,w);if(i&&(y=mi(y,i,o,p)),s&&(y=vi(y,s,a,p)),_-=S,p&&_<d){var x=Ht(y,w);return Pi(e,t,ji,v.placeholder,n,y,x,u,c,d-_)}var E=f?n:this,A=h?E[e]:e;return _=y.length,u?y=_o(y,u):g&&_>1&&y.reverse(),l&&c<_&&(y.length=c),this&&this!==Ve&&this instanceof v&&(A=m||Ni(A)),A.apply(E,y)}}function Ci(e,t){return function(n,r){return function(e,t,n,r){return cr(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function Ii(e,t){return function(n,r){var i;if(void 0===n&&void 0===r)return t;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=Kr(n),r=Kr(r)):(n=Qr(n),r=Qr(r)),i=e(n,r)}return i}}function Ri(e){return Ji((function(t){return t=ht(t,It(Qi())),Ur((function(n){var r=this;return e(t,(function(e){return ot(e,r,n)}))}))}))}function Mi(e,t){var n=(t=void 0===t?" ":Kr(t)).length;if(n<2)return n?Lr(t,e):t;var r=Lr(t,Zt(e/Wt(t)));return zt(t)?di(Vt(r),0,e).join(""):r.slice(0,e)}function ki(e){return function(t,n,i){return i&&"number"!=typeof i&&uo(t,n,i)&&(n=i=void 0),t=ra(t),void 0===n?(n=t,t=0):n=ra(n),function(e,t,n,i){for(var o=-1,s=an(Zt((t-e)/(n||1)),0),a=r(s);s--;)a[i?s:++o]=e,e+=n;return a}(t,n,i=void 0===i?t<n?1:-1:ra(i),e)}}function Di(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=sa(t),n=sa(n)),e(t,n)}}function Pi(e,t,n,r,i,o,s,a,u,c){var d=8&t;t|=d?32:64,4&(t&=~(d?64:32))||(t&=-4);var l=[e,t,i,d?o:void 0,d?s:void 0,d?void 0:o,d?void 0:s,a,u,c],f=n.apply(void 0,l);return lo(e)&&bo(f,l),f.placeholder=r,xo(f,e,t)}function Fi(e){var t=he[e];return function(e,n){if(e=sa(e),(n=null==n?0:un(ia(n),292))&&rn(e)){var r=(ua(e)+"e").split("e");return+((r=(ua(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Li=mn&&1/qt(new mn([,-0]))[1]==1/0?function(e){return new mn(e)}:Ka;function Ui(e){return function(t){var n=ro(t);return n==g?Bt(t):n==y?Jt(t):function(e,t){return ht(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function zi(e,t,n,i,a,u,c,d){var l=2&t;if(!l&&"function"!=typeof e)throw new ve(o);var f=i?i.length:0;if(f||(t&=-97,i=a=void 0),c=void 0===c?c:an(ia(c),0),d=void 0===d?d:ia(d),f-=a?a.length:0,64&t){var h=i,p=a;i=a=void 0}var g=l?void 0:Gi(e),m=[e,t,n,i,a,h,p,u,c,d];if(g&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=128==r&&8==n||128==r&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var u=t[3];if(u){var c=e[3];e[3]=c?mi(c,u,t[4]):u,e[4]=c?Ht(e[3],s):t[4]}(u=t[5])&&(c=e[5],e[5]=c?vi(c,u,t[6]):u,e[6]=c?Ht(e[5],s):t[6]);(u=t[7])&&(e[7]=u);128&r&&(e[8]=null==e[8]?t[8]:un(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(m,g),e=m[0],t=m[1],n=m[2],i=m[3],a=m[4],!(d=m[9]=void 0===m[9]?l?0:e.length:an(m[9]-f,0))&&24&t&&(t&=-25),t&&1!=t)v=8==t||16==t?function(e,t,n){var i=Ni(e);return function o(){for(var s=arguments.length,a=r(s),u=s,c=Xi(o);u--;)a[u]=arguments[u];var d=s<3&&a[0]!==c&&a[s-1]!==c?[]:Ht(a,c);if((s-=d.length)<n)return Pi(e,t,ji,o.placeholder,void 0,a,d,void 0,void 0,n-s);var l=this&&this!==Ve&&this instanceof o?i:e;return ot(l,this,a)}}(e,t,d):32!=t&&33!=t||a.length?ji.apply(void 0,m):function(e,t,n,i){var o=1&t,s=Ni(e);return function t(){for(var a=-1,u=arguments.length,c=-1,d=i.length,l=r(d+u),f=this&&this!==Ve&&this instanceof t?s:e;++c<d;)l[c]=i[c];for(;u--;)l[c++]=arguments[++a];return ot(f,o?n:this,l)}}(e,t,n,i);else var v=function(e,t,n){var r=1&t,i=Ni(e);return function t(){var o=this&&this!==Ve&&this instanceof t?i:e;return o.apply(r?n:this,arguments)}}(e,t,n);return xo((g?Hr:bo)(v,m),e,t)}function Bi(e,t,n,r){return void 0===e||Cs(e,be[n])&&!xe.call(r,n)?t:e}function $i(e,t,n,r,i,o){return qs(e)&&qs(t)&&(o.set(t,e),Ir(e,t,void 0,$i,o),o.delete(t)),e}function Hi(e){return Gs(e)?void 0:e}function qi(e,t,n,r,i,o){var s=1&n,a=e.length,u=t.length;if(a!=u&&!(s&&u>a))return!1;var c=o.get(e),d=o.get(t);if(c&&d)return c==t&&d==e;var l=-1,f=!0,h=2&n?new Fn:void 0;for(o.set(e,t),o.set(t,e);++l<a;){var p=e[l],g=t[l];if(r)var m=s?r(g,p,l,t,e,o):r(p,g,l,e,t,o);if(void 0!==m){if(m)continue;f=!1;break}if(h){if(!vt(t,(function(e,t){if(!Mt(h,t)&&(p===e||i(p,e,n,r,o)))return h.push(t)}))){f=!1;break}}else if(p!==g&&!i(p,g,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function Ji(e){return So(mo(e,void 0,Do),e+"")}function Wi(e){return hr(e,wa,to)}function Vi(e){return hr(e,Sa,no)}var Gi=yn?function(e){return yn.get(e)}:Ka;function Yi(e){for(var t=e.name+"",n=bn[t],r=xe.call(bn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function Xi(e){return(xe.call(jn,"placeholder")?jn:e).placeholder}function Qi(){var e=jn.iteratee||Ga;return e=e===Ga?Er:e,arguments.length?e(arguments[0],arguments[1]):e}function Ki(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Zi(e){for(var t=wa(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,po(i)]}return t}function eo(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return xr(n)?n:void 0}var to=tn?function(e){return null==e?[]:(e=pe(e),dt(tn(e),(function(t){return We.call(e,t)})))}:ou,no=tn?function(e){for(var t=[];e;)pt(t,to(e)),e=$e(e);return t}:ou,ro=pr;function io(e,t,n){for(var r=-1,i=(t=ui(t,e)).length,o=!1;++r<i;){var s=To(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Hs(i)&&ao(s,i)&&(ks(e)||Ms(e))}function oo(e){return"function"!=typeof e.constructor||ho(e)?{}:Cn($e(e))}function so(e){return ks(e)||Ms(e)||!!(Ye&&e&&e[Ye])}function ao(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&ue.test(e))&&e>-1&&e%1==0&&e<t}function uo(e,t,n){if(!qs(n))return!1;var r=typeof t;return!!("number"==r?Ps(n)&&ao(t,n.length):"string"==r&&t in n)&&Cs(n[t],e)}function co(e,t){if(ks(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Ks(e))||(q.test(e)||!H.test(e)||null!=t&&e in pe(t))}function lo(e){var t=Yi(e),n=jn[t];if("function"!=typeof n||!(t in Mn.prototype))return!1;if(e===n)return!0;var r=Gi(n);return!!r&&e===r[0]}(hn&&ro(new hn(new ArrayBuffer(1)))!=E||pn&&ro(new pn)!=g||gn&&"[object Promise]"!=ro(gn.resolve())||mn&&ro(new mn)!=y||vn&&ro(new vn)!=S)&&(ro=function(e){var t=pr(e),n=t==v?e.constructor:void 0,r=n?Oo(n):"";if(r)switch(r){case wn:return E;case Sn:return g;case xn:return"[object Promise]";case En:return y;case An:return S}return t});var fo=we?Bs:su;function ho(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||be)}function po(e){return e==e&&!qs(e)}function go(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in pe(n)))}}function mo(e,t,n){return t=an(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=an(i.length-t,0),a=r(s);++o<s;)a[o]=i[t+o];o=-1;for(var u=r(t+1);++o<t;)u[o]=i[o];return u[t]=n(a),ot(e,this,u)}}function vo(e,t){return t.length<2?e:fr(e,Wr(t,0,-1))}function _o(e,t){for(var n=e.length,r=un(t.length,n),i=_i(e);r--;){var o=t[r];e[r]=ao(o,n)?i[o]:void 0}return e}function yo(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var bo=Eo(Hr),wo=Kt||function(e,t){return Ve.setTimeout(e,t)},So=Eo(qr);function xo(e,t,n){var r=t+"";return So(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(X,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return at(a,(function(n){var r="_."+n[0];t&n[1]&&!lt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(Q);return t?t[1].split(K):[]}(r),n)))}function Eo(e){var t=0,n=0;return function(){var r=cn(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Ao(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=Fr(n,i),s=e[o];e[o]=e[n],e[n]=s}return e.length=t,e}var No=function(e){var t=Es(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(J,(function(e,n,r,i){t.push(r?i.replace(te,"$1"):n||e)})),t}));function To(e){if("string"==typeof e||Ks(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Oo(e){if(null!=e){try{return Se.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function jo(e){if(e instanceof Mn)return e.clone();var t=new Rn(e.__wrapped__,e.__chain__);return t.__actions__=_i(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Co=Ur((function(e,t){return Fs(e)?er(e,sr(t,1,Fs,!0)):[]})),Io=Ur((function(e,t){var n=zo(t);return Fs(n)&&(n=void 0),Fs(e)?er(e,sr(t,1,Fs,!0),Qi(n,2)):[]})),Ro=Ur((function(e,t){var n=zo(t);return Fs(n)&&(n=void 0),Fs(e)?er(e,sr(t,1,Fs,!0),void 0,n):[]}));function Mo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ia(n);return i<0&&(i=an(r+i,0)),bt(e,Qi(t,3),i)}function ko(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=ia(n),i=n<0?an(r+i,0):un(i,r-1)),bt(e,Qi(t,3),i,!0)}function Do(e){return(null==e?0:e.length)?sr(e,1):[]}function Po(e){return e&&e.length?e[0]:void 0}var Fo=Ur((function(e){var t=ht(e,si);return t.length&&t[0]===e[0]?_r(t):[]})),Lo=Ur((function(e){var t=zo(e),n=ht(e,si);return t===zo(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?_r(n,Qi(t,2)):[]})),Uo=Ur((function(e){var t=zo(e),n=ht(e,si);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?_r(n,void 0,t):[]}));function zo(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var Bo=Ur($o);function $o(e,t){return e&&e.length&&t&&t.length?Dr(e,t):e}var Ho=Ji((function(e,t){var n=null==e?0:e.length,r=Yn(e,t);return Pr(e,ht(t,(function(e){return ao(e,n)?+e:e})).sort(gi)),r}));function qo(e){return null==e?e:fn.call(e)}var Jo=Ur((function(e){return Zr(sr(e,1,Fs,!0))})),Wo=Ur((function(e){var t=zo(e);return Fs(t)&&(t=void 0),Zr(sr(e,1,Fs,!0),Qi(t,2))})),Vo=Ur((function(e){var t=zo(e);return t="function"==typeof t?t:void 0,Zr(sr(e,1,Fs,!0),void 0,t)}));function Go(e){if(!e||!e.length)return[];var t=0;return e=dt(e,(function(e){if(Fs(e))return t=an(e.length,t),!0})),jt(t,(function(t){return ht(e,At(t))}))}function Yo(e,t){if(!e||!e.length)return[];var n=Go(e);return null==t?n:ht(n,(function(e){return ot(t,void 0,e)}))}var Xo=Ur((function(e,t){return Fs(e)?er(e,t):[]})),Qo=Ur((function(e){return ii(dt(e,Fs))})),Ko=Ur((function(e){var t=zo(e);return Fs(t)&&(t=void 0),ii(dt(e,Fs),Qi(t,2))})),Zo=Ur((function(e){var t=zo(e);return t="function"==typeof t?t:void 0,ii(dt(e,Fs),void 0,t)})),es=Ur(Go);var ts=Ur((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,Yo(e,n)}));function ns(e){var t=jn(e);return t.__chain__=!0,t}function rs(e,t){return t(e)}var is=Ji((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return Yn(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Mn&&ao(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:rs,args:[i],thisArg:void 0}),new Rn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(i)}));var os=bi((function(e,t,n){xe.call(e,n)?++e[n]:Gn(e,n,1)}));var ss=Ti(Mo),as=Ti(ko);function us(e,t){return(ks(e)?at:tr)(e,Qi(t,3))}function cs(e,t){return(ks(e)?ut:nr)(e,Qi(t,3))}var ds=bi((function(e,t,n){xe.call(e,n)?e[n].push(t):Gn(e,n,[t])}));var ls=Ur((function(e,t,n){var i=-1,o="function"==typeof t,s=Ps(e)?r(e.length):[];return tr(e,(function(e){s[++i]=o?ot(t,e,n):yr(e,t,n)})),s})),fs=bi((function(e,t,n){Gn(e,n,t)}));function hs(e,t){return(ks(e)?ht:Or)(e,Qi(t,3))}var ps=bi((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var gs=Ur((function(e,t){if(null==e)return[];var n=t.length;return n>1&&uo(e,t[0],t[1])?t=[]:n>2&&uo(t[0],t[1],t[2])&&(t=[t[0]]),Mr(e,sr(t,1),[])})),ms=Qt||function(){return Ve.Date.now()};function vs(e,t,n){return t=n?void 0:t,zi(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function _s(e,t){var n;if("function"!=typeof t)throw new ve(o);return e=ia(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var ys=Ur((function(e,t,n){var r=1;if(n.length){var i=Ht(n,Xi(ys));r|=32}return zi(e,r,t,n,i)})),bs=Ur((function(e,t,n){var r=3;if(n.length){var i=Ht(n,Xi(bs));r|=32}return zi(t,r,e,n,i)}));function ws(e,t,n){var r,i,s,a,u,c,d=0,l=!1,f=!1,h=!0;if("function"!=typeof e)throw new ve(o);function p(t){var n=r,o=i;return r=i=void 0,d=t,a=e.apply(o,n)}function g(e){return d=e,u=wo(v,t),l?p(e):a}function m(e){var n=e-c;return void 0===c||n>=t||n<0||f&&e-d>=s}function v(){var e=ms();if(m(e))return _(e);u=wo(v,function(e){var n=t-(e-c);return f?un(n,s-(e-d)):n}(e))}function _(e){return u=void 0,h&&r?p(e):(r=i=void 0,a)}function y(){var e=ms(),n=m(e);if(r=arguments,i=this,c=e,n){if(void 0===u)return g(c);if(f)return li(u),u=wo(v,t),p(c)}return void 0===u&&(u=wo(v,t)),a}return t=sa(t)||0,qs(n)&&(l=!!n.leading,s=(f="maxWait"in n)?an(sa(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h),y.cancel=function(){void 0!==u&&li(u),d=0,r=c=i=u=void 0},y.flush=function(){return void 0===u?a:_(ms())},y}var Ss=Ur((function(e,t){return Zn(e,1,t)})),xs=Ur((function(e,t,n){return Zn(e,sa(t)||0,n)}));function Es(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ve(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Es.Cache||Pn),n}function As(e){if("function"!=typeof e)throw new ve(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Es.Cache=Pn;var Ns=ci((function(e,t){var n=(t=1==t.length&&ks(t[0])?ht(t[0],It(Qi())):ht(sr(t,1),It(Qi()))).length;return Ur((function(r){for(var i=-1,o=un(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return ot(e,this,r)}))})),Ts=Ur((function(e,t){return zi(e,32,void 0,t,Ht(t,Xi(Ts)))})),Os=Ur((function(e,t){return zi(e,64,void 0,t,Ht(t,Xi(Os)))})),js=Ji((function(e,t){return zi(e,256,void 0,void 0,void 0,t)}));function Cs(e,t){return e===t||e!=e&&t!=t}var Is=Di(gr),Rs=Di((function(e,t){return e>=t})),Ms=br(function(){return arguments}())?br:function(e){return Js(e)&&xe.call(e,"callee")&&!We.call(e,"callee")},ks=r.isArray,Ds=Ze?It(Ze):function(e){return Js(e)&&pr(e)==x};function Ps(e){return null!=e&&Hs(e.length)&&!Bs(e)}function Fs(e){return Js(e)&&Ps(e)}var Ls=nn||su,Us=et?It(et):function(e){return Js(e)&&pr(e)==l};function zs(e){if(!Js(e))return!1;var t=pr(e);return t==f||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Gs(e)}function Bs(e){if(!qs(e))return!1;var t=pr(e);return t==h||t==p||"[object AsyncFunction]"==t||"[object Proxy]"==t}function $s(e){return"number"==typeof e&&e==ia(e)}function Hs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function qs(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Js(e){return null!=e&&"object"==typeof e}var Ws=tt?It(tt):function(e){return Js(e)&&ro(e)==g};function Vs(e){return"number"==typeof e||Js(e)&&pr(e)==m}function Gs(e){if(!Js(e)||pr(e)!=v)return!1;var t=$e(e);if(null===t)return!0;var n=xe.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Se.call(n)==Te}var Ys=nt?It(nt):function(e){return Js(e)&&pr(e)==_};var Xs=rt?It(rt):function(e){return Js(e)&&ro(e)==y};function Qs(e){return"string"==typeof e||!ks(e)&&Js(e)&&pr(e)==b}function Ks(e){return"symbol"==typeof e||Js(e)&&pr(e)==w}var Zs=it?It(it):function(e){return Js(e)&&Hs(e.length)&&!!ze[pr(e)]};var ea=Di(Tr),ta=Di((function(e,t){return e<=t}));function na(e){if(!e)return[];if(Ps(e))return Qs(e)?Vt(e):_i(e);if(Qe&&e[Qe])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Qe]());var t=ro(e);return(t==g?Bt:t==y?qt:Ca)(e)}function ra(e){return e?(e=sa(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ia(e){var t=ra(e),n=t%1;return t==t?n?t-n:t:0}function oa(e){return e?Xn(ia(e),0,4294967295):0}function sa(e){if("number"==typeof e)return e;if(Ks(e))return NaN;if(qs(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=qs(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Ct(e);var n=oe.test(e);return n||ae.test(e)?qe(e.slice(2),n?2:8):ie.test(e)?NaN:+e}function aa(e){return yi(e,Sa(e))}function ua(e){return null==e?"":Kr(e)}var ca=wi((function(e,t){if(ho(t)||Ps(t))yi(t,wa(t),e);else for(var n in t)xe.call(t,n)&&qn(e,n,t[n])})),da=wi((function(e,t){yi(t,Sa(t),e)})),la=wi((function(e,t,n,r){yi(t,Sa(t),e,r)})),fa=wi((function(e,t,n,r){yi(t,wa(t),e,r)})),ha=Ji(Yn);var pa=Ur((function(e,t){e=pe(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&uo(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],s=Sa(o),a=-1,u=s.length;++a<u;){var c=s[a],d=e[c];(void 0===d||Cs(d,be[c])&&!xe.call(e,c))&&(e[c]=o[c])}return e})),ga=Ur((function(e){return e.push(void 0,$i),ot(Ea,void 0,e)}));function ma(e,t,n){var r=null==e?void 0:fr(e,t);return void 0===r?n:r}function va(e,t){return null!=e&&io(e,t,vr)}var _a=Ci((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Ne.call(t)),e[t]=n}),qa(Va)),ya=Ci((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Ne.call(t)),xe.call(e,t)?e[t].push(n):e[t]=[n]}),Qi),ba=Ur(yr);function wa(e){return Ps(e)?Un(e):Ar(e)}function Sa(e){return Ps(e)?Un(e,!0):Nr(e)}var xa=wi((function(e,t,n){Ir(e,t,n)})),Ea=wi((function(e,t,n,r){Ir(e,t,n,r)})),Aa=Ji((function(e,t){var n={};if(null==e)return n;var r=!1;t=ht(t,(function(t){return t=ui(t,e),r||(r=t.length>1),t})),yi(e,Vi(e),n),r&&(n=Qn(n,7,Hi));for(var i=t.length;i--;)ei(n,t[i]);return n}));var Na=Ji((function(e,t){return null==e?{}:function(e,t){return kr(e,t,(function(t,n){return va(e,n)}))}(e,t)}));function Ta(e,t){if(null==e)return{};var n=ht(Vi(e),(function(e){return[e]}));return t=Qi(t),kr(e,n,(function(e,n){return t(e,n[0])}))}var Oa=Ui(wa),ja=Ui(Sa);function Ca(e){return null==e?[]:Rt(e,wa(e))}var Ia=Ai((function(e,t,n){return t=t.toLowerCase(),e+(n?Ra(t):t)}));function Ra(e){return za(ua(e).toLowerCase())}function Ma(e){return(e=ua(e))&&e.replace(ce,Ft).replace(Me,"")}var ka=Ai((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Da=Ai((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Pa=Ei("toLowerCase");var Fa=Ai((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var La=Ai((function(e,t,n){return e+(n?" ":"")+za(t)}));var Ua=Ai((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),za=Ei("toUpperCase");function Ba(e,t,n){return e=ua(e),void 0===(t=n?void 0:t)?function(e){return Fe.test(e)}(e)?function(e){return e.match(De)||[]}(e):function(e){return e.match(Z)||[]}(e):e.match(t)||[]}var $a=Ur((function(e,t){try{return ot(e,void 0,t)}catch(e){return zs(e)?e:new Y(e)}})),Ha=Ji((function(e,t){return at(t,(function(t){t=To(t),Gn(e,t,ys(e[t],e))})),e}));function qa(e){return function(){return e}}var Ja=Oi(),Wa=Oi(!0);function Va(e){return e}function Ga(e){return Er("function"==typeof e?e:Qn(e,1))}var Ya=Ur((function(e,t){return function(n){return yr(n,e,t)}})),Xa=Ur((function(e,t){return function(n){return yr(e,n,t)}}));function Qa(e,t,n){var r=wa(t),i=lr(t,r);null!=n||qs(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=lr(t,wa(t)));var o=!(qs(n)&&"chain"in n&&!n.chain),s=Bs(e);return at(i,(function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),i=n.__actions__=_i(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,pt([this.value()],arguments))})})),e}function Ka(){}var Za=Ri(ht),eu=Ri(ct),tu=Ri(vt);function nu(e){return co(e)?At(To(e)):function(e){return function(t){return fr(t,e)}}(e)}var ru=ki(),iu=ki(!0);function ou(){return[]}function su(){return!1}var au=Ii((function(e,t){return e+t}),0),uu=Fi("ceil"),cu=Ii((function(e,t){return e/t}),1),du=Fi("floor");var lu,fu=Ii((function(e,t){return e*t}),1),hu=Fi("round"),pu=Ii((function(e,t){return e-t}),0);return jn.after=function(e,t){if("function"!=typeof t)throw new ve(o);return e=ia(e),function(){if(--e<1)return t.apply(this,arguments)}},jn.ary=vs,jn.assign=ca,jn.assignIn=da,jn.assignInWith=la,jn.assignWith=fa,jn.at=ha,jn.before=_s,jn.bind=ys,jn.bindAll=Ha,jn.bindKey=bs,jn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return ks(e)?e:[e]},jn.chain=ns,jn.chunk=function(e,t,n){t=(n?uo(e,t,n):void 0===t)?1:an(ia(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,s=0,a=r(Zt(i/t));o<i;)a[s++]=Wr(e,o,o+=t);return a},jn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},jn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return pt(ks(n)?_i(n):[n],sr(t,1))},jn.cond=function(e){var t=null==e?0:e.length,n=Qi();return e=t?ht(e,(function(e){if("function"!=typeof e[1])throw new ve(o);return[n(e[0]),e[1]]})):[],Ur((function(n){for(var r=-1;++r<t;){var i=e[r];if(ot(i[0],this,n))return ot(i[1],this,n)}}))},jn.conforms=function(e){return function(e){var t=wa(e);return function(n){return Kn(n,e,t)}}(Qn(e,1))},jn.constant=qa,jn.countBy=os,jn.create=function(e,t){var n=Cn(e);return null==t?n:Vn(n,t)},jn.curry=function e(t,n,r){var i=zi(t,8,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=e.placeholder,i},jn.curryRight=function e(t,n,r){var i=zi(t,16,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=e.placeholder,i},jn.debounce=ws,jn.defaults=pa,jn.defaultsDeep=ga,jn.defer=Ss,jn.delay=xs,jn.difference=Co,jn.differenceBy=Io,jn.differenceWith=Ro,jn.drop=function(e,t,n){var r=null==e?0:e.length;return r?Wr(e,(t=n||void 0===t?1:ia(t))<0?0:t,r):[]},jn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Wr(e,0,(t=r-(t=n||void 0===t?1:ia(t)))<0?0:t):[]},jn.dropRightWhile=function(e,t){return e&&e.length?ni(e,Qi(t,3),!0,!0):[]},jn.dropWhile=function(e,t){return e&&e.length?ni(e,Qi(t,3),!0):[]},jn.fill=function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&uo(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=ia(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:ia(r))<0&&(r+=i),r=n>r?0:oa(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},jn.filter=function(e,t){return(ks(e)?dt:or)(e,Qi(t,3))},jn.flatMap=function(e,t){return sr(hs(e,t),1)},jn.flatMapDeep=function(e,t){return sr(hs(e,t),1/0)},jn.flatMapDepth=function(e,t,n){return n=void 0===n?1:ia(n),sr(hs(e,t),n)},jn.flatten=Do,jn.flattenDeep=function(e){return(null==e?0:e.length)?sr(e,1/0):[]},jn.flattenDepth=function(e,t){return(null==e?0:e.length)?sr(e,t=void 0===t?1:ia(t)):[]},jn.flip=function(e){return zi(e,512)},jn.flow=Ja,jn.flowRight=Wa,jn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},jn.functions=function(e){return null==e?[]:lr(e,wa(e))},jn.functionsIn=function(e){return null==e?[]:lr(e,Sa(e))},jn.groupBy=ds,jn.initial=function(e){return(null==e?0:e.length)?Wr(e,0,-1):[]},jn.intersection=Fo,jn.intersectionBy=Lo,jn.intersectionWith=Uo,jn.invert=_a,jn.invertBy=ya,jn.invokeMap=ls,jn.iteratee=Ga,jn.keyBy=fs,jn.keys=wa,jn.keysIn=Sa,jn.map=hs,jn.mapKeys=function(e,t){var n={};return t=Qi(t,3),cr(e,(function(e,r,i){Gn(n,t(e,r,i),e)})),n},jn.mapValues=function(e,t){var n={};return t=Qi(t,3),cr(e,(function(e,r,i){Gn(n,r,t(e,r,i))})),n},jn.matches=function(e){return jr(Qn(e,1))},jn.matchesProperty=function(e,t){return Cr(e,Qn(t,1))},jn.memoize=Es,jn.merge=xa,jn.mergeWith=Ea,jn.method=Ya,jn.methodOf=Xa,jn.mixin=Qa,jn.negate=As,jn.nthArg=function(e){return e=ia(e),Ur((function(t){return Rr(t,e)}))},jn.omit=Aa,jn.omitBy=function(e,t){return Ta(e,As(Qi(t)))},jn.once=function(e){return _s(2,e)},jn.orderBy=function(e,t,n,r){return null==e?[]:(ks(t)||(t=null==t?[]:[t]),ks(n=r?void 0:n)||(n=null==n?[]:[n]),Mr(e,t,n))},jn.over=Za,jn.overArgs=Ns,jn.overEvery=eu,jn.overSome=tu,jn.partial=Ts,jn.partialRight=Os,jn.partition=ps,jn.pick=Na,jn.pickBy=Ta,jn.property=nu,jn.propertyOf=function(e){return function(t){return null==e?void 0:fr(e,t)}},jn.pull=Bo,jn.pullAll=$o,jn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Dr(e,t,Qi(n,2)):e},jn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Dr(e,t,void 0,n):e},jn.pullAt=Ho,jn.range=ru,jn.rangeRight=iu,jn.rearg=js,jn.reject=function(e,t){return(ks(e)?dt:or)(e,As(Qi(t,3)))},jn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=Qi(t,3);++r<o;){var s=e[r];t(s,r,e)&&(n.push(s),i.push(r))}return Pr(e,i),n},jn.rest=function(e,t){if("function"!=typeof e)throw new ve(o);return Ur(e,t=void 0===t?t:ia(t))},jn.reverse=qo,jn.sampleSize=function(e,t,n){return t=(n?uo(e,t,n):void 0===t)?1:ia(t),(ks(e)?Bn:Br)(e,t)},jn.set=function(e,t,n){return null==e?e:$r(e,t,n)},jn.setWith=function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:$r(e,t,n,r)},jn.shuffle=function(e){return(ks(e)?$n:Jr)(e)},jn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&uo(e,t,n)?(t=0,n=r):(t=null==t?0:ia(t),n=void 0===n?r:ia(n)),Wr(e,t,n)):[]},jn.sortBy=gs,jn.sortedUniq=function(e){return e&&e.length?Xr(e):[]},jn.sortedUniqBy=function(e,t){return e&&e.length?Xr(e,Qi(t,2)):[]},jn.split=function(e,t,n){return n&&"number"!=typeof n&&uo(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=ua(e))&&("string"==typeof t||null!=t&&!Ys(t))&&!(t=Kr(t))&&zt(e)?di(Vt(e),0,n):e.split(t,n):[]},jn.spread=function(e,t){if("function"!=typeof e)throw new ve(o);return t=null==t?0:an(ia(t),0),Ur((function(n){var r=n[t],i=di(n,0,t);return r&&pt(i,r),ot(e,this,i)}))},jn.tail=function(e){var t=null==e?0:e.length;return t?Wr(e,1,t):[]},jn.take=function(e,t,n){return e&&e.length?Wr(e,0,(t=n||void 0===t?1:ia(t))<0?0:t):[]},jn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Wr(e,(t=r-(t=n||void 0===t?1:ia(t)))<0?0:t,r):[]},jn.takeRightWhile=function(e,t){return e&&e.length?ni(e,Qi(t,3),!1,!0):[]},jn.takeWhile=function(e,t){return e&&e.length?ni(e,Qi(t,3)):[]},jn.tap=function(e,t){return t(e),e},jn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new ve(o);return qs(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),ws(e,t,{leading:r,maxWait:t,trailing:i})},jn.thru=rs,jn.toArray=na,jn.toPairs=Oa,jn.toPairsIn=ja,jn.toPath=function(e){return ks(e)?ht(e,To):Ks(e)?[e]:_i(No(ua(e)))},jn.toPlainObject=aa,jn.transform=function(e,t,n){var r=ks(e),i=r||Ls(e)||Zs(e);if(t=Qi(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:qs(e)&&Bs(o)?Cn($e(e)):{}}return(i?at:cr)(e,(function(e,r,i){return t(n,e,r,i)})),n},jn.unary=function(e){return vs(e,1)},jn.union=Jo,jn.unionBy=Wo,jn.unionWith=Vo,jn.uniq=function(e){return e&&e.length?Zr(e):[]},jn.uniqBy=function(e,t){return e&&e.length?Zr(e,Qi(t,2)):[]},jn.uniqWith=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Zr(e,void 0,t):[]},jn.unset=function(e,t){return null==e||ei(e,t)},jn.unzip=Go,jn.unzipWith=Yo,jn.update=function(e,t,n){return null==e?e:ti(e,t,ai(n))},jn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:ti(e,t,ai(n),r)},jn.values=Ca,jn.valuesIn=function(e){return null==e?[]:Rt(e,Sa(e))},jn.without=Xo,jn.words=Ba,jn.wrap=function(e,t){return Ts(ai(t),e)},jn.xor=Qo,jn.xorBy=Ko,jn.xorWith=Zo,jn.zip=es,jn.zipObject=function(e,t){return oi(e||[],t||[],qn)},jn.zipObjectDeep=function(e,t){return oi(e||[],t||[],$r)},jn.zipWith=ts,jn.entries=Oa,jn.entriesIn=ja,jn.extend=da,jn.extendWith=la,Qa(jn,jn),jn.add=au,jn.attempt=$a,jn.camelCase=Ia,jn.capitalize=Ra,jn.ceil=uu,jn.clamp=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=sa(n))==n?n:0),void 0!==t&&(t=(t=sa(t))==t?t:0),Xn(sa(e),t,n)},jn.clone=function(e){return Qn(e,4)},jn.cloneDeep=function(e){return Qn(e,5)},jn.cloneDeepWith=function(e,t){return Qn(e,5,t="function"==typeof t?t:void 0)},jn.cloneWith=function(e,t){return Qn(e,4,t="function"==typeof t?t:void 0)},jn.conformsTo=function(e,t){return null==t||Kn(e,t,wa(t))},jn.deburr=Ma,jn.defaultTo=function(e,t){return null==e||e!=e?t:e},jn.divide=cu,jn.endsWith=function(e,t,n){e=ua(e),t=Kr(t);var r=e.length,i=n=void 0===n?r:Xn(ia(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},jn.eq=Cs,jn.escape=function(e){return(e=ua(e))&&U.test(e)?e.replace(F,Lt):e},jn.escapeRegExp=function(e){return(e=ua(e))&&V.test(e)?e.replace(W,"\\$&"):e},jn.every=function(e,t,n){var r=ks(e)?ct:rr;return n&&uo(e,t,n)&&(t=void 0),r(e,Qi(t,3))},jn.find=ss,jn.findIndex=Mo,jn.findKey=function(e,t){return yt(e,Qi(t,3),cr)},jn.findLast=as,jn.findLastIndex=ko,jn.findLastKey=function(e,t){return yt(e,Qi(t,3),dr)},jn.floor=du,jn.forEach=us,jn.forEachRight=cs,jn.forIn=function(e,t){return null==e?e:ar(e,Qi(t,3),Sa)},jn.forInRight=function(e,t){return null==e?e:ur(e,Qi(t,3),Sa)},jn.forOwn=function(e,t){return e&&cr(e,Qi(t,3))},jn.forOwnRight=function(e,t){return e&&dr(e,Qi(t,3))},jn.get=ma,jn.gt=Is,jn.gte=Rs,jn.has=function(e,t){return null!=e&&io(e,t,mr)},jn.hasIn=va,jn.head=Po,jn.identity=Va,jn.includes=function(e,t,n,r){e=Ps(e)?e:Ca(e),n=n&&!r?ia(n):0;var i=e.length;return n<0&&(n=an(i+n,0)),Qs(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&wt(e,t,n)>-1},jn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ia(n);return i<0&&(i=an(r+i,0)),wt(e,t,i)},jn.inRange=function(e,t,n){return t=ra(t),void 0===n?(n=t,t=0):n=ra(n),function(e,t,n){return e>=un(t,n)&&e<an(t,n)}(e=sa(e),t,n)},jn.invoke=ba,jn.isArguments=Ms,jn.isArray=ks,jn.isArrayBuffer=Ds,jn.isArrayLike=Ps,jn.isArrayLikeObject=Fs,jn.isBoolean=function(e){return!0===e||!1===e||Js(e)&&pr(e)==d},jn.isBuffer=Ls,jn.isDate=Us,jn.isElement=function(e){return Js(e)&&1===e.nodeType&&!Gs(e)},jn.isEmpty=function(e){if(null==e)return!0;if(Ps(e)&&(ks(e)||"string"==typeof e||"function"==typeof e.splice||Ls(e)||Zs(e)||Ms(e)))return!e.length;var t=ro(e);if(t==g||t==y)return!e.size;if(ho(e))return!Ar(e).length;for(var n in e)if(xe.call(e,n))return!1;return!0},jn.isEqual=function(e,t){return wr(e,t)},jn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?wr(e,t,void 0,n):!!r},jn.isError=zs,jn.isFinite=function(e){return"number"==typeof e&&rn(e)},jn.isFunction=Bs,jn.isInteger=$s,jn.isLength=Hs,jn.isMap=Ws,jn.isMatch=function(e,t){return e===t||Sr(e,t,Zi(t))},jn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:void 0,Sr(e,t,Zi(t),n)},jn.isNaN=function(e){return Vs(e)&&e!=+e},jn.isNative=function(e){if(fo(e))throw new Y("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return xr(e)},jn.isNil=function(e){return null==e},jn.isNull=function(e){return null===e},jn.isNumber=Vs,jn.isObject=qs,jn.isObjectLike=Js,jn.isPlainObject=Gs,jn.isRegExp=Ys,jn.isSafeInteger=function(e){return $s(e)&&e>=-9007199254740991&&e<=9007199254740991},jn.isSet=Xs,jn.isString=Qs,jn.isSymbol=Ks,jn.isTypedArray=Zs,jn.isUndefined=function(e){return void 0===e},jn.isWeakMap=function(e){return Js(e)&&ro(e)==S},jn.isWeakSet=function(e){return Js(e)&&"[object WeakSet]"==pr(e)},jn.join=function(e,t){return null==e?"":on.call(e,t)},jn.kebabCase=ka,jn.last=zo,jn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=ia(n))<0?an(r+i,0):un(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):bt(e,xt,i,!0)},jn.lowerCase=Da,jn.lowerFirst=Pa,jn.lt=ea,jn.lte=ta,jn.max=function(e){return e&&e.length?ir(e,Va,gr):void 0},jn.maxBy=function(e,t){return e&&e.length?ir(e,Qi(t,2),gr):void 0},jn.mean=function(e){return Et(e,Va)},jn.meanBy=function(e,t){return Et(e,Qi(t,2))},jn.min=function(e){return e&&e.length?ir(e,Va,Tr):void 0},jn.minBy=function(e,t){return e&&e.length?ir(e,Qi(t,2),Tr):void 0},jn.stubArray=ou,jn.stubFalse=su,jn.stubObject=function(){return{}},jn.stubString=function(){return""},jn.stubTrue=function(){return!0},jn.multiply=fu,jn.nth=function(e,t){return e&&e.length?Rr(e,ia(t)):void 0},jn.noConflict=function(){return Ve._===this&&(Ve._=Oe),this},jn.noop=Ka,jn.now=ms,jn.pad=function(e,t,n){e=ua(e);var r=(t=ia(t))?Wt(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Mi(en(i),n)+e+Mi(Zt(i),n)},jn.padEnd=function(e,t,n){e=ua(e);var r=(t=ia(t))?Wt(e):0;return t&&r<t?e+Mi(t-r,n):e},jn.padStart=function(e,t,n){e=ua(e);var r=(t=ia(t))?Wt(e):0;return t&&r<t?Mi(t-r,n)+e:e},jn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),dn(ua(e).replace(G,""),t||0)},jn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&uo(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=ra(e),void 0===t?(t=e,e=0):t=ra(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=ln();return un(e+i*(t-e+He("1e-"+((i+"").length-1))),t)}return Fr(e,t)},jn.reduce=function(e,t,n){var r=ks(e)?gt:Tt,i=arguments.length<3;return r(e,Qi(t,4),n,i,tr)},jn.reduceRight=function(e,t,n){var r=ks(e)?mt:Tt,i=arguments.length<3;return r(e,Qi(t,4),n,i,nr)},jn.repeat=function(e,t,n){return t=(n?uo(e,t,n):void 0===t)?1:ia(t),Lr(ua(e),t)},jn.replace=function(){var e=arguments,t=ua(e[0]);return e.length<3?t:t.replace(e[1],e[2])},jn.result=function(e,t,n){var r=-1,i=(t=ui(t,e)).length;for(i||(i=1,e=void 0);++r<i;){var o=null==e?void 0:e[To(t[r])];void 0===o&&(r=i,o=n),e=Bs(o)?o.call(e):o}return e},jn.round=hu,jn.runInContext=e,jn.sample=function(e){return(ks(e)?zn:zr)(e)},jn.size=function(e){if(null==e)return 0;if(Ps(e))return Qs(e)?Wt(e):e.length;var t=ro(e);return t==g||t==y?e.size:Ar(e).length},jn.snakeCase=Fa,jn.some=function(e,t,n){var r=ks(e)?vt:Vr;return n&&uo(e,t,n)&&(t=void 0),r(e,Qi(t,3))},jn.sortedIndex=function(e,t){return Gr(e,t)},jn.sortedIndexBy=function(e,t,n){return Yr(e,t,Qi(n,2))},jn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=Gr(e,t);if(r<n&&Cs(e[r],t))return r}return-1},jn.sortedLastIndex=function(e,t){return Gr(e,t,!0)},jn.sortedLastIndexBy=function(e,t,n){return Yr(e,t,Qi(n,2),!0)},jn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=Gr(e,t,!0)-1;if(Cs(e[n],t))return n}return-1},jn.startCase=La,jn.startsWith=function(e,t,n){return e=ua(e),n=null==n?0:Xn(ia(n),0,e.length),t=Kr(t),e.slice(n,n+t.length)==t},jn.subtract=pu,jn.sum=function(e){return e&&e.length?Ot(e,Va):0},jn.sumBy=function(e,t){return e&&e.length?Ot(e,Qi(t,2)):0},jn.template=function(e,t,n){var r=jn.templateSettings;n&&uo(e,t,n)&&(t=void 0),e=ua(e),t=la({},t,r,Bi);var i,o,s=la({},t.imports,r.imports,Bi),a=wa(s),u=Rt(s,a),c=0,d=t.interpolate||de,l="__p += '",f=ge((t.escape||de).source+"|"+d.source+"|"+(d===$?ne:de).source+"|"+(t.evaluate||de).source+"|$","g"),h="//# sourceURL="+(xe.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ue+"]")+"\n";e.replace(f,(function(t,n,r,s,a,u){return r||(r=s),l+=e.slice(c,u).replace(le,Ut),n&&(i=!0,l+="' +\n__e("+n+") +\n'"),a&&(o=!0,l+="';\n"+a+";\n__p += '"),r&&(l+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=u+t.length,t})),l+="';\n";var p=xe.call(t,"variable")&&t.variable;if(p){if(ee.test(p))throw new Y("Invalid `variable` option passed into `_.template`")}else l="with (obj) {\n"+l+"\n}\n";l=(o?l.replace(M,""):l).replace(k,"$1").replace(D,"$1;"),l="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+l+"return __p\n}";var g=$a((function(){return fe(a,h+"return "+l).apply(void 0,u)}));if(g.source=l,zs(g))throw g;return g},jn.times=function(e,t){if((e=ia(e))<1||e>9007199254740991)return[];var n=4294967295,r=un(e,4294967295);e-=4294967295;for(var i=jt(r,t=Qi(t));++n<e;)t(n);return i},jn.toFinite=ra,jn.toInteger=ia,jn.toLength=oa,jn.toLower=function(e){return ua(e).toLowerCase()},jn.toNumber=sa,jn.toSafeInteger=function(e){return e?Xn(ia(e),-9007199254740991,9007199254740991):0===e?e:0},jn.toString=ua,jn.toUpper=function(e){return ua(e).toUpperCase()},jn.trim=function(e,t,n){if((e=ua(e))&&(n||void 0===t))return Ct(e);if(!e||!(t=Kr(t)))return e;var r=Vt(e),i=Vt(t);return di(r,kt(r,i),Dt(r,i)+1).join("")},jn.trimEnd=function(e,t,n){if((e=ua(e))&&(n||void 0===t))return e.slice(0,Gt(e)+1);if(!e||!(t=Kr(t)))return e;var r=Vt(e);return di(r,0,Dt(r,Vt(t))+1).join("")},jn.trimStart=function(e,t,n){if((e=ua(e))&&(n||void 0===t))return e.replace(G,"");if(!e||!(t=Kr(t)))return e;var r=Vt(e);return di(r,kt(r,Vt(t))).join("")},jn.truncate=function(e,t){var n=30,r="...";if(qs(t)){var i="separator"in t?t.separator:i;n="length"in t?ia(t.length):n,r="omission"in t?Kr(t.omission):r}var o=(e=ua(e)).length;if(zt(e)){var s=Vt(e);o=s.length}if(n>=o)return e;var a=n-Wt(r);if(a<1)return r;var u=s?di(s,0,a).join(""):e.slice(0,a);if(void 0===i)return u+r;if(s&&(a+=u.length-a),Ys(i)){if(e.slice(a).search(i)){var c,d=u;for(i.global||(i=ge(i.source,ua(re.exec(i))+"g")),i.lastIndex=0;c=i.exec(d);)var l=c.index;u=u.slice(0,void 0===l?a:l)}}else if(e.indexOf(Kr(i),a)!=a){var f=u.lastIndexOf(i);f>-1&&(u=u.slice(0,f))}return u+r},jn.unescape=function(e){return(e=ua(e))&&L.test(e)?e.replace(P,Yt):e},jn.uniqueId=function(e){var t=++Ee;return ua(e)+t},jn.upperCase=Ua,jn.upperFirst=za,jn.each=us,jn.eachRight=cs,jn.first=Po,Qa(jn,(lu={},cr(jn,(function(e,t){xe.call(jn.prototype,t)||(lu[t]=e)})),lu),{chain:!1}),jn.VERSION="4.17.21",at(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){jn[e].placeholder=jn})),at(["drop","take"],(function(e,t){Mn.prototype[e]=function(n){n=void 0===n?1:an(ia(n),0);var r=this.__filtered__&&!t?new Mn(this):this.clone();return r.__filtered__?r.__takeCount__=un(n,r.__takeCount__):r.__views__.push({size:un(n,4294967295),type:e+(r.__dir__<0?"Right":"")}),r},Mn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),at(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Mn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Qi(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),at(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Mn.prototype[e]=function(){return this[n](1).value()[0]}})),at(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Mn.prototype[e]=function(){return this.__filtered__?new Mn(this):this[n](1)}})),Mn.prototype.compact=function(){return this.filter(Va)},Mn.prototype.find=function(e){return this.filter(e).head()},Mn.prototype.findLast=function(e){return this.reverse().find(e)},Mn.prototype.invokeMap=Ur((function(e,t){return"function"==typeof e?new Mn(this):this.map((function(n){return yr(n,e,t)}))})),Mn.prototype.reject=function(e){return this.filter(As(Qi(e)))},Mn.prototype.slice=function(e,t){e=ia(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Mn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=ia(t))<0?n.dropRight(-t):n.take(t-e)),n)},Mn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Mn.prototype.toArray=function(){return this.take(4294967295)},cr(Mn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=jn[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(jn.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,a=t instanceof Mn,u=s[0],c=a||ks(t),d=function(e){var t=i.apply(jn,pt([e],s));return r&&l?t[0]:t};c&&n&&"function"==typeof u&&1!=u.length&&(a=c=!1);var l=this.__chain__,f=!!this.__actions__.length,h=o&&!l,p=a&&!f;if(!o&&c){t=p?t:new Mn(this);var g=e.apply(t,s);return g.__actions__.push({func:rs,args:[d],thisArg:void 0}),new Rn(g,l)}return h&&p?e.apply(this,s):(g=this.thru(d),h?r?g.value()[0]:g.value():g)})})),at(["pop","push","shift","sort","splice","unshift"],(function(e){var t=_e[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);jn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(ks(i)?i:[],e)}return this[n]((function(n){return t.apply(ks(n)?n:[],e)}))}})),cr(Mn.prototype,(function(e,t){var n=jn[t];if(n){var r=n.name+"";xe.call(bn,r)||(bn[r]=[]),bn[r].push({name:t,func:n})}})),bn[ji(void 0,2).name]=[{name:"wrapper",func:void 0}],Mn.prototype.clone=function(){var e=new Mn(this.__wrapped__);return e.__actions__=_i(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=_i(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=_i(this.__views__),e},Mn.prototype.reverse=function(){if(this.__filtered__){var e=new Mn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Mn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=ks(e),r=t<0,i=n?e.length:0,o=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=un(t,e+s);break;case"takeRight":e=an(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,u=a-s,c=r?a:s-1,d=this.__iteratees__,l=d.length,f=0,h=un(u,this.__takeCount__);if(!n||!r&&i==u&&h==u)return ri(e,this.__actions__);var p=[];e:for(;u--&&f<h;){for(var g=-1,m=e[c+=t];++g<l;){var v=d[g],_=v.iteratee,y=v.type,b=_(m);if(2==y)m=b;else if(!b){if(1==y)continue e;break e}}p[f++]=m}return p},jn.prototype.at=is,jn.prototype.chain=function(){return ns(this)},jn.prototype.commit=function(){return new Rn(this.value(),this.__chain__)},jn.prototype.next=function(){void 0===this.__values__&&(this.__values__=na(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},jn.prototype.plant=function(e){for(var t,n=this;n instanceof In;){var r=jo(n);r.__index__=0,r.__values__=void 0,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},jn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Mn){var t=e;return this.__actions__.length&&(t=new Mn(this)),(t=t.reverse()).__actions__.push({func:rs,args:[qo],thisArg:void 0}),new Rn(t,this.__chain__)}return this.thru(qo)},jn.prototype.toJSON=jn.prototype.valueOf=jn.prototype.value=function(){return ri(this.__wrapped__,this.__actions__)},jn.prototype.first=jn.prototype.head,Qe&&(jn.prototype[Qe]=function(){return this}),jn}();Ve._=Xt,void 0===(i=function(){return Xt}.call(t,n,t,r))||(r.exports=i)}).call(this)}).call(this,n(17),n(58)(e))},function(e,t,n){"use strict";var r=n(5),i=n(0);i.f.Websocket=class{constructor(e){this._conn=e,this.strip="wrapper";const t=e.service;if(0!==t.indexOf("ws:")&&0!==t.indexOf("wss:")){let n="";"ws"===e.options.protocol&&"https:"!==window.location.protocol?n+="ws":n+="wss",n+="://"+window.location.host,0!==t.indexOf("/")?n+=window.location.pathname+t:n+=t,e.service=n}}_buildStream(){return Object(i.a)("open",{xmlns:i.f.NS.FRAMING,to:this._conn.domain,version:"1.0"})}_checkStreamError(e,t){let n;if(n=e.getElementsByTagNameNS?e.getElementsByTagNameNS(i.f.NS.STREAM,"error"):e.getElementsByTagName("stream:error"),0===n.length)return!1;const r=n[0];let o="",s="";for(let e=0;e<r.childNodes.length;e++){const t=r.childNodes[e];if("urn:ietf:params:xml:ns:xmpp-streams"!==t.getAttribute("xmlns"))break;"text"===t.nodeName?s=t.textContent:o=t.nodeName}let a="WebSocket stream error: ";return a+=o||"unknown",s&&(a+=" - "+s),i.f.error(a),this._conn._changeConnectStatus(t,o),this._conn._doDisconnect(),!0}_reset(){}_connect(){this._closeSocket(),this.socket=new r.b(this._conn.service,"xmpp"),this.socket.onopen=()=>this._onOpen(),this.socket.onerror=e=>this._onError(e),this.socket.onclose=e=>this._onClose(e),this.socket.onmessage=e=>this._onInitialMessage(e)}_connect_cb(e){if(this._checkStreamError(e,i.f.Status.CONNFAIL))return i.f.Status.CONNFAIL}_handleStreamStart(e){let t=!1;const n=e.getAttribute("xmlns");"string"!=typeof n?t="Missing xmlns in <open />":n!==i.f.NS.FRAMING&&(t="Wrong xmlns in <open />: "+n);const r=e.getAttribute("version");return"string"!=typeof r?t="Missing version in <open />":"1.0"!==r&&(t="Wrong version in <open />: "+r),!t||(this._conn._changeConnectStatus(i.f.Status.CONNFAIL,t),this._conn._doDisconnect(),!1)}_onInitialMessage(e){if(0===e.data.indexOf("<open ")||0===e.data.indexOf("<?xml")){const t=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(""===t)return;const n=(new r.a).parseFromString(t,"text/xml").documentElement;this._conn.xmlInput(n),this._conn.rawInput(e.data),this._handleStreamStart(n)&&this._connect_cb(n)}else if(0===e.data.indexOf("<close ")){const t=(new r.a).parseFromString(e.data,"text/xml").documentElement;this._conn.xmlInput(t),this._conn.rawInput(e.data);const n=t.getAttribute("see-other-uri");if(n){const e=this._conn.service;(e.indexOf("wss:")>=0&&n.indexOf("wss:")>=0||e.indexOf("ws:")>=0)&&(this._conn._changeConnectStatus(i.f.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=n,this._connect())}else this._conn._changeConnectStatus(i.f.Status.CONNFAIL,"Received closing stream"),this._conn._doDisconnect()}else{this._replaceMessageHandler();const t=this._streamWrap(e.data),n=(new r.a).parseFromString(t,"text/xml").documentElement;this._conn._connect_cb(n,null,e.data)}}_replaceMessageHandler(){this.socket.onmessage=e=>this._onMessage(e)}_disconnect(e){if(this.socket&&this.socket.readyState!==r.b.CLOSED){e&&this._conn.send(e);const t=Object(i.a)("close",{xmlns:i.f.NS.FRAMING});this._conn.xmlOutput(t.tree());const n=i.f.serialize(t);this._conn.rawOutput(n);try{this.socket.send(n)}catch(e){i.f.warn("Couldn't send <close /> tag.")}}setTimeout(()=>this._conn._doDisconnect,0)}_doDisconnect(){i.f.debug("WebSockets _doDisconnect was called"),this._closeSocket()}_streamWrap(e){return"<wrapper>"+e+"</wrapper>"}_closeSocket(){if(this.socket)try{this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null,this.socket.close()}catch(e){i.f.debug(e.message)}this.socket=null}_emptyQueue(){return!0}_onClose(e){this._conn.connected&&!this._conn.disconnecting?(i.f.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):e&&1006===e.code&&!this._conn.connected&&this.socket?(i.f.error("Websocket closed unexcectedly"),this._conn._changeConnectStatus(i.f.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._conn._doDisconnect()):i.f.debug("Websocket closed")}_no_auth_received(e){i.f.error("Server did not offer a supported authentication mechanism"),this._conn._changeConnectStatus(i.f.Status.CONNFAIL,i.f.ErrorCondition.NO_AUTH_MECH),e&&e.call(this._conn),this._conn._doDisconnect()}_onDisconnectTimeout(){}_abortAllRequests(){}_onError(e){i.f.error("Websocket error "+e),this._conn._changeConnectStatus(i.f.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._disconnect()}_onIdle(){const e=this._conn._data;if(e.length>0&&!this._conn.paused){for(let t=0;t<e.length;t++)if(null!==e[t]){let n;n="restart"===e[t]?this._buildStream().tree():e[t];const r=i.f.serialize(n);this._conn.xmlOutput(n),this._conn.rawOutput(r),this.socket.send(r)}this._conn._data=[]}}_onMessage(e){let t;const n='<close xmlns="urn:ietf:params:xml:ns:xmpp-framing" />';if(e.data===n)return this._conn.rawInput(n),this._conn.xmlInput(e),void(this._conn.disconnecting||this._conn._doDisconnect());if(0===e.data.search("<open ")){if(t=(new r.a).parseFromString(e.data,"text/xml").documentElement,!this._handleStreamStart(t))return}else{const n=this._streamWrap(e.data);t=(new r.a).parseFromString(n,"text/xml").documentElement}return this._checkStreamError(t,i.f.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===t.firstChild.nodeName&&"unavailable"===t.firstChild.getAttribute("type")?(this._conn.xmlInput(t),void this._conn.rawInput(i.f.serialize(t))):void this._conn._dataRecv(t,e.data)}_onOpen(){i.f.debug("Websocket open");const e=this._buildStream();this._conn.xmlOutput(e.tree());const t=i.f.serialize(e);this._conn.rawOutput(t),this.socket.send(t)}_reqToData(e){return e}_send(){this._conn.flush()}_sendRestart(){clearTimeout(this._conn._idleTimeout),this._conn._onIdle.bind(this._conn)()}}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){var r=n(161);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},function(e,t,n){var r=n(13),i=Object.create,o=function(){function e(){}return function(t){if(!r(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=o},function(e,t,n){var r=n(62),i=n(64);function o(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}o.prototype=r(i.prototype),o.prototype.constructor=o,e.exports=o},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e){return e.placeholder}},function(e,t,n){var r=n(19)(n(6),"Map");e.exports=r},function(e,t,n){var r=n(228),i=n(235),o=n(237),s=n(238),a=n(239);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,e.exports=u},function(e,t,n){var r=n(47),i=n(30);e.exports=function(e,t){for(var n=0,o=(t=r(t,e)).length;null!=e&&n<o;)e=e[i(t[n++])];return n&&n==o?e:void 0}},function(e,t,n){var r=n(9),i=n(38),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||(s.test(e)||!o.test(e)||null!=t&&e in Object(t))}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(32),i=n(7).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(288),i=n(72);e.exports=function(e){return r(i(e))}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(132)("keys"),i=n(133);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports=!0},function(e,t,n){e.exports={default:n(296),__esModule:!0}},function(e,t,n){var r=n(31).f,i=n(50),o=n(10)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){"use strict";var r=n(49);function i(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new i(e)}},function(e,t,n){var r=n(197),i=n(26);e.exports=function(e){return null==e?[]:r(e,i(e))}},function(e,t,n){var r=n(98),i=n(198),o=n(65),s=n(42),a=r((function(e,t){var n=s(t,o(a));return i(e,32,void 0,t,n)}));a.placeholder={},e.exports=a},function(e,t,n){var r;!function(){"use strict";var i={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function o(e){return a(c(e),arguments)}function s(e,t){return o.apply(null,[e].concat(t||[]))}function a(e,t){var n,r,s,a,u,c,d,l,f,h=1,p=e.length,g="";for(r=0;r<p;r++)if("string"==typeof e[r])g+=e[r];else if("object"==typeof e[r]){if((a=e[r]).keys)for(n=t[h],s=0;s<a.keys.length;s++){if(null==n)throw new Error(o('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[s],a.keys[s-1]));n=n[a.keys[s]]}else n=a.param_no?t[a.param_no]:t[h++];if(i.not_type.test(a.type)&&i.not_primitive.test(a.type)&&n instanceof Function&&(n=n()),i.numeric_arg.test(a.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(o("[sprintf] expecting number but found %T",n));switch(i.number.test(a.type)&&(l=n>=0),a.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,a.width?parseInt(a.width):0);break;case"e":n=a.precision?parseFloat(n).toExponential(a.precision):parseFloat(n).toExponential();break;case"f":n=a.precision?parseFloat(n).toFixed(a.precision):parseFloat(n);break;case"g":n=a.precision?String(Number(n.toPrecision(a.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=a.precision?n.substring(0,a.precision):n;break;case"t":n=String(!!n),n=a.precision?n.substring(0,a.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=a.precision?n.substring(0,a.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=a.precision?n.substring(0,a.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}i.json.test(a.type)?g+=n:(!i.number.test(a.type)||l&&!a.sign?f="":(f=l?"+":"-",n=n.toString().replace(i.sign,"")),c=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",d=a.width-(f+n).length,u=a.width&&d>0?c.repeat(d):"",g+=a.align?f+n+u:"0"===c?f+u+n:u+f+n)}return g}var u=Object.create(null);function c(e){if(u[e])return u[e];for(var t,n=e,r=[],o=0;n;){if(null!==(t=i.text.exec(n)))r.push(t[0]);else if(null!==(t=i.modulo.exec(n)))r.push("%");else{if(null===(t=i.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){o|=1;var s=[],a=t[2],c=[];if(null===(c=i.key.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(s.push(c[1]);""!==(a=a.substring(c[0].length));)if(null!==(c=i.key_access.exec(a)))s.push(c[1]);else{if(null===(c=i.index_access.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");s.push(c[1])}t[2]=s}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return u[e]=r}t.sprintf=o,t.vsprintf=s,"undefined"!=typeof window&&(window.sprintf=o,window.vsprintf=s,void 0===(r=function(){return{sprintf:o,vsprintf:s}}.call(t,n,t,e))||(e.exports=r))}()},function(e,t,n){function r(e){this.options=e||{locator:{}}}function i(){this.cdata=!1}function o(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function s(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function a(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function u(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}r.prototype.parseFromString=function(e,t){var n=this.options,r=new l,o=n.domBuilder||new i,a=n.errorHandler,u=n.locator,d=n.xmlns||{},f=/\/x?html?$/.test(t),h=f?c.entityMap:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return u&&o.setDocumentLocator(u),r.errorHandler=function(e,t,n){if(!e){if(t instanceof i)return t;e=t}var r={},o=e instanceof Function;function a(t){var i=e[t];!i&&o&&(i=2==e.length?function(n){e(t,n)}:e),r[t]=i&&function(e){i("[xmldom "+t+"]\t"+e+s(n))}||function(){}}return n=n||{},a("warning"),a("error"),a("fatalError"),r}(a,o,u),r.domBuilder=n.domBuilder||o,f&&(d[""]="http://www.w3.org/1999/xhtml"),d.xml=d.xml||"http://www.w3.org/XML/1998/namespace",e&&"string"==typeof e?r.parse(e,d,h):r.errorHandler.error("invalid doc source"),o.doc},i.prototype={startDocument:function(){this.doc=(new h).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,r){var i=this.doc,s=i.createElementNS(e,n||t),a=r.length;u(this,s),this.currentElement=s,this.locator&&o(this.locator,s);for(var c=0;c<a;c++){e=r.getURI(c);var d=r.getValue(c),l=(n=r.getQName(c),i.createAttributeNS(e,n));this.locator&&o(r.getLocator(c),l),l.value=l.nodeValue=d,s.setAttributeNode(l)}},endElement:function(e,t,n){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&o(this.locator,n),u(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=a.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(e);else r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&o(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=a.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&o(this.locator,r),u(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(e,t,n);this.locator&&o(this.locator,i),u(this,i)}},warning:function(e){console.warn("[xmldom warning]\t"+e,s(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,s(this.locator))},fatalError:function(e){throw new f(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){i.prototype[e]=function(){return null}}));var c=n(156),d=n(157),l=d.XMLReader,f=d.ParseError,h=t.DOMImplementation=n(84).DOMImplementation;t.XMLSerializer=n(84).XMLSerializer,t.DOMParser=r,t.__DOMHandler=i},function(e,t){function n(e,t){for(var n in e)t[n]=e[n]}function r(e,t){var r=e.prototype;if(!(r instanceof t)){function i(){}i.prototype=t.prototype,n(r,i=new i),e.prototype=r=i}r.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),r.constructor=e)}var i={},o=i.ELEMENT_NODE=1,s=i.ATTRIBUTE_NODE=2,a=i.TEXT_NODE=3,u=i.CDATA_SECTION_NODE=4,c=i.ENTITY_REFERENCE_NODE=5,d=i.ENTITY_NODE=6,l=i.PROCESSING_INSTRUCTION_NODE=7,f=i.COMMENT_NODE=8,h=i.DOCUMENT_NODE=9,p=i.DOCUMENT_TYPE_NODE=10,g=i.DOCUMENT_FRAGMENT_NODE=11,m=i.NOTATION_NODE=12,v={},_={},y=(v.INDEX_SIZE_ERR=(_[1]="Index size error",1),v.DOMSTRING_SIZE_ERR=(_[2]="DOMString size error",2),v.HIERARCHY_REQUEST_ERR=(_[3]="Hierarchy request error",3)),b=(v.WRONG_DOCUMENT_ERR=(_[4]="Wrong document",4),v.INVALID_CHARACTER_ERR=(_[5]="Invalid character",5),v.NO_DATA_ALLOWED_ERR=(_[6]="No data allowed",6),v.NO_MODIFICATION_ALLOWED_ERR=(_[7]="No modification allowed",7),v.NOT_FOUND_ERR=(_[8]="Not found",8)),w=(v.NOT_SUPPORTED_ERR=(_[9]="Not supported",9),v.INUSE_ATTRIBUTE_ERR=(_[10]="Attribute in use",10));v.INVALID_STATE_ERR=(_[11]="Invalid state",11),v.SYNTAX_ERR=(_[12]="Syntax error",12),v.INVALID_MODIFICATION_ERR=(_[13]="Invalid modification",13),v.NAMESPACE_ERR=(_[14]="Invalid namespace",14),v.INVALID_ACCESS_ERR=(_[15]="Invalid access",15);function S(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,_[e]),this.message=_[e],Error.captureStackTrace&&Error.captureStackTrace(this,S);return n.code=e,t&&(this.message=this.message+": "+t),n}function x(){}function E(e,t){this._node=e,this._refresh=t,A(this)}function A(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var r=e._refresh(e._node);te(e,"length",r.length),n(r,e),e._inc=t}}function N(){}function T(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function O(e,t,n,r){if(r?t[T(t,r)]=n:t[t.length++]=n,e){n.ownerElement=e;var i=e.ownerDocument;i&&(r&&D(i,e,r),function(e,t,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(t._nsMap[n.prefix?n.localName:""]=n.value)}(i,e,n))}}function j(e,t,n){var r=T(t,n);if(!(r>=0))throw S(b,new Error(e.tagName+"@"+n));for(var i=t.length-1;r<i;)t[r]=t[++r];if(t.length=i,e){var o=e.ownerDocument;o&&(D(o,e,n),n.ownerElement=null)}}function C(e){if(this._features={},e)for(var t in e)this._features=e[t]}function I(){}function R(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function M(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(M(e,t))return!0}while(e=e.nextSibling)}function k(){}function D(e,t,n,r){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete t._nsMap[n.prefix?n.localName:""]}function P(e,t,n){if(e&&e._inc){e._inc++;var r=t.childNodes;if(n)r[r.length++]=n;else{for(var i=t.firstChild,o=0;i;)r[o++]=i,i=i.nextSibling;r.length=o}}}function F(e,t){var n=t.previousSibling,r=t.nextSibling;return n?n.nextSibling=r:e.firstChild=r,r?r.previousSibling=n:e.lastChild=n,P(e.ownerDocument,e),t}function L(e,t,n){var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===g){var i=t.firstChild;if(null==i)return t;var o=t.lastChild}else i=o=t;var s=n?n.previousSibling:e.lastChild;i.previousSibling=s,o.nextSibling=n,s?s.nextSibling=i:e.firstChild=i,null==n?e.lastChild=o:n.previousSibling=o;do{i.parentNode=e}while(i!==o&&(i=i.nextSibling));return P(e.ownerDocument||e,e),t.nodeType==g&&(t.firstChild=t.lastChild=null),t}function U(){this._nsMap={}}function z(){}function B(){}function $(){}function H(){}function q(){}function J(){}function W(){}function V(){}function G(){}function Y(){}function X(){}function Q(){}function K(e,t){var n=[],r=9==this.nodeType&&this.documentElement||this,i=r.prefix,o=r.namespaceURI;if(o&&null==i&&null==(i=r.lookupPrefix(o)))var s=[{namespace:o,prefix:null}];return ee(this,n,e,t,s),n.join("")}function Z(e,t,n){var r=e.prefix||"",i=e.namespaceURI;if(!r&&!i)return!1;if("xml"===r&&"http://www.w3.org/XML/1998/namespace"===i||"http://www.w3.org/2000/xmlns/"==i)return!1;for(var o=n.length;o--;){var s=n[o];if(s.prefix==r)return s.namespace!=i}return!0}function ee(e,t,n,r,i){if(r){if(!(e=r(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case o:i||(i=[]);i.length;var d=e.attributes,m=d.length,v=e.firstChild,_=e.tagName;n="http://www.w3.org/1999/xhtml"===e.namespaceURI||n,t.push("<",_);for(var y=0;y<m;y++){"xmlns"==(b=d.item(y)).prefix?i.push({prefix:b.localName,namespace:b.value}):"xmlns"==b.nodeName&&i.push({prefix:"",namespace:b.value})}for(y=0;y<m;y++){var b;if(Z(b=d.item(y),0,i)){var w=b.prefix||"",S=b.namespaceURI,x=w?" xmlns:"+w:" xmlns";t.push(x,'="',S,'"'),i.push({prefix:w,namespace:S})}ee(b,t,n,r,i)}if(Z(e,0,i)){w=e.prefix||"",S=e.namespaceURI,x=w?" xmlns:"+w:" xmlns";t.push(x,'="',S,'"'),i.push({prefix:w,namespace:S})}if(v||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(_)){if(t.push(">"),n&&/^script$/i.test(_))for(;v;)v.data?t.push(v.data):ee(v,t,n,r,i),v=v.nextSibling;else for(;v;)ee(v,t,n,r,i),v=v.nextSibling;t.push("</",_,">")}else t.push("/>");return;case h:case g:for(v=e.firstChild;v;)ee(v,t,n,r,i),v=v.nextSibling;return;case s:return t.push(" ",e.name,'="',e.value.replace(/[&"]/g,R),'"');case a:return t.push(e.data.replace(/[<&]/g,R).replace(/]]>/g,"]]&gt;"));case u:return t.push("<![CDATA[",e.data,"]]>");case f:return t.push("\x3c!--",e.data,"--\x3e");case p:var E=e.publicId,A=e.systemId;if(t.push("<!DOCTYPE ",e.name),E)t.push(" PUBLIC ",E),A&&"."!=A&&t.push(" ",A),t.push(">");else if(A&&"."!=A)t.push(" SYSTEM ",A,">");else{var N=e.internalSubset;N&&t.push(" [",N,"]"),t.push(">")}return;case l:return t.push("<?",e.target," ",e.data,"?>");case c:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function te(e,t,n){e[t]=n}S.prototype=Error.prototype,n(v,S),x.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],r=0;r<this.length;r++)ee(this[r],n,e,t);return n.join("")}},E.prototype.item=function(e){return A(this),this[e]},r(E,x),N.prototype={length:0,item:x.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new S(w);var n=this.getNamedItem(e.nodeName);return O(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new S(w);return t=this.getNamedItemNS(e.namespaceURI,e.localName),O(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return j(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return j(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var r=this[n];if(r.localName==t&&r.namespaceURI==e)return r}return null}},C.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var r=new k;if(r.implementation=this,r.childNodes=new x,r.doctype=n,n&&r.appendChild(n),t){var i=r.createElementNS(e,t);r.appendChild(i)}return r},createDocumentType:function(e,t,n){var r=new J;return r.name=e,r.nodeName=e,r.publicId=t,r.systemId=n,r}},I.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return L(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return F(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,n,r){var i=new n.constructor;for(var a in n){var u=n[a];"object"!=typeof u&&u!=i[a]&&(i[a]=u)}n.childNodes&&(i.childNodes=new x);switch(i.ownerDocument=t,i.nodeType){case o:var c=n.attributes,d=i.attributes=new N,l=c.length;d._ownerElement=i;for(var f=0;f<l;f++)i.setAttributeNode(e(t,c.item(f),!0));break;case s:r=!0}if(r)for(var h=n.firstChild;h;)i.appendChild(e(t,h,r)),h=h.nextSibling;return i}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==a&&e.nodeType==a?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var r in n)if(n[r]==e)return r;t=t.nodeType==s?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==s?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},n(i,I),n(i,I.prototype),k.prototype={nodeName:"#document",nodeType:h,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==g){for(var n=e.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,t),n=r}return e}return null==this.documentElement&&e.nodeType==o&&(this.documentElement=e),L(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),F(this,e)},importNode:function(e,t){return function e(t,n,r){var i;switch(n.nodeType){case o:(i=n.cloneNode(!1)).ownerDocument=t;case g:break;case s:r=!0}i||(i=n.cloneNode(!1));if(i.ownerDocument=t,i.parentNode=null,r)for(var a=n.firstChild;a;)i.appendChild(e(t,a,r)),a=a.nextSibling;return i}(this,e,t)},getElementById:function(e){var t=null;return M(this.documentElement,(function(n){if(n.nodeType==o&&n.getAttribute("id")==e)return t=n,!0})),t},getElementsByClassName:function(e){var t=new RegExp("(^|\\s)"+e+"(\\s|$)");return new E(this,(function(e){var n=[];return M(e.documentElement,(function(r){r!==e&&r.nodeType==o&&t.test(r.getAttribute("class"))&&n.push(r)})),n}))},createElement:function(e){var t=new U;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new x,(t.attributes=new N)._ownerElement=t,t},createDocumentFragment:function(){var e=new Y;return e.ownerDocument=this,e.childNodes=new x,e},createTextNode:function(e){var t=new $;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new H;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new q;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new X;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new z;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new G;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new U,r=t.split(":"),i=n.attributes=new N;return n.childNodes=new x,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,i._ownerElement=n,n},createAttributeNS:function(e,t){var n=new z,r=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,n}},r(k,I),U.prototype={nodeType:o,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===g?this.insertBefore(e,null):function(e,t){var n=t.parentNode;if(n){var r=e.lastChild;n.removeChild(t);r=e.lastChild}return r=e.lastChild,t.parentNode=e,t.previousSibling=r,t.nextSibling=null,r?r.nextSibling=t:e.firstChild=t,e.lastChild=t,P(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=""+n,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new E(this,(function(t){var n=[];return M(t,(function(r){r===t||r.nodeType!=o||"*"!==e&&r.tagName!=e||n.push(r)})),n}))},getElementsByTagNameNS:function(e,t){return new E(this,(function(n){var r=[];return M(n,(function(i){i===n||i.nodeType!==o||"*"!==e&&i.namespaceURI!==e||"*"!==t&&i.localName!=t||r.push(i)})),r}))}},k.prototype.getElementsByTagName=U.prototype.getElementsByTagName,k.prototype.getElementsByTagNameNS=U.prototype.getElementsByTagNameNS,r(U,I),z.prototype.nodeType=s,r(z,I),B.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(_[y])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},r(B,I),$.prototype={nodeName:"#text",nodeType:a,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},r($,B),H.prototype={nodeName:"#comment",nodeType:f},r(H,B),q.prototype={nodeName:"#cdata-section",nodeType:u},r(q,B),J.prototype.nodeType=p,r(J,I),W.prototype.nodeType=m,r(W,I),V.prototype.nodeType=d,r(V,I),G.prototype.nodeType=c,r(G,I),Y.prototype.nodeName="#document-fragment",Y.prototype.nodeType=g,r(Y,I),X.prototype.nodeType=l,r(X,I),Q.prototype.serializeToString=function(e,t,n){return K.call(e,t,n)},I.prototype.toString=K;try{if(Object.defineProperty){Object.defineProperty(E.prototype,"length",{get:function(){return A(this),this.$$length}}),Object.defineProperty(I.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case o:case g:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case o:case g:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),te=function(e,t,n){e["$$"+t]=n}}}catch(e){}t.Node=I,t.DOMException=S,t.DOMImplementation=C,t.XMLSerializer=Q},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(17))},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},function(e,t,n){var r=n(172),i=n(88),o=n(9),s=n(89),a=n(28),u=n(90),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),d=!n&&i(e),l=!n&&!d&&s(e),f=!n&&!d&&!l&&u(e),h=n||d||l||f,p=h?r(e.length,String):[],g=p.length;for(var m in e)!t&&!c.call(e,m)||h&&("length"==m||l&&("offset"==m||"parent"==m)||f&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||a(m,g))||p.push(m);return p}},function(e,t,n){var r=n(173),i=n(15),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return i(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=u},function(e,t,n){(function(e){var r=n(6),i=n(174),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=s&&s.exports===o?r.Buffer:void 0,u=(a?a.isBuffer:void 0)||i;e.exports=u}).call(this,n(58)(e))},function(e,t,n){var r=n(175),i=n(176),o=n(177),s=o&&o.isTypedArray,a=s?i(s):r;e.exports=a},function(e,t,n){var r=n(92),i=n(178),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){var r=n(95),i=n(40),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var s=e[t];o.call(e,t)&&i(s,n)&&(void 0!==n||t in e)||r(e,t,n)}},function(e,t,n){var r=n(96);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t,n){var r=n(19),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,n){var r=n(29),i=n(188),o=n(99);e.exports=function(e,t){return o(i(e,t,r),e+"")}},function(e,t,n){var r=n(189),i=n(100)(r);e.exports=i},function(e,t){var n=Date.now;e.exports=function(e){var t=0,r=0;return function(){var i=n(),o=16-(i-r);if(r=i,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,n){var r=n(87),i=n(192),o=n(22);e.exports=function(e){return o(e)?r(e,!0):i(e)}},function(e,t,n){var r=n(194),i=n(195),o=n(196);e.exports=function(e,t,n){return t==t?o(e,t,n):r(e,i,n)}},function(e,t,n){var r=n(18),i=n(9),o=n(15);e.exports=function(e){return"string"==typeof e||!i(e)&&o(e)&&"[object String]"==r(e)}},function(e,t,n){var r=n(29),i=n(105),o=i?function(e,t){return i.set(e,t),e}:r;e.exports=o},function(e,t,n){var r=n(106),i=r&&new r;e.exports=i},function(e,t,n){var r=n(19)(n(6),"WeakMap");e.exports=r},function(e,t,n){var r=n(108),i=n(109),o=n(201),s=n(41),a=n(110),u=n(65),c=n(212),d=n(42),l=n(6);e.exports=function e(t,n,f,h,p,g,m,v,_,y){var b=128&n,w=1&n,S=2&n,x=24&n,E=512&n,A=S?void 0:s(t);return function N(){for(var T=arguments.length,O=Array(T),j=T;j--;)O[j]=arguments[j];if(x)var C=u(N),I=o(O,C);if(h&&(O=r(O,h,p,x)),g&&(O=i(O,g,m,x)),T-=I,x&&T<y){var R=d(O,C);return a(t,n,e,N.placeholder,f,O,R,v,_,y-T)}var M=w?f:this,k=S?M[t]:t;return T=O.length,v?O=c(O,v):E&&T>1&&O.reverse(),b&&_<T&&(O.length=_),this&&this!==l&&this instanceof N&&(k=A||s(k)),k.apply(M,O)}}},function(e,t){var n=Math.max;e.exports=function(e,t,r,i){for(var o=-1,s=e.length,a=r.length,u=-1,c=t.length,d=n(s-a,0),l=Array(c+d),f=!i;++u<c;)l[u]=t[u];for(;++o<a;)(f||o<s)&&(l[r[o]]=e[o]);for(;d--;)l[u++]=e[o++];return l}},function(e,t){var n=Math.max;e.exports=function(e,t,r,i){for(var o=-1,s=e.length,a=-1,u=r.length,c=-1,d=t.length,l=n(s-u,0),f=Array(l+d),h=!i;++o<l;)f[o]=e[o];for(var p=o;++c<d;)f[p+c]=t[c];for(;++a<u;)(h||o<s)&&(f[p+r[a]]=e[o++]);return f}},function(e,t,n){var r=n(202),i=n(114),o=n(115);e.exports=function(e,t,n,s,a,u,c,d,l,f){var h=8&t;t|=h?32:64,4&(t&=~(h?64:32))||(t&=-4);var p=[e,t,a,h?u:void 0,h?c:void 0,h?void 0:u,h?void 0:c,d,l,f],g=n.apply(void 0,p);return r(e)&&i(g,p),g.placeholder=s,o(g,e,t)}},function(e,t,n){var r=n(105),i=n(203),o=r?function(e){return r.get(e)}:i;e.exports=o},function(e,t,n){var r=n(62),i=n(64);function o(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}o.prototype=r(i.prototype),o.prototype.constructor=o,e.exports=o},function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},function(e,t,n){var r=n(104),i=n(100)(r);e.exports=i},function(e,t,n){var r=n(208),i=n(209),o=n(99),s=n(210);e.exports=function(e,t,n){var a=t+"";return o(e,i(a,s(r(a),n)))}},function(e,t,n){var r=n(43),i=n(223),o=n(224),s=n(225),a=n(226),u=n(227);function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=i,c.prototype.delete=o,c.prototype.get=s,c.prototype.has=a,c.prototype.set=u,e.exports=c},function(e,t,n){var r=n(240),i=n(15);e.exports=function e(t,n,o,s,a){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!=t&&n!=n:r(t,n,o,s,e,a))}},function(e,t,n){var r=n(241),i=n(244),o=n(245);e.exports=function(e,t,n,s,a,u){var c=1&n,d=e.length,l=t.length;if(d!=l&&!(c&&l>d))return!1;var f=u.get(e),h=u.get(t);if(f&&h)return f==t&&h==e;var p=-1,g=!0,m=2&n?new r:void 0;for(u.set(e,t),u.set(t,e);++p<d;){var v=e[p],_=t[p];if(s)var y=c?s(_,v,p,t,e,u):s(v,_,p,e,t,u);if(void 0!==y){if(y)continue;g=!1;break}if(m){if(!i(t,(function(e,t){if(!o(m,t)&&(v===e||a(v,e,n,s,u)))return m.push(t)}))){g=!1;break}}else if(v!==_&&!a(v,_,n,s,u)){g=!1;break}}return u.delete(e),u.delete(t),g}},function(e,t,n){var r=n(120),i=n(9);e.exports=function(e,t,n){var o=t(e);return i(e)?o:r(o,n(e))}},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},function(e,t,n){var r=n(252),i=n(122),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),r(s(e),(function(t){return o.call(e,t)})))}:i;e.exports=a},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(253),i=n(66),o=n(254),s=n(255),a=n(106),u=n(18),c=n(97),d=c(r),l=c(i),f=c(o),h=c(s),p=c(a),g=u;(r&&"[object DataView]"!=g(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=g(new i)||o&&"[object Promise]"!=g(o.resolve())||s&&"[object Set]"!=g(new s)||a&&"[object WeakMap]"!=g(new a))&&(g=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case d:return"[object DataView]";case l:return"[object Map]";case f:return"[object Promise]";case h:return"[object Set]";case p:return"[object WeakMap]"}return t}),e.exports=g},function(e,t,n){var r=n(13);e.exports=function(e){return e==e&&!r(e)}},function(e,t){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(278)),i=c(n(284)),o=c(n(292)),s=c(n(295)),a=c(n(77));t.default=function(e,t){var n=(0,u.getStorage)(),c=!(!n||!n[t]),d=c?n[t]:{clear:function(){},get:function(){},remove:function(){},set:function(){}},l=d.clear.bind(d),f=d.get.bind(d),h=d.remove.bind(d),p=d.set.bind(d);return{_driver:e,_support:c,_initStorage:function(){return a.default.resolve()},clear:function(e){var t=this;return(0,s.default)(o.default.mark((function n(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l(),e&&e();case 2:case"end":return t.stop()}}),n,t)})))()},iterate:function(e,t){var n=this;return(0,s.default)(o.default.mark((function r(){var s;return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,u.usePromise)(f,null);case 2:s=n.sent,(0,i.default)(s).forEach((function(t,n){return e(s[t],t,n)})),t&&t();case 6:case"end":return n.stop()}}),r,n)})))()},getItem:function(e,t){var n=this;return(0,s.default)(o.default.mark((function r(){var i;return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,u.usePromise)(f,e);case 3:return i=n.sent,i=void 0===(i="string"==typeof e?i[e]:i)?null:i,t&&t(null,i),n.abrupt("return",i);case 10:throw n.prev=10,n.t0=n.catch(0),t&&t(n.t0),n.t0;case 14:case"end":return n.stop()}}),r,n,[[0,10]])})))()},key:function(e,t){var n=this;return(0,s.default)(o.default.mark((function r(){var s,a;return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,u.usePromise)(f,null);case 2:return s=n.sent,a=(0,i.default)(s)[e],t&&t(a),n.abrupt("return",a);case 6:case"end":return n.stop()}}),r,n)})))()},keys:function(e){var t=this;return(0,s.default)(o.default.mark((function n(){var r,s;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,u.usePromise)(f,null);case 2:return r=t.sent,s=(0,i.default)(r),e&&e(s),t.abrupt("return",s);case 6:case"end":return t.stop()}}),n,t)})))()},length:function(e){var t=this;return(0,s.default)(o.default.mark((function n(){var r,s;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,u.usePromise)(f,null);case 2:return r=t.sent,s=(0,i.default)(r).length,e&&e(s),t.abrupt("return",s);case 6:case"end":return t.stop()}}),n,t)})))()},removeItem:function(e,t){var n=this;return(0,s.default)(o.default.mark((function r(){return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,u.usePromise)(h,e);case 2:t&&t();case 3:case"end":return n.stop()}}),r,n)})))()},setItem:function(e,t,n){var i=this;return(0,s.default)(o.default.mark((function s(){return o.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,u.usePromise)(p,(0,r.default)({},e,t));case 2:n&&n();case 3:case"end":return i.stop()}}),s,i)})))()}}};var u=n(323);function c(e){return e&&e.__esModule?e:{default:e}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(72);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(287),i=n(134);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(74),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(11),i=n(7),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(76)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){"use strict";var r=n(76),i=n(23),o=n(300),s=n(24),a=n(33),u=n(301),c=n(78),d=n(304),l=n(10)("iterator"),f=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,p,g,m,v){u(n,t,p);var _,y,b,w=function(e){if(!f&&e in A)return A[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},S=t+" Iterator",x="values"==g,E=!1,A=e.prototype,N=A[l]||A["@@iterator"]||g&&A[g],T=N||w(g),O=g?x?w("entries"):T:void 0,j="Array"==t&&A.entries||N;if(j&&(b=d(j.call(new e)))!==Object.prototype&&b.next&&(c(b,S,!0),r||"function"==typeof b[l]||s(b,l,h)),x&&N&&"values"!==N.name&&(E=!0,T=function(){return N.call(this)}),r&&!v||!f&&!E&&A[l]||s(A,l,T),a[t]=T,a[S]=h,g)if(_={values:x?T:w("values"),keys:m?T:w("keys"),entries:O},v)for(y in _)y in A||o(A,y,_[y]);else i(i.P+i.F*(f||E),t,_);return _}},function(e,t,n){var r=n(7).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(51),i=n(10)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:o?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){var r=n(20),i=n(49),o=n(10)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||null==(n=r(s)[o])?t:i(n)}},function(e,t,n){var r,i,o,s=n(48),a=n(315),u=n(136),c=n(71),d=n(7),l=d.process,f=d.setImmediate,h=d.clearImmediate,p=d.MessageChannel,g=d.Dispatch,m=0,v={},_=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},y=function(e){_.call(e.data)};f&&h||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++m]=function(){a("function"==typeof e?e:Function(e),t)},r(m),m},h=function(e){delete v[e]},"process"==n(51)(l)?r=function(e){l.nextTick(s(_,e,1))}:g&&g.now?r=function(e){g.now(s(_,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=y,r=s(o.postMessage,o,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(r=function(e){d.postMessage(e+"","*")},d.addEventListener("message",y,!1)):r="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),_.call(e)}}:function(e){setTimeout(s(_,e,1),0)}),e.exports={set:f,clear:h}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(20),i=n(32),o=n(79);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(5),i=n(0);i.f.Request=class{constructor(e,t,n,r){this.id=++i.f._requestId,this.xmlData=e,this.data=i.f.serialize(e),this.origFunc=t,this.func=t,this.rid=n,this.date=NaN,this.sends=r||0,this.abort=!1,this.dead=null,this.age=function(){if(!this.date)return 0;return(new Date-this.date)/1e3},this.timeDead=function(){if(!this.dead)return 0;return(new Date-this.dead)/1e3},this.xhr=this._newXHR()}getResponse(){let e=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if(e=this.xhr.responseXML.documentElement,"parsererror"===e.tagName)throw i.f.error("invalid response received"),i.f.error("responseText: "+this.xhr.responseText),i.f.error("responseXML: "+i.f.serialize(this.xhr.responseXML)),new Error("parsererror")}else if(this.xhr.responseText){if(i.f.debug("Got responseText but no responseXML; attempting to parse it with DOMParser..."),e=(new r.a).parseFromString(this.xhr.responseText,"application/xml").documentElement,!e)throw new Error("Parsing produced null node");if(e.querySelector("parsererror")){i.f.error("invalid response received: "+e.querySelector("parsererror").textContent),i.f.error("responseText: "+this.xhr.responseText);const t=new Error;throw t.name=i.f.ErrorCondition.BAD_FORMAT,t}}return e}_newXHR(){let e=null;return window.XMLHttpRequest?(e=new XMLHttpRequest,e.overrideMimeType&&e.overrideMimeType("text/xml; charset=utf-8")):window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP")),e.onreadystatechange=this.func.bind(null,this),e}},i.f.Bosh=class e{constructor(e){this._conn=e,this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.hold=1,this.wait=60,this.window=5,this.errors=0,this.inactivity=null,this.lastResponseHeaders=null,this._requests=[]}_buildBody(){const e=Object(i.a)("body",{rid:this.rid++,xmlns:i.f.NS.HTTPBIND});return null!==this.sid&&e.attrs({sid:this.sid}),this._conn.options.keepalive&&this._conn._sessionCachingSupported()&&this._cacheSession(),e}_reset(){this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.errors=0,this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)}_connect(e,t,n){this.wait=e||this.wait,this.hold=t||this.hold,this.errors=0;const r=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":i.f.NS.BOSH});n&&r.attrs({route:n});const o=this._conn._connect_cb;this._requests.push(new i.f.Request(r.tree(),this._onRequestStateChange.bind(this,o.bind(this._conn)),r.tree().getAttribute("rid"))),this._throttledRequestHandler()}_attach(e,t,n,r,o,s,a){this._conn.jid=e,this.sid=t,this.rid=n,this._conn.connect_callback=r,this._conn.domain=i.f.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=o||this.wait,this.hold=s||this.hold,this.window=a||this.window,this._conn._changeConnectStatus(i.f.Status.ATTACHED,null)}_restore(e,t,n,r,o){const s=JSON.parse(window.sessionStorage.getItem("strophe-bosh-session"));if(!(null!=s&&s.rid&&s.sid&&s.jid&&(null==e||i.f.getBareJidFromJid(s.jid)===i.f.getBareJidFromJid(e)||null===i.f.getNodeFromJid(e)&&i.f.getDomainFromJid(s.jid)===e))){const e=new Error("_restore: no restoreable session.");throw e.name="StropheSessionError",e}this._conn.restored=!0,this._attach(s.jid,s.sid,s.rid,t,n,r,o)}_cacheSession(){this._conn.authenticated?this._conn.jid&&this.rid&&this.sid&&window.sessionStorage.setItem("strophe-bosh-session",JSON.stringify({jid:this._conn.jid,rid:this.rid,sid:this.sid})):window.sessionStorage.removeItem("strophe-bosh-session")}_connect_cb(e){const t=e.getAttribute("type");if(null!==t&&"terminate"===t){let t=e.getAttribute("condition");i.f.error("BOSH-Connection failed: "+t);const n=e.getElementsByTagName("conflict");return null!==t?("remote-stream-error"===t&&n.length>0&&(t="conflict"),this._conn._changeConnectStatus(i.f.Status.CONNFAIL,t)):this._conn._changeConnectStatus(i.f.Status.CONNFAIL,"unknown"),this._conn._doDisconnect(t),i.f.Status.CONNFAIL}this.sid||(this.sid=e.getAttribute("sid"));const n=e.getAttribute("requests");n&&(this.window=parseInt(n,10));const r=e.getAttribute("hold");r&&(this.hold=parseInt(r,10));const o=e.getAttribute("wait");o&&(this.wait=parseInt(o,10));const s=e.getAttribute("inactivity");s&&(this.inactivity=parseInt(s,10))}_disconnect(e){this._sendTerminate(e)}_doDisconnect(){this.sid=null,this.rid=Math.floor(4294967295*Math.random()),this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)}_emptyQueue(){return 0===this._requests.length}_callProtocolErrorHandlers(t){const n=e._getRequestStatus(t),r=this._conn.protocolErrorHandlers.HTTP[n];r&&r.call(this,n)}_hitError(e){this.errors++,i.f.warn("request errored, status: "+e+", number of errors: "+this.errors),this.errors>4&&this._conn._onDisconnectTimeout()}_no_auth_received(e){i.f.warn("Server did not yet offer a supported authentication mechanism. Sending a blank poll request."),e=e?e.bind(this._conn):this._conn._connect_cb.bind(this._conn);const t=this._buildBody();this._requests.push(new i.f.Request(t.tree(),this._onRequestStateChange.bind(this,e),t.tree().getAttribute("rid"))),this._throttledRequestHandler()}_onDisconnectTimeout(){this._abortAllRequests()}_abortAllRequests(){for(;this._requests.length>0;){const e=this._requests.pop();e.abort=!0,e.xhr.abort(),e.xhr.onreadystatechange=function(){}}}_onIdle(){const e=this._conn._data;if(this._conn.authenticated&&0===this._requests.length&&0===e.length&&!this._conn.disconnecting&&(i.f.debug("no requests during idle cycle, sending blank request"),e.push(null)),!this._conn.paused){if(this._requests.length<2&&e.length>0){const t=this._buildBody();for(let n=0;n<e.length;n++)null!==e[n]&&("restart"===e[n]?t.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":i.f.NS.BOSH}):t.cnode(e[n]).up());delete this._conn._data,this._conn._data=[],this._requests.push(new i.f.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"))),this._throttledRequestHandler()}if(this._requests.length>0){const e=this._requests[0].age();null!==this._requests[0].dead&&this._requests[0].timeDead()>Math.floor(i.f.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),e>Math.floor(i.f.TIMEOUT*this.wait)&&(i.f.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(i.f.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}}}static _getRequestStatus(e,t){let n;if(4===e.xhr.readyState)try{n=e.xhr.status}catch(e){i.f.error("Caught an error while retrieving a request's status, reqStatus: "+n)}return void 0===n&&(n="number"==typeof t?t:0),n}_onRequestStateChange(t,n){if(i.f.debug("request id "+n.id+"."+n.sends+" state changed to "+n.xhr.readyState),n.abort)return void(n.abort=!1);if(4!==n.xhr.readyState)return;const r=e._getRequestStatus(n);if(this.lastResponseHeaders=n.xhr.getAllResponseHeaders(),this._conn.disconnecting&&r>=400)return this._hitError(r),void this._callProtocolErrorHandlers(n);const o=r>0&&r<500,s=n.sends>this._conn.maxRetries;if((o||s)&&(this._removeRequest(n),i.f.debug("request id "+n.id+" should now be removed")),200===r){const e=this._requests[0]===n;(this._requests[1]===n||e&&this._requests.length>0&&this._requests[0].age()>Math.floor(i.f.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),this._conn.nextValidRid(Number(n.rid)+1),i.f.debug("request id "+n.id+"."+n.sends+" got 200"),t(n),this.errors=0}else 0===r||r>=400&&r<600||r>=12e3?(i.f.error("request id "+n.id+"."+n.sends+" error "+r+" happened"),this._hitError(r),this._callProtocolErrorHandlers(n),r>=400&&r<500&&(this._conn._changeConnectStatus(i.f.Status.DISCONNECTING,null),this._conn._doDisconnect())):i.f.error("request id "+n.id+"."+n.sends+" error "+r+" happened");o||s?s&&!this._conn.connected&&this._conn._changeConnectStatus(i.f.Status.CONNFAIL,"giving-up"):this._throttledRequestHandler()}_processRequest(t){let n=this._requests[t];const r=e._getRequestStatus(n,-1);if(n.sends>this._conn.maxRetries)return void this._conn._onDisconnectTimeout();const o=n.age(),s=!isNaN(o)&&o>Math.floor(i.f.TIMEOUT*this.wait),a=null!==n.dead&&n.timeDead()>Math.floor(i.f.SECONDARY_TIMEOUT*this.wait),u=4===n.xhr.readyState&&(r<1||r>=500);if((s||a||u)&&(a&&i.f.error(`Request ${this._requests[t].id} timed out (secondary), restarting`),n.abort=!0,n.xhr.abort(),n.xhr.onreadystatechange=function(){},this._requests[t]=new i.f.Request(n.xmlData,n.origFunc,n.rid,n.sends),n=this._requests[t]),0===n.xhr.readyState){i.f.debug("request id "+n.id+"."+n.sends+" posting");try{const e=this._conn.options.contentType||"text/xml; charset=utf-8";n.xhr.open("POST",this._conn.service,!this._conn.options.sync),void 0!==n.xhr.setRequestHeader&&n.xhr.setRequestHeader("Content-Type",e),this._conn.options.withCredentials&&(n.xhr.withCredentials=!0)}catch(e){return i.f.error("XHR open failed: "+e.toString()),this._conn.connected||this._conn._changeConnectStatus(i.f.Status.CONNFAIL,"bad-service"),void this._conn.disconnect()}const e=()=>{if(n.date=new Date,this._conn.options.customHeaders){const e=this._conn.options.customHeaders;for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.xhr.setRequestHeader(t,e[t])}n.xhr.send(n.data)};if(n.sends>1){const t=1e3*Math.min(Math.floor(i.f.TIMEOUT*this.wait),Math.pow(n.sends,3));setTimeout((function(){e()}),t)}else e();n.sends++,this._conn.xmlOutput!==i.f.Connection.prototype.xmlOutput&&(n.xmlData.nodeName===this.strip&&n.xmlData.childNodes.length?this._conn.xmlOutput(n.xmlData.childNodes[0]):this._conn.xmlOutput(n.xmlData)),this._conn.rawOutput!==i.f.Connection.prototype.rawOutput&&this._conn.rawOutput(n.data)}else i.f.debug("_processRequest: "+(0===t?"first":"second")+" request has readyState of "+n.xhr.readyState)}_removeRequest(e){i.f.debug("removing request");for(let t=this._requests.length-1;t>=0;t--)e===this._requests[t]&&this._requests.splice(t,1);e.xhr.onreadystatechange=function(){},this._throttledRequestHandler()}_restartRequest(e){const t=this._requests[e];null===t.dead&&(t.dead=new Date),this._processRequest(e)}_reqToData(e){try{return e.getResponse()}catch(e){if("parsererror"!==e.message)throw e;this._conn.disconnect("strophe-parsererror")}}_sendTerminate(e){i.f.debug("_sendTerminate was called");const t=this._buildBody().attrs({type:"terminate"});e&&t.cnode(e.tree());const n=new i.f.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"));this._requests.push(n),this._throttledRequestHandler()}_send(){clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout(()=>this._conn._onIdle(),100)}_sendRestart(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)}_throttledRequestHandler(){this._requests?i.f.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):i.f.debug("_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}},i.f.Bosh.prototype.strip=null},function(e,t,n){"use strict";t.a=function(){return!1}},function(e,t,n){"use strict";(function(e){var r=n(3),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i?r.a.Buffer:void 0,a=s?s.allocUnsafe:void 0;t.a=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(this,n(56)(e))},function(e,t,n){e.exports=function(){"use strict";return function(e,t,n){var r=t.prototype,i=r.format;n.en.ordinal=function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"},r.format=function(e){var t=this,n=this.$locale(),r=this.$utils(),o=(e||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|gggg|Do|X|x|k{1,2}|S/g,(function(e){switch(e){case"Q":return Math.ceil((t.$M+1)/3);case"Do":return n.ordinal(t.$D);case"gggg":return t.weekYear();case"wo":return n.ordinal(t.week(),"W");case"w":case"ww":return r.s(t.week(),"w"===e?1:2,"0");case"k":case"kk":return r.s(String(0===t.$H?24:t.$H),"k"===e?1:2,"0");case"X":return Math.floor(t.$d.getTime()/1e3);case"x":return t.$d.getTime();default:return e}}));return i.bind(this)(o)}}}()},function(e,t,n){var r=n(160),i=n(57);e.exports=function(e,t,n){var o=null==e?0:e.length;return o?(t=n||void 0===t?1:i(t),r(e,t<0?0:t,o)):[]}},function(e,t,n){var r=n(18),i=n(15);e.exports=function(e){return!0===e||!1===e||i(e)&&"[object Boolean]"==r(e)}},function(e,t){e.exports=function(e){return null==e}},function(e,t,n){var r=n(61),i=n(215),o=n(269),s=n(271);e.exports=function(e,t){if(null==e)return{};var n=r(s(e),(function(e){return[e]}));return t=i(t),o(e,n,(function(e,n){return t(e,n[0])}))}},function(e,t,n){var r=n(91),i=n(123),o=n(22),s=n(103),a=n(274);e.exports=function(e){if(null==e)return 0;if(o(e))return s(e)?a(e):e.length;var t=i(e);return"[object Map]"==t||"[object Set]"==t?e.size:r(e).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(127),o=(r=i)&&r.__esModule?r:{default:r};t.default=(0,o.default)("webExtensionSyncStorage","sync")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(127),o=(r=i)&&r.__esModule?r:{default:r};t.default=(0,o.default)("webExtensionLocalStorage","local")},function(e,t,n){"use strict";(function(t){!function(t){var n=/^(b|B)$/,r={iec:{bits:["b","Kib","Mib","Gib","Tib","Pib","Eib","Zib","Yib"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},i={iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]};function o(e){var t,o,s,a,u,c,d,l,f,h,p,g,m,v,_,y=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},b=[],w=0,S=void 0,x=void 0;if(isNaN(e))throw new TypeError("Invalid number");return o=!0===y.bits,p=!0===y.unix,t=y.base||2,h=void 0!==y.round?y.round:p?1:2,c=void 0!==y.locale?y.locale:"",d=y.localeOptions||{},g=void 0!==y.separator?y.separator:"",m=void 0!==y.spacer?y.spacer:p?"":" ",_=y.symbols||{},v=2===t&&y.standard||"jedec",f=y.output||"string",a=!0===y.fullform,u=y.fullforms instanceof Array?y.fullforms:[],S=void 0!==y.exponent?y.exponent:-1,s=2<t?1e3:1024,(l=(x=Number(e))<0)&&(x=-x),(-1===S||isNaN(S))&&(S=Math.floor(Math.log(x)/Math.log(s)))<0&&(S=0),8<S&&(S=8),"exponent"===f?S:(0===x?(b[0]=0,b[1]=p?"":r[v][o?"bits":"bytes"][S]):(w=x/(2===t?Math.pow(2,10*S):Math.pow(1e3,S)),o&&s<=(w*=8)&&S<8&&(w/=s,S++),b[0]=Number(w.toFixed(0<S?h:0)),b[0]===s&&S<8&&void 0===y.exponent&&(b[0]=1,S++),b[1]=10===t&&1===S?o?"kb":"kB":r[v][o?"bits":"bytes"][S],p&&(b[1]="jedec"===v?b[1].charAt(0):0<S?b[1].replace(/B$/,""):b[1],n.test(b[1])&&(b[0]=Math.floor(b[0]),b[1]=""))),l&&(b[0]=-b[0]),b[1]=_[b[1]]||b[1],!0===c?b[0]=b[0].toLocaleString():0<c.length?b[0]=b[0].toLocaleString(c,d):0<g.length&&(b[0]=b[0].toString().replace(".",g)),"array"===f?b:(a&&(b[1]=u[S]?u[S]:i[v][S]+(o?"bit":"byte")+(1===b[0]?"":"s")),"object"===f?{value:b[0],symbol:b[1],exponent:S}:b.join(m)))}o.partial=function(e){return function(t){return o(t,e)}},e.exports=o}("undefined"!=typeof window&&window)}).call(this,n(17))},function(e,t){function n(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}"function"!=typeof window.CustomEvent&&(n.prototype=window.Event.prototype,window.CustomEvent=n),String.prototype.includes||(String.prototype.includes=function(e,t){"use strict";return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){const n=this.toString();(void 0===t||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return-1!==r&&r===t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),String.prototype.splitOnce||(String.prototype.splitOnce=function(e){const t=this.split(e);return[t.shift(),t.join(e)]}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")})},function(e,t,n){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},function(e,t){t.entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",times:"×",divide:"÷",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",euro:"€",trade:"™",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"}},function(e,t){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,r=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+n.source+r.source+"*(?::"+n.source+r.source+"*)?$");function o(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,o)}function s(){}function a(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function u(e,t,n,r,i,o){function s(e,t,r){e in n.attributeNames&&o.fatalError("Attribute "+e+" redefined"),n.addValue(e,t,r)}for(var a,u=++t,c=0;;){var d=e.charAt(u);switch(d){case"=":if(1===c)a=e.slice(t,u),c=3;else{if(2!==c)throw new Error("attribute equal must after attrName");c=3}break;case"'":case'"':if(3===c||1===c){if(1===c&&(o.warning('attribute value must after "="'),a=e.slice(t,u)),t=u+1,!((u=e.indexOf(d,t))>0))throw new Error("attribute value no end '"+d+"' match");s(a,l=e.slice(t,u).replace(/&#?\w+;/g,i),t-1),c=5}else{if(4!=c)throw new Error('attribute value must after "="');s(a,l=e.slice(t,u).replace(/&#?\w+;/g,i),t),o.warning('attribute "'+a+'" missed start quot('+d+")!!"),t=u+1,c=5}break;case"/":switch(c){case 0:n.setTagName(e.slice(t,u));case 5:case 6:case 7:c=7,n.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return o.error("unexpected end of input"),0==c&&n.setTagName(e.slice(t,u)),u;case">":switch(c){case 0:n.setTagName(e.slice(t,u));case 5:case 6:case 7:break;case 4:case 1:"/"===(l=e.slice(t,u)).slice(-1)&&(n.closed=!0,l=l.slice(0,-1));case 2:2===c&&(l=a),4==c?(o.warning('attribute "'+l+'" missed quot(")!'),s(a,l.replace(/&#?\w+;/g,i),t)):("http://www.w3.org/1999/xhtml"===r[""]&&l.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+l+'" missed value!! "'+l+'" instead!!'),s(l,l,t));break;case 3:throw new Error("attribute value missed!!")}return u;case"":d=" ";default:if(d<=" ")switch(c){case 0:n.setTagName(e.slice(t,u)),c=6;break;case 1:a=e.slice(t,u),c=2;break;case 4:var l=e.slice(t,u).replace(/&#?\w+;/g,i);o.warning('attribute "'+l+'" missed quot(")!!'),s(a,l,t);case 5:c=6}else switch(c){case 2:n.tagName;"http://www.w3.org/1999/xhtml"===r[""]&&a.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),s(a,a,t),t=u,c=1;break;case 5:o.warning('attribute space is required"'+a+'"!!');case 6:c=1,t=u;break;case 3:c=4,t=u;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function c(e,t,n){for(var r=e.tagName,i=null,o=e.length;o--;){var s=e[o],a=s.qName,u=s.value;if((h=a.indexOf(":"))>0)var c=s.prefix=a.slice(0,h),d=a.slice(h+1),l="xmlns"===c&&d;else d=a,c=null,l="xmlns"===a&&"";s.localName=d,!1!==l&&(null==i&&(i={},f(n,n={})),n[l]=i[l]=u,s.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(l,u))}for(o=e.length;o--;){(c=(s=e[o]).prefix)&&("xml"===c&&(s.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==c&&(s.uri=n[c||""]))}var h;(h=r.indexOf(":"))>0?(c=e.prefix=r.slice(0,h),d=e.localName=r.slice(h+1)):(c=null,d=e.localName=r);var p=e.uri=n[c||""];if(t.startElement(p,d,r,e),!e.closed)return e.currentNSMap=n,e.localNSMap=i,!0;if(t.endElement(p,d,r),i)for(c in i)t.endPrefixMapping(c)}function d(e,t,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var o=e.indexOf("</"+n+">",t),s=e.substring(t+1,o);if(/[&<]/.test(s))return/^script$/i.test(n)?(i.characters(s,0,s.length),o):(s=s.replace(/&#?\w+;/g,r),i.characters(s,0,s.length),o)}return t+1}function l(e,t,n,r){var i=r[n];return null==i&&((i=e.lastIndexOf("</"+n+">"))<t&&(i=e.lastIndexOf("</"+n)),r[n]=i),i<t}function f(e,t){for(var n in e)t[n]=e[n]}function h(e,t,n,r){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(i=e.indexOf("--\x3e",t+4))>t?(n.comment(e,t+4,i-t-4),i+3):(r.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var i=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,i-t-9),n.endCDATA(),i+3}var o=function(e,t){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=t,i.exec(e);for(;n=i.exec(e);)if(r.push(n),n[1])return r}(e,t),s=o.length;if(s>1&&/!doctype/i.test(o[0][0])){var a=o[1][0],u=!1,c=!1;s>3&&(/^public$/i.test(o[2][0])?(u=o[3][0],c=s>4&&o[4][0]):/^system$/i.test(o[2][0])&&(c=o[3][0]));var d=o[s-1];return n.startDTD(a,u,c),n.endDTD(),d.index+d[0].length}}return-1}function p(e,t,n){var r=e.indexOf("?>",t);if(r){var i=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){i[0].length;return n.processingInstruction(i[1],i[2]),r+2}return-1}return-1}function g(){this.attributeNames={}}o.prototype=new Error,o.prototype.name=o.name,s.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),f(t,t={}),function(e,t,n,r,i){function s(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(i.error("entity not found:"+e),e)}function f(t){if(t>x){var n=e.substring(x,t).replace(/&#?\w+;/g,s);b&&m(x),r.characters(n,0,t-x),x=t}}function m(t,n){for(;t>=_&&(n=y.exec(e));)v=n.index,_=v+n[0].length,b.lineNumber++;b.columnNumber=t-v+1}var v=0,_=0,y=/.*(?:\r\n?|\n)|.*$/g,b=r.locator,w=[{currentNSMap:t}],S={},x=0;for(;;){try{var E=e.indexOf("<",x);if(E<0){if(!e.substr(x).match(/^\s*$/)){var A=r.doc,N=A.createTextNode(e.substr(x));A.appendChild(N),r.currentElement=N}return}switch(E>x&&f(E),e.charAt(E+1)){case"/":var T=e.indexOf(">",E+3),O=e.substring(E+2,T),j=w.pop();T<0?(O=e.substring(E+2).replace(/[\s<].*/,""),i.error("end tag name: "+O+" is not complete:"+j.tagName),T=E+1+O.length):O.match(/\s</)&&(O=O.replace(/[\s<].*/,""),i.error("end tag name: "+O+" maybe not complete"),T=E+1+O.length);var C=j.localNSMap,I=j.tagName==O;if(I||j.tagName&&j.tagName.toLowerCase()==O.toLowerCase()){if(r.endElement(j.uri,j.localName,O),C)for(var R in C)r.endPrefixMapping(R);I||i.fatalError("end tag name: "+O+" is not match the current start tagName:"+j.tagName)}else w.push(j);T++;break;case"?":b&&m(E),T=p(e,E,r);break;case"!":b&&m(E),T=h(e,E,r,i);break;default:b&&m(E);var M=new g,k=w[w.length-1].currentNSMap,D=(T=u(e,E,M,k,s,i),M.length);if(!M.closed&&l(e,T,M.tagName,S)&&(M.closed=!0,n.nbsp||i.warning("unclosed xml attribute")),b&&D){for(var P=a(b,{}),F=0;F<D;F++){var L=M[F];m(L.offset),L.locator=a(b,{})}r.locator=P,c(M,r,k)&&w.push(M),r.locator=b}else c(M,r,k)&&w.push(M);"http://www.w3.org/1999/xhtml"!==M.uri||M.closed?T++:T=d(e,T,M.tagName,s,r)}}catch(e){if(e instanceof o)throw e;i.error("element parse error: "+e),T=-1}T>x?x=T:f(Math.max(E,x)+1)}}(e,t,n,r,this.errorHandler),r.endDocument()}},g.prototype={setTagName:function(e){if(!i.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,n){if(!i.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=s,t.ParseError=o},function(e,t,n){"use strict";function r(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e);return t<0?void 0:t}e.exports=function(e){if((e=(e=""+e).replace(/[ \t\n\f\r]/g,"")).length%4==0&&(e=e.replace(/==?$/,"")),e.length%4==1||/[^+/0-9A-Za-z]/.test(e))return null;let t="",n=0,i=0;for(let o=0;o<e.length;o++)n<<=6,n|=r(e[o]),i+=6,24===i&&(t+=String.fromCharCode((16711680&n)>>16),t+=String.fromCharCode((65280&n)>>8),t+=String.fromCharCode(255&n),n=i=0);return 12===i?(n>>=4,t+=String.fromCharCode(n)):18===i&&(n>>=2,t+=String.fromCharCode((65280&n)>>8),t+=String.fromCharCode(255&n)),t}},function(e,t,n){"use strict";function r(e){if(e>=0&&e<64)return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e]}e.exports=function(e){let t;for(e=""+e,t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return null;let n="";for(t=0;t<e.length;t+=3){const i=[void 0,void 0,void 0,void 0];i[0]=e.charCodeAt(t)>>2,i[1]=(3&e.charCodeAt(t))<<4,e.length>t+1&&(i[1]|=e.charCodeAt(t+1)>>4,i[2]=(15&e.charCodeAt(t+1))<<2),e.length>t+2&&(i[2]|=e.charCodeAt(t+2)>>6,i[3]=63&e.charCodeAt(t+2));for(let e=0;e<i.length;e++)void 0===i[e]?n+="=":n+=r(i[e])}return n}},function(e,t){e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}},function(e,t,n){var r=n(162);e.exports=function(e){return e?(e=r(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},function(e,t,n){var r=n(163),i=n(13),o=n(38),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=a.test(e);return n||u.test(e)?c(e.slice(2),n?2:8):s.test(e)?NaN:+e}},function(e,t,n){var r=n(164),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},function(e,t){var n=/\s/;e.exports=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},function(e,t,n){var r=n(39),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var i=s.call(e);return r&&(t?e[a]=n:delete e[a]),i}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r=n(86),i=n(168),o=n(180),s=n(9);e.exports=function(e,t){return(s(e)?r:i)(e,o(t))}},function(e,t,n){var r=n(169),i=n(179)(r);e.exports=i},function(e,t,n){var r=n(170),i=n(26);e.exports=function(e,t){return e&&r(e,t,i)}},function(e,t,n){var r=n(171)();e.exports=r},function(e,t){e.exports=function(e){return function(t,n,r){for(var i=-1,o=Object(t),s=r(t),a=s.length;a--;){var u=s[e?a:++i];if(!1===n(o[u],u,o))break}return t}}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(18),i=n(15);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(18),i=n(59),o=n(15),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!s[r(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var r=n(85),i=t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i&&r.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a}).call(this,n(58)(e))},function(e,t,n){var r=n(93)(Object.keys,Object);e.exports=r},function(e,t,n){var r=n(22);e.exports=function(e,t){return function(n,i){if(null==n)return n;if(!r(n))return e(n,i);for(var o=n.length,s=t?o:-1,a=Object(n);(t?s--:++s<o)&&!1!==i(a[s],s,a););return n}}},function(e,t,n){var r=n(29);e.exports=function(e){return"function"==typeof e?e:r}},function(e,t,n){var r=n(182),i=n(187),o=n(101),s=i((function(e,t){r(t,o(t),e)}));e.exports=s},function(e,t,n){var r=n(94),i=n(95);e.exports=function(e,t,n,o){var s=!n;n||(n={});for(var a=-1,u=t.length;++a<u;){var c=t[a],d=o?o(n[c],e[c],c,n,e):void 0;void 0===d&&(d=e[c]),s?i(n,c,d):r(n,c,d)}return n}},function(e,t,n){var r=n(52),i=n(184),o=n(13),s=n(97),a=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,d=u.toString,l=c.hasOwnProperty,f=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?f:a).test(s(e))}},function(e,t,n){var r,i=n(185),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!o&&o in e}},function(e,t,n){var r=n(6)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(98),i=n(191);e.exports=function(e){return r((function(t,n){var r=-1,o=n.length,s=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(s=e.length>3&&"function"==typeof s?(o--,s):void 0,a&&i(n[0],n[1],a)&&(s=o<3?void 0:s,o=1),t=Object(t);++r<o;){var u=n[r];u&&e(t,u,r,s)}return t}))}},function(e,t,n){var r=n(60),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,s=-1,a=i(o.length-t,0),u=Array(a);++s<a;)u[s]=o[t+s];s=-1;for(var c=Array(t+1);++s<t;)c[s]=o[s];return c[t]=n(u),r(e,this,c)}}},function(e,t,n){var r=n(190),i=n(96),o=n(29),s=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o;e.exports=s},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,n){var r=n(40),i=n(22),o=n(28),s=n(13);e.exports=function(e,t,n){if(!s(n))return!1;var a=typeof t;return!!("number"==a?i(n)&&o(t,n.length):"string"==a&&t in n)&&r(n[t],e)}},function(e,t,n){var r=n(13),i=n(92),o=n(193),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=i(e),n=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&n.push(a);return n}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t){e.exports=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},function(e,t,n){var r=n(61);e.exports=function(e,t){return r(t,(function(t){return e[t]}))}},function(e,t,n){var r=n(104),i=n(199),o=n(200),s=n(107),a=n(213),u=n(111),c=n(214),d=n(114),l=n(115),f=n(57),h=Math.max;e.exports=function(e,t,n,p,g,m,v,_){var y=2&t;if(!y&&"function"!=typeof e)throw new TypeError("Expected a function");var b=p?p.length:0;if(b||(t&=-97,p=g=void 0),v=void 0===v?v:h(f(v),0),_=void 0===_?_:f(_),b-=g?g.length:0,64&t){var w=p,S=g;p=g=void 0}var x=y?void 0:u(e),E=[e,t,n,p,g,w,S,m,v,_];if(x&&c(E,x),e=E[0],t=E[1],n=E[2],p=E[3],g=E[4],!(_=E[9]=void 0===E[9]?y?0:e.length:h(E[9]-b,0))&&24&t&&(t&=-25),t&&1!=t)A=8==t||16==t?o(e,t,_):32!=t&&33!=t||g.length?s.apply(void 0,E):a(e,t,n,p);else var A=i(e,t,n);return l((x?r:d)(A,E),e,t)}},function(e,t,n){var r=n(41),i=n(6);e.exports=function(e,t,n){var o=1&t,s=r(e);return function t(){var r=this&&this!==i&&this instanceof t?s:e;return r.apply(o?n:this,arguments)}}},function(e,t,n){var r=n(60),i=n(41),o=n(107),s=n(110),a=n(65),u=n(42),c=n(6);e.exports=function(e,t,n){var d=i(e);return function i(){for(var l=arguments.length,f=Array(l),h=l,p=a(i);h--;)f[h]=arguments[h];var g=l<3&&f[0]!==p&&f[l-1]!==p?[]:u(f,p);if((l-=g.length)<n)return s(e,t,o,i.placeholder,void 0,f,g,void 0,void 0,n-l);var m=this&&this!==c&&this instanceof i?d:e;return r(m,this,f)}}},function(e,t){e.exports=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}},function(e,t,n){var r=n(63),i=n(111),o=n(204),s=n(206);e.exports=function(e){var t=o(e),n=s[t];if("function"!=typeof n||!(t in r.prototype))return!1;if(e===n)return!0;var a=i(n);return!!a&&e===a[0]}},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(205),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",n=r[t],o=i.call(r,t)?n.length:0;o--;){var s=n[o],a=s.func;if(null==a||a==e)return s.name}return t}},function(e,t){e.exports={}},function(e,t,n){var r=n(63),i=n(112),o=n(64),s=n(9),a=n(15),u=n(207),c=Object.prototype.hasOwnProperty;function d(e){if(a(e)&&!s(e)&&!(e instanceof r)){if(e instanceof i)return e;if(c.call(e,"__wrapped__"))return u(e)}return new i(e)}d.prototype=o.prototype,d.prototype.constructor=d,e.exports=d},function(e,t,n){var r=n(63),i=n(112),o=n(113);e.exports=function(e){if(e instanceof r)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=o(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},function(e,t){var n=/\{\n\/\* \[wrapped with (.+)\] \*/,r=/,? & /;e.exports=function(e){var t=e.match(n);return t?t[1].split(r):[]}},function(e,t){var n=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var r=t.length;if(!r)return e;var i=r-1;return t[i]=(r>1?"& ":"")+t[i],t=t.join(r>2?", ":" "),e.replace(n,"{\n/* [wrapped with "+t+"] */\n")}},function(e,t,n){var r=n(86),i=n(211),o=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return r(o,(function(n){var r="_."+n[0];t&n[1]&&!i(e,r)&&e.push(r)})),e.sort()}},function(e,t,n){var r=n(102);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},function(e,t,n){var r=n(113),i=n(28),o=Math.min;e.exports=function(e,t){for(var n=e.length,s=o(t.length,n),a=r(e);s--;){var u=t[s];e[s]=i(u,n)?a[u]:void 0}return e}},function(e,t,n){var r=n(60),i=n(41),o=n(6);e.exports=function(e,t,n,s){var a=1&t,u=i(e);return function t(){for(var i=-1,c=arguments.length,d=-1,l=s.length,f=Array(l+c),h=this&&this!==o&&this instanceof t?u:e;++d<l;)f[d]=s[d];for(;c--;)f[d++]=arguments[++i];return r(h,a?n:this,f)}}},function(e,t,n){var r=n(108),i=n(109),o=n(42),s=Math.min;e.exports=function(e,t){var n=e[1],a=t[1],u=n|a,c=u<131,d=128==a&&8==n||128==a&&256==n&&e[7].length<=t[8]||384==a&&t[7].length<=t[8]&&8==n;if(!c&&!d)return e;1&a&&(e[2]=t[2],u|=1&n?0:4);var l=t[3];if(l){var f=e[3];e[3]=f?r(f,l,t[4]):l,e[4]=f?o(e[3],"__lodash_placeholder__"):t[4]}return(l=t[5])&&(f=e[5],e[5]=f?i(f,l,t[6]):l,e[6]=f?o(e[5],"__lodash_placeholder__"):t[6]),(l=t[7])&&(e[7]=l),128&a&&(e[8]=null==e[8]?t[8]:s(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=u,e}},function(e,t,n){var r=n(216),i=n(257),o=n(29),s=n(9),a=n(267);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?s(e)?i(e[0],e[1]):r(e):a(e)}},function(e,t,n){var r=n(217),i=n(256),o=n(125);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},function(e,t,n){var r=n(116),i=n(117);e.exports=function(e,t,n,o){var s=n.length,a=s,u=!o;if(null==e)return!a;for(e=Object(e);s--;){var c=n[s];if(u&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++s<a;){var d=(c=n[s])[0],l=e[d],f=c[1];if(u&&c[2]){if(void 0===l&&!(d in e))return!1}else{var h=new r;if(o)var p=o(l,f,d,e,t,h);if(!(void 0===p?i(f,l,3,o,h):p))return!1}}return!0}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(44),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},function(e,t,n){var r=n(44);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(44);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(44);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},function(e,t,n){var r=n(43);e.exports=function(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(43),i=n(66),o=n(67);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!i||s.length<199)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(s)}return n.set(e,t),this.size=n.size,this}},function(e,t,n){var r=n(229),i=n(43),o=n(66);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},function(e,t,n){var r=n(230),i=n(231),o=n(232),s=n(233),a=n(234);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,e.exports=u},function(e,t,n){var r=n(45);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(45),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(45),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},function(e,t,n){var r=n(45);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,n){var r=n(46);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(46);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(46);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(46);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},function(e,t,n){var r=n(116),i=n(118),o=n(246),s=n(250),a=n(123),u=n(9),c=n(89),d=n(90),l="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,h,p,g){var m=u(e),v=u(t),_=m?"[object Array]":a(e),y=v?"[object Array]":a(t),b=(_="[object Arguments]"==_?l:_)==l,w=(y="[object Arguments]"==y?l:y)==l,S=_==y;if(S&&c(e)){if(!c(t))return!1;m=!0,b=!1}if(S&&!b)return g||(g=new r),m||d(e)?i(e,t,n,h,p,g):o(e,t,_,n,h,p,g);if(!(1&n)){var x=b&&f.call(e,"__wrapped__"),E=w&&f.call(t,"__wrapped__");if(x||E){var A=x?e.value():e,N=E?t.value():t;return g||(g=new r),p(A,N,n,h,g)}}return!!S&&(g||(g=new r),s(e,t,n,h,p,g))}},function(e,t,n){var r=n(67),i=n(242),o=n(243);function s(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}s.prototype.add=s.prototype.push=i,s.prototype.has=o,e.exports=s},function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(39),i=n(247),o=n(40),s=n(118),a=n(248),u=n(249),c=r?r.prototype:void 0,d=c?c.valueOf:void 0;e.exports=function(e,t,n,r,c,l,f){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!l(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=a;case"[object Set]":var p=1&r;if(h||(h=u),e.size!=t.size&&!p)return!1;var g=f.get(e);if(g)return g==t;r|=2,f.set(e,t);var m=s(h(e),h(t),r,c,l,f);return f.delete(e),m;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},function(e,t,n){var r=n(6).Uint8Array;e.exports=r},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},function(e,t,n){var r=n(251),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,s,a){var u=1&n,c=r(e),d=c.length;if(d!=r(t).length&&!u)return!1;for(var l=d;l--;){var f=c[l];if(!(u?f in t:i.call(t,f)))return!1}var h=a.get(e),p=a.get(t);if(h&&p)return h==t&&p==e;var g=!0;a.set(e,t),a.set(t,e);for(var m=u;++l<d;){var v=e[f=c[l]],_=t[f];if(o)var y=u?o(_,v,f,t,e,a):o(v,_,f,e,t,a);if(!(void 0===y?v===_||s(v,_,n,o,a):y)){g=!1;break}m||(m="constructor"==f)}if(g&&!m){var b=e.constructor,w=t.constructor;b==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(g=!1)}return a.delete(e),a.delete(t),g}},function(e,t,n){var r=n(119),i=n(121),o=n(26);e.exports=function(e){return r(e,o,i)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}},function(e,t,n){var r=n(19)(n(6),"DataView");e.exports=r},function(e,t,n){var r=n(19)(n(6),"Promise");e.exports=r},function(e,t,n){var r=n(19)(n(6),"Set");e.exports=r},function(e,t,n){var r=n(124),i=n(26);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var o=t[n],s=e[o];t[n]=[o,s,r(s)]}return t}},function(e,t,n){var r=n(117),i=n(258),o=n(264),s=n(69),a=n(124),u=n(125),c=n(30);e.exports=function(e,t){return s(e)&&a(t)?u(c(e),t):function(n){var s=i(n,e);return void 0===s&&s===t?o(n,e):r(t,s,3)}}},function(e,t,n){var r=n(68);e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}},function(e,t,n){var r=n(260),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,r,i){t.push(r?i.replace(o,"$1"):n||e)})),t}));e.exports=s},function(e,t,n){var r=n(261);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},function(e,t,n){var r=n(67);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},function(e,t,n){var r=n(263);e.exports=function(e){return null==e?"":r(e)}},function(e,t,n){var r=n(39),i=n(61),o=n(9),s=n(38),a=r?r.prototype:void 0,u=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(s(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},function(e,t,n){var r=n(265),i=n(266);e.exports=function(e,t){return null!=e&&i(e,t,r)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,n){var r=n(47),i=n(88),o=n(9),s=n(28),a=n(59),u=n(30);e.exports=function(e,t,n){for(var c=-1,d=(t=r(t,e)).length,l=!1;++c<d;){var f=u(t[c]);if(!(l=null!=e&&n(e,f)))break;e=e[f]}return l||++c!=d?l:!!(d=null==e?0:e.length)&&a(d)&&s(f,d)&&(o(e)||i(e))}},function(e,t,n){var r=n(126),i=n(268),o=n(69),s=n(30);e.exports=function(e){return o(e)?r(s(e)):i(e)}},function(e,t,n){var r=n(68);e.exports=function(e){return function(t){return r(t,e)}}},function(e,t,n){var r=n(68),i=n(270),o=n(47);e.exports=function(e,t,n){for(var s=-1,a=t.length,u={};++s<a;){var c=t[s],d=r(e,c);n(d,c)&&i(u,o(c,e),d)}return u}},function(e,t,n){var r=n(94),i=n(47),o=n(28),s=n(13),a=n(30);e.exports=function(e,t,n,u){if(!s(e))return e;for(var c=-1,d=(t=i(t,e)).length,l=d-1,f=e;null!=f&&++c<d;){var h=a(t[c]),p=n;if("__proto__"===h||"constructor"===h||"prototype"===h)return e;if(c!=l){var g=f[h];void 0===(p=u?u(g,h,f):void 0)&&(p=s(g)?g:o(t[c+1])?[]:{})}r(f,h,p),f=f[h]}return e}},function(e,t,n){var r=n(119),i=n(272),o=n(101);e.exports=function(e){return r(e,o,i)}},function(e,t,n){var r=n(120),i=n(273),o=n(121),s=n(122),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,o(e)),e=i(e);return t}:s;e.exports=a},function(e,t,n){var r=n(93)(Object.getPrototypeOf,Object);e.exports=r},function(e,t,n){var r=n(275),i=n(276),o=n(277);e.exports=function(e){return i(e)?o(e):r(e)}},function(e,t,n){var r=n(126)("length");e.exports=r},function(e,t){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return n.test(e)}},function(e,t){var n="[\\ud800-\\udfff]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",o="[^\\ud800-\\udfff]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",u="(?:"+r+"|"+i+")"+"?",c="[\\ufe0e\\ufe0f]?"+u+("(?:\\u200d(?:"+[o,s,a].join("|")+")[\\ufe0e\\ufe0f]?"+u+")*"),d="(?:"+[o+r+"?",r,s,a,n].join("|")+")",l=RegExp(i+"(?="+i+")|"+d+c,"g");e.exports=function(e){for(var t=l.lastIndex=0;l.test(e);)++t;return t}},function(e,t,n){"use strict";t.__esModule=!0;var r,i=n(279),o=(r=i)&&r.__esModule?r:{default:r};t.default=function(e,t,n){return t in e?(0,o.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){e.exports={default:n(280),__esModule:!0}},function(e,t,n){n(281);var r=n(11).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(23);r(r.S+r.F*!n(25),"Object",{defineProperty:n(31).f})},function(e,t,n){e.exports=!n(25)&&!n(70)((function(){return 7!=Object.defineProperty(n(71)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(32);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){e.exports={default:n(285),__esModule:!0}},function(e,t,n){n(286),e.exports=n(11).Object.keys},function(e,t,n){var r=n(129),i=n(130);n(291)("keys",(function(){return function(e){return i(r(e))}}))},function(e,t,n){var r=n(50),i=n(73),o=n(289)(!1),s=n(75)("IE_PROTO");e.exports=function(e,t){var n,a=i(e),u=0,c=[];for(n in a)n!=s&&r(a,n)&&c.push(n);for(;t.length>u;)r(a,n=t[u++])&&(~o(c,n)||c.push(n));return c}},function(e,t,n){var r=n(51);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(73),i=n(131),o=n(290);e.exports=function(e){return function(t,n,s){var a,u=r(t),c=i(u.length),d=o(s,c);if(e&&n!=n){for(;c>d;)if((a=u[d++])!=a)return!0}else for(;c>d;d++)if((e||d in u)&&u[d]===n)return e||d||0;return!e&&-1}}},function(e,t,n){var r=n(74),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){var r=n(23),i=n(11),o=n(70);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],s={};s[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",s)}},function(e,t,n){e.exports=n(293)},function(e,t,n){var r=function(){return this}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,e.exports=n(294),i)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}},function(e,t){!function(t){"use strict";var n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag",u="object"==typeof e,c=t.regeneratorRuntime;if(c)u&&(e.exports=c);else{(c=t.regeneratorRuntime=u?e.exports:{}).wrap=g;var d={},l={};l[o]=function(){return this};var f=Object.getPrototypeOf,h=f&&f(f(N([])));h&&h!==n&&r.call(h,o)&&(l=h);var p=y.prototype=v.prototype=Object.create(l);_.prototype=p.constructor=y,y.constructor=_,y[a]=_.displayName="GeneratorFunction",c.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},c.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(p),e},c.awrap=function(e){return{__await:e}},b(w.prototype),w.prototype[s]=function(){return this},c.AsyncIterator=w,c.async=function(e,t,n,r){var i=new w(g(e,t,n,r));return c.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(p),p[a]="Generator",p[o]=function(){return this},p.toString=function(){return"[object Generator]"},c.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},c.values=N,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:N(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}}}function g(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,o=Object.create(i.prototype),s=new A(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return T()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=S(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=m(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,s),o}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function v(){}function _(){}function y(){}function b(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function w(e){var t;this._invoke=function(n,i){function o(){return new Promise((function(t,o){!function t(n,i,o,s){var a=m(e[n],e,i);if("throw"!==a.type){var u=a.arg,c=u.value;return c&&"object"==typeof c&&r.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,o,s)}),(function(e){t("throw",e,o,s)})):Promise.resolve(c).then((function(e){u.value=e,o(u)}),s)}s(a.arg)}(n,i,t,o)}))}return t=t?t.then(o,o):o()}}function S(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=m(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,d;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function N(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}}(function(){return this}()||Function("return this")())},function(e,t,n){"use strict";t.__esModule=!0;var r,i=n(77),o=(r=i)&&r.__esModule?r:{default:r};t.default=function(e){return function(){var t=e.apply(this,arguments);return new o.default((function(e,n){return function r(i,s){try{var a=t[i](s),u=a.value}catch(e){return void n(e)}if(!a.done)return o.default.resolve(u).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(u)}("next")}))}}},function(e,t,n){n(297),n(298),n(305),n(309),n(321),n(322),e.exports=n(11).Promise},function(e,t){},function(e,t,n){"use strict";var r=n(299)(!0);n(135)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){var r=n(74),i=n(72);e.exports=function(e){return function(t,n){var o,s,a=String(i(t)),u=r(n),c=a.length;return u<0||u>=c?e?"":void 0:(o=a.charCodeAt(u))<55296||o>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?e?a.charAt(u):o:e?a.slice(u,u+2):s-56320+(o-55296<<10)+65536}}},function(e,t,n){e.exports=n(24)},function(e,t,n){"use strict";var r=n(302),i=n(128),o=n(78),s={};n(24)(s,n(10)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(s,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(20),i=n(303),o=n(134),s=n(75)("IE_PROTO"),a=function(){},u=function(){var e,t=n(71)("iframe"),r=o.length;for(t.style.display="none",n(136).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u.prototype[o[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=r(e),n=new a,a.prototype=null,n[s]=e):n=u(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(31),i=n(20),o=n(130);e.exports=n(25)?Object.defineProperties:function(e,t){i(e);for(var n,s=o(t),a=s.length,u=0;a>u;)r.f(e,n=s[u++],t[n]);return e}},function(e,t,n){var r=n(50),i=n(129),o=n(75)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t,n){n(306);for(var r=n(7),i=n(24),o=n(33),s=n(10)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<a.length;u++){var c=a[u],d=r[c],l=d&&d.prototype;l&&!l[s]&&i(l,s,c),o[c]=o.Array}},function(e,t,n){"use strict";var r=n(307),i=n(308),o=n(33),s=n(73);e.exports=n(135)(Array,"Array",(function(e,t){this._t=s(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r,i,o,s,a=n(76),u=n(7),c=n(48),d=n(137),l=n(23),f=n(32),h=n(49),p=n(310),g=n(311),m=n(138),v=n(139).set,_=n(316)(),y=n(79),b=n(140),w=n(317),S=n(141),x=u.TypeError,E=u.process,A=E&&E.versions,N=A&&A.v8||"",T=u.Promise,O="process"==d(E),j=function(){},C=i=y.f,I=!!function(){try{var e=T.resolve(1),t=(e.constructor={})[n(10)("species")]=function(e){e(j,j)};return(O||"function"==typeof PromiseRejectionEvent)&&e.then(j)instanceof t&&0!==N.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}}(),R=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},M=function(e,t){if(!e._n){e._n=!0;var n=e._c;_((function(){for(var r=e._v,i=1==e._s,o=0,s=function(t){var n,o,s,a=i?t.ok:t.fail,u=t.resolve,c=t.reject,d=t.domain;try{a?(i||(2==e._h&&P(e),e._h=1),!0===a?n=r:(d&&d.enter(),n=a(r),d&&(d.exit(),s=!0)),n===t.promise?c(x("Promise-chain cycle")):(o=R(n))?o.call(n,u,c):u(n)):c(r)}catch(e){d&&!s&&d.exit(),c(e)}};n.length>o;)s(n[o++]);e._c=[],e._n=!1,t&&!e._h&&k(e)}))}},k=function(e){v.call(u,(function(){var t,n,r,i=e._v,o=D(e);if(o&&(t=b((function(){O?E.emit("unhandledRejection",i,e):(n=u.onunhandledrejection)?n({promise:e,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=O||D(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},D=function(e){return 1!==e._h&&0===(e._a||e._c).length},P=function(e){v.call(u,(function(){var t;O?E.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})}))},F=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},L=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw x("Promise can't be resolved itself");(t=R(e))?_((function(){var r={_w:n,_d:!1};try{t.call(e,c(L,r,1),c(F,r,1))}catch(e){F.call(r,e)}})):(n._v=e,n._s=1,M(n,!1))}catch(e){F.call({_w:n,_d:!1},e)}}};I||(T=function(e){p(this,T,"Promise","_h"),h(e),r.call(this);try{e(c(L,this,1),c(F,this,1))}catch(e){F.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(318)(T.prototype,{then:function(e,t){var n=C(m(this,T));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=O?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=c(L,e,1),this.reject=c(F,e,1)},y.f=C=function(e){return e===T||e===s?new o(e):i(e)}),l(l.G+l.W+l.F*!I,{Promise:T}),n(78)(T,"Promise"),n(319)("Promise"),s=n(11).Promise,l(l.S+l.F*!I,"Promise",{reject:function(e){var t=C(this);return(0,t.reject)(e),t.promise}}),l(l.S+l.F*(a||!I),"Promise",{resolve:function(e){return S(a&&this===s?T:this,e)}}),l(l.S+l.F*!(I&&n(320)((function(e){T.all(e).catch(j)}))),"Promise",{all:function(e){var t=this,n=C(t),r=n.resolve,i=n.reject,o=b((function(){var n=[],o=0,s=1;g(e,!1,(function(e){var a=o++,u=!1;n.push(void 0),s++,t.resolve(e).then((function(e){u||(u=!0,n[a]=e,--s||r(n))}),i)})),--s||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=C(t),r=n.reject,i=b((function(){g(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(48),i=n(312),o=n(313),s=n(20),a=n(131),u=n(314),c={},d={};(t=e.exports=function(e,t,n,l,f){var h,p,g,m,v=f?function(){return e}:u(e),_=r(n,l,t?2:1),y=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(o(v)){for(h=a(e.length);h>y;y++)if((m=t?_(s(p=e[y])[0],p[1]):_(e[y]))===c||m===d)return m}else for(g=v.call(e);!(p=g.next()).done;)if((m=i(g,_,p.value,t))===c||m===d)return m}).BREAK=c,t.RETURN=d},function(e,t,n){var r=n(20);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){var r=n(33),i=n(10)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){var r=n(137),i=n(10)("iterator"),o=n(33);e.exports=n(11).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(7),i=n(139).set,o=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,u="process"==n(51)(s);e.exports=function(){var e,t,n,c=function(){var r,i;for(u&&(r=s.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(u)n=function(){s.nextTick(c)};else if(!o||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var d=a.resolve(void 0);n=function(){d.then(c)}}else n=function(){i.call(r,c)};else{var l=!0,f=document.createTextNode("");new o(c).observe(f,{characterData:!0}),n=function(){f.data=l=!l}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t,n){var r=n(7).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){var r=n(24);e.exports=function(e,t,n){for(var i in t)n&&e[i]?e[i]=t[i]:r(e,i,t[i]);return e}},function(e,t,n){"use strict";var r=n(7),i=n(11),o=n(31),s=n(25),a=n(10)("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:r[e];s&&t&&!t[a]&&o.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(10)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(23),i=n(11),o=n(7),s=n(138),a=n(141);r(r.P+r.R,"Promise",{finally:function(e){var t=s(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return a(t,e()).then((function(){return n}))}:e,n?function(n){return a(t,e()).then((function(){throw n}))}:e)}})},function(e,t,n){"use strict";var r=n(23),i=n(79),o=n(140);r(r.S,"Promise",{try:function(e){var t=i.f(this),n=o(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(77),o=(r=i)&&r.__esModule?r:{default:r};function s(){return window.browser&&browser.storage||window.chrome&&chrome.storage}t.getStorage=s,t.usePromise=function(e,t){if(function(){var e=s();try{return e&&e.local.get&&e.local.get()&&"function"==typeof e.local.get().then}catch(e){return!1}}())return e(t);return new o.default((function(n){e(t,(function(){n.apply(void 0,arguments)}))}))}},function(e,t,n){"use strict";n(55);var r=n(0);const i={};i.debug=r.f.LogLevel.DEBUG,i.info=r.f.LogLevel.INFO,i.warn=r.f.LogLevel.WARN,i.error=r.f.LogLevel.ERROR,i.fatal=r.f.LogLevel.FATAL,r.f.WorkerWebsocket=class extends r.f.Websocket{constructor(e){super(e),this._conn=e,this.worker=new SharedWorker(this._conn.options.worker,"Strophe XMPP Connection"),this.worker.onerror=e=>{var t;null===(t=console)||void 0===t||t.error(e),r.f.log(r.f.LogLevel.ERROR,"Shared Worker Error: "+e)}}get socket(){return{send:e=>this.worker.port.postMessage(["send",e])}}_connect(){this._messageHandler=e=>this._onInitialMessage(e),this.worker.port.start(),this.worker.port.onmessage=e=>this._onWorkerMessage(e),this.worker.port.postMessage(["_connect",this._conn.service,this._conn.jid])}_attach(e){this._messageHandler=e=>this._onMessage(e),this._conn.connect_callback=e,this.worker.port.start(),this.worker.port.onmessage=e=>this._onWorkerMessage(e),this.worker.port.postMessage(["_attach",this._conn.service])}_attachCallback(e,t){e===r.f.Status.ATTACHED?(this._conn.jid=t,this._conn.authenticated=!0,this._conn.connected=!0,this._conn.restored=!0,this._conn._changeConnectStatus(r.f.Status.ATTACHED)):e===r.f.Status.ATTACHFAIL&&(this._conn.authenticated=!1,this._conn.connected=!1,this._conn.restored=!1,this._conn._changeConnectStatus(r.f.Status.ATTACHFAIL))}_disconnect(e,t){t&&this._conn.send(t);const n=Object(r.a)("close",{xmlns:r.f.NS.FRAMING});this._conn.xmlOutput(n.tree());const i=r.f.serialize(n);this._conn.rawOutput(i),this.worker.port.postMessage(["send",i]),this._conn._doDisconnect()}_onClose(e){this._conn.connected&&!this._conn.disconnecting?(r.f.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):e&&1006===e.code&&!this._conn.connected?(r.f.error("Websocket closed unexcectedly"),this._conn._changeConnectStatus(r.f.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._conn._doDisconnect()):r.f.debug("Websocket closed")}_closeSocket(){this.worker.port.postMessage(["_closeSocket"])}_replaceMessageHandler(){this._messageHandler=e=>this._onMessage(e)}_onWorkerMessage(e){const{data:t}=e,n=t[0];if("_onMessage"===n)this._messageHandler(t[1]);else if(n in this)try{this[n].apply(this,e.data.slice(1))}catch(e){r.f.log(r.f.LogLevel.ERROR,e)}else if("log"===n){const e=t[1],n=t[2];r.f.log(i[e],n)}else r.f.log(r.f.LogLevel.ERROR,"Found unhandled service worker message: "+t)}}},function(e,t,n){"use strict";n.r(t);n(154),n(55);var r=n(21);var i=function(){this.__data__=[],this.size=0};var o=function(e,t){return e===t||e!=e&&t!=t};var s=function(e,t){for(var n=e.length;n--;)if(o(e[n][0],t))return n;return-1},a=Array.prototype.splice;var u=function(e){var t=this.__data__,n=s(t,e);return!(n<0)&&(n==t.length-1?t.pop():a.call(t,n,1),--this.size,!0)};var c=function(e){var t=this.__data__,n=s(t,e);return n<0?void 0:t[n][1]};var d=function(e){return s(this.__data__,e)>-1};var l=function(e,t){var n=this.__data__,r=s(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function f(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}f.prototype.clear=i,f.prototype.delete=u,f.prototype.get=c,f.prototype.has=d,f.prototype.set=l;var h=f;var p=function(){this.__data__=new h,this.size=0};var g=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var m=function(e){return this.__data__.get(e)};var v=function(e){return this.__data__.has(e)},_=n(3),y=_.a.Symbol,b=Object.prototype,w=b.hasOwnProperty,S=b.toString,x=y?y.toStringTag:void 0;var E=function(e){var t=w.call(e,x),n=e[x];try{e[x]=void 0;var r=!0}catch(e){}var i=S.call(e);return r&&(t?e[x]=n:delete e[x]),i},A=Object.prototype.toString;var N=function(e){return A.call(e)},T=y?y.toStringTag:void 0;var O=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":T&&T in Object(e)?E(e):N(e)};var j=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var C,I=function(e){if(!j(e))return!1;var t=O(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},R=_.a["__core-js_shared__"],M=(C=/[^.]+$/.exec(R&&R.keys&&R.keys.IE_PROTO||""))?"Symbol(src)_1."+C:"";var k=function(e){return!!M&&M in e},D=Function.prototype.toString;var P=function(e){if(null!=e){try{return D.call(e)}catch(e){}try{return e+""}catch(e){}}return""},F=/^\[object .+?Constructor\]$/,L=Function.prototype,U=Object.prototype,z=L.toString,B=U.hasOwnProperty,$=RegExp("^"+z.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var H=function(e){return!(!j(e)||k(e))&&(I(e)?$:F).test(P(e))};var q=function(e,t){return null==e?void 0:e[t]};var J=function(e,t){var n=q(e,t);return H(n)?n:void 0},W=J(_.a,"Map"),V=J(Object,"create");var G=function(){this.__data__=V?V(null):{},this.size=0};var Y=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},X=Object.prototype.hasOwnProperty;var Q=function(e){var t=this.__data__;if(V){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return X.call(t,e)?t[e]:void 0},K=Object.prototype.hasOwnProperty;var Z=function(e){var t=this.__data__;return V?void 0!==t[e]:K.call(t,e)};var ee=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=V&&void 0===t?"__lodash_hash_undefined__":t,this};function te(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}te.prototype.clear=G,te.prototype.delete=Y,te.prototype.get=Q,te.prototype.has=Z,te.prototype.set=ee;var ne=te;var re=function(){this.size=0,this.__data__={hash:new ne,map:new(W||h),string:new ne}};var ie=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var oe=function(e,t){var n=e.__data__;return ie(t)?n["string"==typeof t?"string":"hash"]:n.map};var se=function(e){var t=oe(this,e).delete(e);return this.size-=t?1:0,t};var ae=function(e){return oe(this,e).get(e)};var ue=function(e){return oe(this,e).has(e)};var ce=function(e,t){var n=oe(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function de(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}de.prototype.clear=re,de.prototype.delete=se,de.prototype.get=ae,de.prototype.has=ue,de.prototype.set=ce;var le=de;var fe=function(e,t){var n=this.__data__;if(n instanceof h){var r=n.__data__;if(!W||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new le(r)}return n.set(e,t),this.size=n.size,this};function he(e){var t=this.__data__=new h(e);this.size=t.size}he.prototype.clear=p,he.prototype.delete=g,he.prototype.get=m,he.prototype.has=v,he.prototype.set=fe;var pe=he;var ge=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e},me=function(){try{var e=J(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var ve=function(e,t,n){"__proto__"==t&&me?me(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},_e=Object.prototype.hasOwnProperty;var ye=function(e,t,n){var r=e[t];_e.call(e,t)&&o(r,n)&&(void 0!==n||t in e)||ve(e,t,n)};var be=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],u=r?r(n[a],e[a],a,n,e):void 0;void 0===u&&(u=e[a]),i?ve(n,a,u):ye(n,a,u)}return n};var we=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r};var Se=function(e){return null!=e&&"object"==typeof e};var xe=function(e){return Se(e)&&"[object Arguments]"==O(e)},Ee=Object.prototype,Ae=Ee.hasOwnProperty,Ne=Ee.propertyIsEnumerable,Te=xe(function(){return arguments}())?xe:function(e){return Se(e)&&Ae.call(e,"callee")&&!Ne.call(e,"callee")},Oe=Array.isArray,je=n(14),Ce=/^(?:0|[1-9]\d*)$/;var Ie=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Ce.test(e))&&e>-1&&e%1==0&&e<t};var Re=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Me={};Me["[object Float32Array]"]=Me["[object Float64Array]"]=Me["[object Int8Array]"]=Me["[object Int16Array]"]=Me["[object Int32Array]"]=Me["[object Uint8Array]"]=Me["[object Uint8ClampedArray]"]=Me["[object Uint16Array]"]=Me["[object Uint32Array]"]=!0,Me["[object Arguments]"]=Me["[object Array]"]=Me["[object ArrayBuffer]"]=Me["[object Boolean]"]=Me["[object DataView]"]=Me["[object Date]"]=Me["[object Error]"]=Me["[object Function]"]=Me["[object Map]"]=Me["[object Number]"]=Me["[object Object]"]=Me["[object RegExp]"]=Me["[object Set]"]=Me["[object String]"]=Me["[object WeakMap]"]=!1;var ke=function(e){return Se(e)&&Re(e.length)&&!!Me[O(e)]};var De=function(e){return function(t){return e(t)}},Pe=n(8),Fe=Pe.a&&Pe.a.isTypedArray,Le=Fe?De(Fe):ke,Ue=Object.prototype.hasOwnProperty;var ze=function(e,t){var n=Oe(e),r=!n&&Te(e),i=!n&&!r&&Object(je.a)(e),o=!n&&!r&&!i&&Le(e),s=n||r||i||o,a=s?we(e.length,String):[],u=a.length;for(var c in e)!t&&!Ue.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Ie(c,u))||a.push(c);return a},Be=Object.prototype;var $e=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Be)};var He=function(e,t){return function(n){return e(t(n))}},qe=He(Object.keys,Object),Je=Object.prototype.hasOwnProperty;var We=function(e){if(!$e(e))return qe(e);var t=[];for(var n in Object(e))Je.call(e,n)&&"constructor"!=n&&t.push(n);return t};var Ve=function(e){return null!=e&&Re(e.length)&&!I(e)};var Ge=function(e){return Ve(e)?ze(e):We(e)};var Ye=function(e,t){return e&&be(t,Ge(t),e)};var Xe=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},Qe=Object.prototype.hasOwnProperty;var Ke=function(e){if(!j(e))return Xe(e);var t=$e(e),n=[];for(var r in e)("constructor"!=r||!t&&Qe.call(e,r))&&n.push(r);return n};var Ze=function(e){return Ve(e)?ze(e,!0):Ke(e)};var et=function(e,t){return e&&be(t,Ze(t),e)},tt=n(144);var nt=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t};var rt=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o};var it=function(){return[]},ot=Object.prototype.propertyIsEnumerable,st=Object.getOwnPropertySymbols,at=st?function(e){return null==e?[]:(e=Object(e),rt(st(e),(function(t){return ot.call(e,t)})))}:it;var ut=function(e,t){return be(e,at(e),t)};var ct=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},dt=He(Object.getPrototypeOf,Object),lt=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)ct(t,at(e)),e=dt(e);return t}:it;var ft=function(e,t){return be(e,lt(e),t)};var ht=function(e,t,n){var r=t(e);return Oe(e)?r:ct(r,n(e))};var pt=function(e){return ht(e,Ge,at)};var gt=function(e){return ht(e,Ze,lt)},mt=J(_.a,"DataView"),vt=J(_.a,"Promise"),_t=J(_.a,"Set"),yt=J(_.a,"WeakMap"),bt=P(mt),wt=P(W),St=P(vt),xt=P(_t),Et=P(yt),At=O;(mt&&"[object DataView]"!=At(new mt(new ArrayBuffer(1)))||W&&"[object Map]"!=At(new W)||vt&&"[object Promise]"!=At(vt.resolve())||_t&&"[object Set]"!=At(new _t)||yt&&"[object WeakMap]"!=At(new yt))&&(At=function(e){var t=O(e),n="[object Object]"==t?e.constructor:void 0,r=n?P(n):"";if(r)switch(r){case bt:return"[object DataView]";case wt:return"[object Map]";case St:return"[object Promise]";case xt:return"[object Set]";case Et:return"[object WeakMap]"}return t});var Nt=At,Tt=Object.prototype.hasOwnProperty;var Ot=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Tt.call(e,"index")&&(n.index=e.index,n.input=e.input),n},jt=_.a.Uint8Array;var Ct=function(e){var t=new e.constructor(e.byteLength);return new jt(t).set(new jt(e)),t};var It=function(e,t){var n=t?Ct(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},Rt=/\w*$/;var Mt=function(e){var t=new e.constructor(e.source,Rt.exec(e));return t.lastIndex=e.lastIndex,t},kt=y?y.prototype:void 0,Dt=kt?kt.valueOf:void 0;var Pt=function(e){return Dt?Object(Dt.call(e)):{}};var Ft=function(e,t){var n=t?Ct(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var Lt=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return Ct(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return It(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Ft(e,n);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return Mt(e);case"[object Set]":return new r;case"[object Symbol]":return Pt(e)}},Ut=Object.create,zt=function(){function e(){}return function(t){if(!j(t))return{};if(Ut)return Ut(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var Bt=function(e){return"function"!=typeof e.constructor||$e(e)?{}:zt(dt(e))};var $t=function(e){return Se(e)&&"[object Map]"==Nt(e)},Ht=Pe.a&&Pe.a.isMap,qt=Ht?De(Ht):$t;var Jt=function(e){return Se(e)&&"[object Set]"==Nt(e)},Wt=Pe.a&&Pe.a.isSet,Vt=Wt?De(Wt):Jt,Gt={};Gt["[object Arguments]"]=Gt["[object Array]"]=Gt["[object ArrayBuffer]"]=Gt["[object DataView]"]=Gt["[object Boolean]"]=Gt["[object Date]"]=Gt["[object Float32Array]"]=Gt["[object Float64Array]"]=Gt["[object Int8Array]"]=Gt["[object Int16Array]"]=Gt["[object Int32Array]"]=Gt["[object Map]"]=Gt["[object Number]"]=Gt["[object Object]"]=Gt["[object RegExp]"]=Gt["[object Set]"]=Gt["[object String]"]=Gt["[object Symbol]"]=Gt["[object Uint8Array]"]=Gt["[object Uint8ClampedArray]"]=Gt["[object Uint16Array]"]=Gt["[object Uint32Array]"]=!0,Gt["[object Error]"]=Gt["[object Function]"]=Gt["[object WeakMap]"]=!1;var Yt=function e(t,n,r,i,o,s){var a,u=1&n,c=2&n,d=4&n;if(r&&(a=o?r(t,i,o,s):r(t)),void 0!==a)return a;if(!j(t))return t;var l=Oe(t);if(l){if(a=Ot(t),!u)return nt(t,a)}else{var f=Nt(t),h="[object Function]"==f||"[object GeneratorFunction]"==f;if(Object(je.a)(t))return Object(tt.a)(t,u);if("[object Object]"==f||"[object Arguments]"==f||h&&!o){if(a=c||h?{}:Bt(t),!u)return c?ft(t,et(a,t)):ut(t,Ye(a,t))}else{if(!Gt[f])return o?t:{};a=Lt(t,f,u)}}s||(s=new pe);var p=s.get(t);if(p)return p;s.set(t,a),Vt(t)?t.forEach((function(i){a.add(e(i,n,r,i,t,s))})):qt(t)&&t.forEach((function(i,o){a.set(o,e(i,n,r,o,t,s))}));var g=l?void 0:(d?c?gt:pt:c?Ze:Ge)(t);return ge(g||t,(function(i,o){g&&(i=t[o=i]),ye(a,o,e(i,n,r,o,t,s))})),a};var Xt=function(e){return Yt(e,5)};var Qt=function(e){return"string"==typeof e||!Oe(e)&&Se(e)&&"[object String]"==O(e)};var Kt=function(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))};function Zt(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function en(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}var tn=function(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}},nn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rn=/^~~local_forage_type~([^~]+)~/,on="__lfsc__:".length,sn=on+"arbf".length,an=Object.prototype.toString;function un(e){var t,n,r,i,o,s=.75*e.length,a=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),d=new Uint8Array(c);for(t=0;t<a;t+=4)n=nn.indexOf(e[t]),r=nn.indexOf(e[t+1]),i=nn.indexOf(e[t+2]),o=nn.indexOf(e[t+3]),d[u++]=n<<2|r>>4,d[u++]=(15&r)<<4|i>>2,d[u++]=(3&i)<<6|63&o;return c}function cn(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=nn[n[t]>>2],r+=nn[(3&n[t])<<4|n[t+1]>>4],r+=nn[(15&n[t+1])<<2|n[t+2]>>6],r+=nn[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var dn={serialize:function(e,t){var n="";if(e&&(n=an.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===an.call(e.buffer))){var r,i="__lfsc__:";e instanceof ArrayBuffer?(r=e,i+="arbf"):(r=e.buffer,"[object Int8Array]"===n?i+="si08":"[object Uint8Array]"===n?i+="ui08":"[object Uint8ClampedArray]"===n?i+="uic8":"[object Int16Array]"===n?i+="si16":"[object Uint16Array]"===n?i+="ur16":"[object Int32Array]"===n?i+="si32":"[object Uint32Array]"===n?i+="ui32":"[object Float32Array]"===n?i+="fl32":"[object Float64Array]"===n?i+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(i+cn(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n="~~local_forage_type~"+e.type+"~"+cn(this.result);t("__lfsc__:blob"+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,on))return JSON.parse(e);var t,n=e.substring(sn),r=e.substring(on,sn);if("blob"===r&&rn.test(n)){var i=n.match(rn);t=i[1],n=n.substring(i[0].length)}var o=un(n);switch(r){case"arbf":return o;case"blob":return tn([o],{type:t});case"si08":return new Int8Array(o);case"ui08":return new Uint8Array(o);case"uic8":return new Uint8ClampedArray(o);case"si16":return new Int16Array(o);case"ur16":return new Uint16Array(o);case"si32":return new Int32Array(o);case"ui32":return new Uint32Array(o);case"fl32":return new Float32Array(o);case"fl64":return new Float64Array(o);default:throw new Error("Unkown type: "+r)}},stringToBuffer:un,bufferToString:cn};function ln(e,t){let n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}const fn={serializer:{serialize:dn.serialize,deserialize:dn.deserialize}};var hn={_driver:"sessionStorageWrapper",_initStorage:function(e){if(fn.keyPrefix=ln(e,this._defaultConfig),e)for(const t in e)fn[t]=e[t]},_support:function(){try{if(sessionStorage&&"setItem"in sessionStorage)return!0}catch(e){console.log(e)}return!1}(),iterate:function(e,t){const n=this.ready().then((function(){const t=fn.keyPrefix,n=t.length,r=sessionStorage.length;let i=1;for(let o=0;o<r;o++){const r=sessionStorage.key(o);if(0!==r.indexOf(t))continue;let s=sessionStorage.getItem(r);if(s&&(s=fn.serializer.deserialize(s)),s=e(s,r.substring(n),i++),void 0!==s)return s}}));return Kt(n,t),n},getItem:function(e,t){e=en(e);const n=this.ready().then((function(){let t=sessionStorage.getItem(fn.keyPrefix+e);return t&&(t=fn.serializer.deserialize(t)),t}));return Kt(n,t),n},setItem:function(e,t,n){e=en(e);const r=this.ready().then((function(){void 0===t&&(t=null);const n=t;return new Promise((function(r,i){fn.serializer.serialize(t,(function(t,o){if(o)i(o);else try{sessionStorage.setItem(fn.keyPrefix+e,t),r(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||i(e),i(e)}}))}))}));return Kt(r,n),r},removeItem:function(e,t){e=en(e);const n=this.ready().then((function(){sessionStorage.removeItem(fn.keyPrefix+e)}));return Kt(n,t),n},clear:function(e){const t=this.ready().then((function(){const e=fn.keyPrefix;for(let t=sessionStorage.length-1;t>=0;t--){const n=sessionStorage.key(t);0===n.indexOf(e)&&sessionStorage.removeItem(n)}}));return Kt(t,e),t},length:function(e){const t=this.keys().then((function(e){return e.length}));return Kt(t,e),t},key:function(e,t){const n=this.ready().then((function(){let t;try{t=sessionStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(fn.keyPrefix.length)),t}));return Kt(n,t),n},keys:function(e){const t=this.ready().then((function(){const e=sessionStorage.length,t=[];for(let n=0;n<e;n++){const e=sessionStorage.key(n);0===e.indexOf(fn.keyPrefix)&&t.push(e.substring(fn.keyPrefix.length))}return t}));return Kt(t,e),t},dropInstance:function(e,t){if(t=Zt.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){const t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}const n=this;let r;return r=e.name?new Promise((function(t){e.storeName?t(ln(e,n._defaultConfig)):t(e.name+"/")})).then((function(e){for(let t=sessionStorage.length-1;t>=0;t--){const n=sessionStorage.key(t);0===n.indexOf(e)&&sessionStorage.removeItem(n)}})):Promise.reject(new Error("Invalid arguments")),Kt(r,t),r}};function pn(){return(65536*(1+Math.random())|0).toString(16).substring(1)}class gn{constructor(e,t){if("local"===t&&!window.localStorage)throw new Error("Skeletor.storage: Environment does not support localStorage.");if("session"===t&&!window.sessionStorage)throw new Error("Skeletor.storage: Environment does not support sessionStorage.");Qt(t)?this.storeInitialized=this.initStore(t):(this.store=t,this.storeInitialized=Promise.resolve()),this.name=e}async initStore(e){if("session"===e)r.setDriver(hn._driver);else if("local"===e)await r.config({driver:r.LOCALSTORAGE});else if("indexed"!==e)throw new Error("Skeletor.storage: No storage type was specified");this.store=r}async clear(){await this.store.removeItem(this.name).catch(e=>console.error(e));const e=new RegExp(`^${this.name}-`),t=(await this.store.keys()).filter(t=>e.test(t));await Promise.all(t.map(e=>this.store.removeItem(e).catch(e=>console.error(e))))}sync(e){const t=this;async function n(e,n,r){let i,o,s,a;const u=n.collection;["patch","update"].includes(e)&&(a=Xt(n.attributes)),await t.storeInitialized;try{const o=n.attributes;switch(e){case"read":i=void 0!==n.id?await t.find(n):await t.findAll();break;case"create":i=await t.create(n,r);break;case"patch":case"update":r.wait&&(n.attributes=a),s=t.update(n,r),r.wait&&(n.attributes=o),i=await s;break;case"delete":i=await t.destroy(n,u)}}catch(e){o=22===e.code&&0===t.getStorageSize()?"Private browsing is unsupported":e.message}if(i){if(r&&r.success){const t="read"===e?i:null;r.success(t,r)}}else o=o||"Record Not Found",r&&r.error&&r.error(o)}return n.__name__="localSync",n}removeCollectionReference(e,t){if(!t)return;const n=t.filter(t=>t.id!==e.id).map(e=>this.getItemName(e.id));return this.store.setItem(this.name,n)}addCollectionReference(e,t){if(!t)return;const n=t.map(e=>this.getItemName(e.id)),r=this.getItemName(e.id);return n.includes(r)||n.push(r),this.store.setItem(this.name,n)}async save(e,t={}){const n=this.getItemName(e.id),r=await this.store.setItem(n,e.toJSON());return await this.addCollectionReference(e,e.collection),r}create(e,t){return e.id||(e.id=pn()+pn()+"-"+pn()+"-"+pn()+"-"+pn()+"-"+pn()+pn()+pn(),e.set(e.idAttribute,e.id,t)),this.save(e)}update(e,t){return this.save(e,t)}find(e){return this.store.getItem(this.getItemName(e.id))}async findAll(){const e=await this.store.getItem(this.name);return e&&e.length?Promise.all(e.map(e=>this.store.getItem(e))):[]}async destroy(e,t){return await this.store.removeItem(this.getItemName(e.id)),await this.removeCollectionReference(e,t),e}getStorageSize(){return this.store.length}getItemName(e){return this.name+"-"+e}}gn.sessionStorageInitialized=r.defineDriver(hn),gn.localForage=r;var mn=gn,vn=n(145),_n=n.n(vn),yn=n(16),bn=n.n(yn),wn=Function.prototype,Sn=Object.prototype,xn=wn.toString,En=Sn.hasOwnProperty,An=xn.call(Object);var Nn=function(e){if(!Se(e)||"[object Object]"!=O(e))return!1;var t=dt(e);if(null===t)return!0;var n=En.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&xn.call(n)==An};var Tn,On,jn,Cn,In=function(e){return Se(e)&&1===e.nodeType&&!Nn(e)};const Rn={debug:0,info:1,warn:2,error:3,fatal:4},Mn=Object.assign({debug:null!==(Tn=console)&&void 0!==Tn&&Tn.log?console.log.bind(console):function(){},error:null!==(On=console)&&void 0!==On&&On.log?console.log.bind(console):function(){},info:null!==(jn=console)&&void 0!==jn&&jn.log?console.log.bind(console):function(){},warn:null!==(Cn=console)&&void 0!==Cn&&Cn.log?console.log.bind(console):function(){}},console);var kn={setLogLevel(e){if(!["debug","info","warn","error","fatal"].includes(e))throw new Error("Invalid loglevel: "+e);this.loglevel=e},log(e,t,n=""){if(Rn[t]<Rn[this.loglevel])return;"error"===t||"fatal"===t?n=n||"color: maroon":"debug"===t&&(n=n||"color: green"),e instanceof Error?e=e.stack:In(e)&&(e=e.outerHTML);const r=n?"%c":"";"error"===t?Mn.error(`${r} ERROR: ${e}`,n):"warn"===t?Mn.warn(`${r} ${(new Date).toISOString()} WARNING: ${e}`,n):"fatal"===t?Mn.error(`${r} FATAL: ${e}`,n):"debug"===t?Mn.debug(`${r} ${(new Date).toISOString()} DEBUG: ${e}`,n):Mn.info(`${r} ${(new Date).toISOString()} INFO: ${e}`,n)},debug(e,t){this.log(e,"debug",t)},error(e,t){this.log(e,"error",t)},info(e,t){this.log(e,"info",t)},warn(e,t){this.log(e,"warn",t)},fatal(e,t){this.log(e,"fatal",t)}},Dn=n(146),Pn=n.n(Dn),Fn=n(35),Ln=n.n(Fn),Un=n(36),zn=n.n(Un),Bn=n(27),$n=n.n(Bn),Hn=n(147),qn=n.n(Hn),Jn=n(52),Wn=n.n(Jn),Vn=n(148),Gn=n.n(Vn),Yn=n(26),Xn=n.n(Yn),Qn=n(81),Kn=n.n(Qn),Zn=n(149),er=n.n(Zn),tr=n(150),nr=n.n(tr),rr=n(80),ir=n.n(rr);function or(e,t){this.name=t,this.plugged=e,void 0===this.plugged.__super__?this.plugged.__super__={}:"string"==typeof this.plugged.__super__&&(this.plugged.__super__={__string__:this.plugged.__super__}),this.plugged.__super__[t]=this.plugged,this.plugins={},this.initialized_plugins=[]}zn()(or.prototype,{wrappedOverride:function(e,t,n,r){return"function"==typeof n&&(void 0===this.__super__&&(this.__super__=r),this.__super__[e]=n.bind(this)),t.apply(this,Pn()(arguments,4))},_overrideAttribute:function(e,t){let n=t.overrides[e];if("function"==typeof n){let t={};t[this.name]=this.plugged;let r=Kn()(this.wrappedOverride,e,n,this.plugged[e],t);this.plugged[e]=r}else this.plugged[e]=n},_extendObject:function(e,t){e.prototype.__super__||(e.prototype.__super__={},e.prototype.__super__[this.name]=this.plugged);let n=this;Ln()(t,(function(t,r){if("events"===r)e.prototype[r]=zn()(t,e.prototype[r]);else if("function"==typeof t){let i={};i[n.name]=n.plugged;let o=Kn()(n.wrappedOverride,r,t,e.prototype[r],i);e.prototype[r]=o}else e.prototype[r]=t}))},loadPluginDependencies:function(e){Ln()(e.dependencies,t=>{let n=this.plugins[t];if(n){if($n()(n.dependencies,e.__name__))throw'Found a circular dependency between the plugins "'+e.__name__+'" and "'+t+'"';this.initializePlugin(n)}else this.throwUndefinedDependencyError('Could not find dependency "'+t+'" for the plugin "'+e.__name__+"\". If it's needed, make sure it's loaded by require.js")})},throwUndefinedDependencyError:function(e){if(this.plugged.strict_plugin_dependencies)throw e;console.warn?console.warn(e):console.log(e)},applyOverrides:function(e){Ln()(Object.keys(e.overrides||{}),t=>{let n=e.overrides[t];"object"==typeof n?void 0===this.plugged[t]?this.throwUndefinedDependencyError(`Plugin "${e.__name__}" tried to override "${t}" but it's not found.`):this._extendObject(this.plugged[t],n):this._overrideAttribute(t,e)})},initializePlugin:function(e){$n()(Xn()(this.allowed_plugins),e.__name__)&&($n()(this.initialized_plugins,e.__name__)||(qn()(e.enabled)&&e.enabled||Wn()(e.enabled)&&e.enabled(this.plugged)||Gn()(e.enabled))&&(zn()(e,this.properties),e.dependencies&&this.loadPluginDependencies(e),this.applyOverrides(e),"function"==typeof e.initialize&&e.initialize.bind(e)(this),this.initialized_plugins.push(e.__name__)))},registerPlugin:function(e,t){if(e in this.plugins)throw new Error("Error: Plugin name "+e+" is already taken");t.__name__=e,this.plugins[e]=t},initializePlugins:function(e={},t=[],n=[]){nr()(this.plugins)&&(this.properties=e,this.allowed_plugins=er()(this.plugins,(function(e,r){return(!t.length||t.length&&$n()(t,r))&&!$n()(n,r)})),Ln()(ir()(this.allowed_plugins),this.initializePlugin.bind(this)))}});var sr={enable:function(e,t,n){void 0===n&&(n="pluginSocket"),void 0===t&&(t="plugged");let r={};return r[n]=new or(e,t),zn()(e,r)}},ar=n(151),ur=n.n(ar),cr=n(152),dr=n.n(cr),lr=n(2),fr=n.n(lr),hr=n(0);var pr=function(e,t){var n=zt(e);return null==t?n:Ye(n,t)};var gr=function(e){return e};var mr=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},vr=Math.max;var _r=function(e,t,n){return t=vr(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=vr(r.length-t,0),s=Array(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),mr(e,this,a)}};var yr=function(e){return function(){return e}},br=me?function(e,t){return me(e,"toString",{configurable:!0,enumerable:!1,value:yr(t),writable:!0})}:gr,wr=Date.now;var Sr=function(e){var t=0,n=0;return function(){var r=wr(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(br);var xr=function(e,t){return Sr(_r(e,t,gr),e+"")};var Er=function(e,t,n){if(!j(n))return!1;var r=typeof t;return!!("number"==r?Ve(n)&&Ie(t,n.length):"string"==r&&t in n)&&o(n[t],e)};var Ar=function(e){return xr((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&Er(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var a=n[r];a&&e(t,a,r,o)}return t}))}((function(e,t){be(t,Ze(t),e)})),Nr=Object.prototype.hasOwnProperty;var Tr=function(e,t){return null!=e&&Nr.call(e,t)};var Or=function(e){return"symbol"==typeof e||Se(e)&&"[object Symbol]"==O(e)},jr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Cr=/^\w*$/;var Ir=function(e,t){if(Oe(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Or(e))||(Cr.test(e)||!jr.test(e)||null!=t&&e in Object(t))};function Rr(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Rr.Cache||le),n}Rr.Cache=le;var Mr=Rr;var kr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dr=/\\(\\)?/g,Pr=function(e){var t=Mr(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(kr,(function(e,n,r,i){t.push(r?i.replace(Dr,"$1"):n||e)})),t}));var Fr=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},Lr=y?y.prototype:void 0,Ur=Lr?Lr.toString:void 0;var zr=function e(t){if("string"==typeof t)return t;if(Oe(t))return Fr(t,e)+"";if(Or(t))return Ur?Ur.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n};var Br=function(e){return null==e?"":zr(e)};var $r=function(e,t){return Oe(e)?e:Ir(e,t)?[e]:Pr(Br(e))};var Hr=function(e){if("string"==typeof e||Or(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t};var qr=function(e,t,n){for(var r=-1,i=(t=$r(t,e)).length,o=!1;++r<i;){var s=Hr(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Re(i)&&Ie(s,i)&&(Oe(e)||Te(e))};var Jr=function(e,t){return null!=e&&qr(e,t,Tr)};var Wr=function(e,t,n){var r=-1,i=(t=$r(t,e)).length;for(i||(i=1,e=void 0);++r<i;){var o=null==e?void 0:e[Hr(t[r])];void 0===o&&(r=i,o=n),e=I(o)?o.call(e):o}return e};Error;function Vr(e,t){const n=this;let r;return r=e&&Jr(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},Ar(r,n,t),r.prototype=pr(n.prototype,e),r.prototype.constructor=r,r.__super__=n.prototype,r}function Gr(){const e={isResolved:!1,isPending:!0,isRejected:!1},t=new Promise((t,n)=>{e.resolve=t,e.reject=n});return Object.assign(t,e),t.then((function(e){return t.isResolved=!0,t.isPending=!1,t.isRejected=!1,e}),(function(e){throw t.isResolved=!1,t.isPending=!1,t.isRejected=!0,e})),t}function Yr(){throw new Error('A "url" property or function must be specified')}function Xr(e,t){const n=t.error;t.error=function(r){n&&n.call(t.context,e,r,t),e.trigger("error",e,r,t)}}const Qr={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};function Kr(e){const t=Wr(e,"browserStorage")||Wr(e.collection,"browserStorage");return t?t.sync():Zr}function Zr(e,t,n={}){const r={type:Qr[e],dataType:"json"};n.url||(r.url=Wr(t,"url")||Yr()),null!=n.data||!t||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||t.toJSON(n))),"GET"!==r.type&&(r.processData=!1);const i=n.error;n.error=function(e,t,r){n.textStatus=t,n.errorThrown=r,i&&i.call(n.context,e,t,r)};const o=n.xhr=function(){return fetch.apply(this,arguments)}(Ar(r,n));return t.trigger("request",t,o,n),o}var ei=Object.prototype.hasOwnProperty;var ti=function(e){if(null==e)return!0;if(Ve(e)&&(Oe(e)||"string"==typeof e||"function"==typeof e.splice||Object(je.a)(e)||Le(e)||Te(e)))return!e.length;var t=Nt(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if($e(e))return!We(e).length;for(var n in e)if(ei.call(e,n))return!1;return!0},ni=/\s/;var ri=function(e){for(var t=e.length;t--&&ni.test(e.charAt(t)););return t},ii=/^\s+/;var oi=function(e){return e?e.slice(0,ri(e)+1).replace(ii,""):e},si=/^[-+]0x[0-9a-f]+$/i,ai=/^0b[01]+$/i,ui=/^0o[0-7]+$/i,ci=parseInt;var di=function(e){if("number"==typeof e)return e;if(Or(e))return NaN;if(j(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=j(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=oi(e);var n=ai.test(e);return n||ui.test(e)?ci(e.slice(2),n?2:8):si.test(e)?NaN:+e};var li=function(e){return e?(e=di(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var fi=function(e){var t=li(e),n=t%1;return t==t?n?t-n:t:0};var hi=function(e,t){var n;if("function"!=typeof t)throw new TypeError("Expected a function");return e=fi(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}};var pi=function(e){return hi(2,e)},gi=0;var mi=function(e){var t=++gi;return Br(e)+t};const vi={},_i=/\s+/;let yi;const bi=function(e,t,n,r,i){let o,s=0;if(n&&"object"==typeof n){void 0!==r&&"context"in i&&void 0===i.context&&(i.context=r);for(o=Ge(n);s<o.length;s++)t=bi(e,t,o[s],n[o[s]],i)}else if(n&&_i.test(n))for(o=n.split(_i);s<o.length;s++)t=e(t,o[s],r,i);else t=e(t,n,r,i);return t};vi.on=function(e,t,n){if(this._events=bi(wi,this._events||{},e,t,{context:n,ctx:this,listening:yi}),yi){(this._listeners||(this._listeners={}))[yi.id]=yi,yi.interop=!1}return this},vi.listenTo=function(e,t,n){if(!e)return this;const r=e._listenId||(e._listenId=mi("l")),i=this._listeningTo||(this._listeningTo={});let o=yi=i[r];o||(this._listenId||(this._listenId=mi("l")),o=yi=i[r]=new Ti(this,e));const s=Si(e,t,n,this);if(yi=void 0,s)throw s;return o.interop&&o.on(t,n),this};const wi=function(e,t,n,r){if(n){const i=e[t]||(e[t]=[]),o=r.context,s=r.ctx,a=r.listening;a&&a.count++,i.push({callback:n,context:o,ctx:o||s,listening:a})}return e},Si=function(e,t,n,r){try{e.on(t,n,r)}catch(e){return e}};vi.off=function(e,t,n){return this._events?(this._events=bi(xi,this._events,e,t,{context:n,listeners:this._listeners}),this):this},vi.stopListening=function(e,t,n){const r=this._listeningTo;if(!r)return this;const i=e?[e._listenId]:Ge(r);for(let e=0;e<i.length;e++){const o=r[i[e]];if(!o)break;o.obj.off(t,n,this),o.interop&&o.off(t,n)}return ti(r)&&(this._listeningTo=void 0),this};const xi=function(e,t,n,r){if(!e)return;const i=r.context,o=r.listeners;let s,a=0;if(t||i||n){for(s=t?[t]:Ge(e);a<s.length;a++){const r=e[t=s[a]];if(!r)break;const o=[];for(let e=0;e<r.length;e++){const s=r[e];if(n&&n!==s.callback&&n!==s.callback._callback||i&&i!==s.context)o.push(s);else{const e=s.listening;e&&e.off(t,n)}}o.length?e[t]=o:delete e[t]}return e}for(s=Ge(o);a<s.length;a++)o[s[a]].cleanup()};vi.once=function(e,t,n){const r=bi(Ei,{},e,t,this.off.bind(this));return"string"==typeof e&&null==n&&(t=void 0),this.on(r,t,n)},vi.listenToOnce=function(e,t,n){const r=bi(Ei,{},t,n,this.stopListening.bind(this,e));return this.listenTo(e,r)};const Ei=function(e,t,n,r){if(n){const i=e[t]=pi((function(){r(t,i),n.apply(this,arguments)}));i._callback=n}return e};vi.trigger=function(e){if(!this._events)return this;const t=Math.max(0,arguments.length-1),n=Array(t);for(let e=0;e<t;e++)n[e]=arguments[e+1];return bi(Ai,this._events,e,void 0,n),this};const Ai=function(e,t,n,r){if(e){const n=e[t];let i=e.all;n&&i&&(i=i.slice()),n&&Ni(n,r),i&&Ni(i,[t].concat(r))}return e},Ni=function(e,t){let n,r=-1;const i=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t);return}},Ti=function(e,t){this.id=e._listenId,this.listener=e,this.obj=t,this.interop=!0,this.count=0,this._events=void 0};Ti.prototype.on=vi.on,Ti.prototype.off=function(e,t){let n;this.interop?(this._events=bi(xi,this._events,e,t,{context:void 0,listeners:void 0}),n=!this._events):(this.count--,n=0===this.count),n&&this.cleanup()},Ti.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},vi.bind=vi.on,vi.unbind=vi.off;var Oi=function(e){return Yt(e,4)},ji=Object.prototype,Ci=ji.hasOwnProperty,Ii=xr((function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&Er(t[0],t[1],i)&&(r=1);++n<r;)for(var s=t[n],a=Ze(s),u=-1,c=a.length;++u<c;){var d=a[u],l=e[d];(void 0===l||o(l,ji[d])&&!Ci.call(e,d))&&(e[d]=s[d])}return e}));var Ri=function(e,t,n){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,n)}),t)},Mi=xr((function(e,t){return Ri(e,1,t)}));var ki=function(e){return function(t){return null==e?void 0:e[t]}}({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Di=/[&<>"']/g,Pi=RegExp(Di.source);var Fi=function(e){return(e=Br(e))&&Pi.test(e)?e.replace(Di,ki):e};var Li=function(e){return function(t,n,r){for(var i=-1,o=Object(t),s=r(t),a=s.length;a--;){var u=s[e?a:++i];if(!1===n(o[u],u,o))break}return t}}();var Ui=function(e,t){return e&&Li(e,t,Ge)};var zi=function(e,t,n,r){return Ui(e,(function(e,i,o){t(r,n(e),i,o)})),r};var Bi=function(e,t){return function(n,r){return zi(n,e,t(r),{})}},$i=Object.prototype.toString,Hi=Bi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=$i.call(t)),e[t]=n}),yr(gr));var qi=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var Ji=function(e){return this.__data__.has(e)};function Wi(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new le;++t<n;)this.add(e[t])}Wi.prototype.add=Wi.prototype.push=qi,Wi.prototype.has=Ji;var Vi=Wi;var Gi=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1};var Yi=function(e,t){return e.has(t)};var Xi=function(e,t,n,r,i,o){var s=1&n,a=e.length,u=t.length;if(a!=u&&!(s&&u>a))return!1;var c=o.get(e),d=o.get(t);if(c&&d)return c==t&&d==e;var l=-1,f=!0,h=2&n?new Vi:void 0;for(o.set(e,t),o.set(t,e);++l<a;){var p=e[l],g=t[l];if(r)var m=s?r(g,p,l,t,e,o):r(p,g,l,e,t,o);if(void 0!==m){if(m)continue;f=!1;break}if(h){if(!Gi(t,(function(e,t){if(!Yi(h,t)&&(p===e||i(p,e,n,r,o)))return h.push(t)}))){f=!1;break}}else if(p!==g&&!i(p,g,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f};var Qi=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n};var Ki=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},Zi=y?y.prototype:void 0,eo=Zi?Zi.valueOf:void 0;var to=function(e,t,n,r,i,s,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!s(new jt(e),new jt(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var u=Qi;case"[object Set]":var c=1&r;if(u||(u=Ki),e.size!=t.size&&!c)return!1;var d=a.get(e);if(d)return d==t;r|=2,a.set(e,t);var l=Xi(u(e),u(t),r,i,s,a);return a.delete(e),l;case"[object Symbol]":if(eo)return eo.call(e)==eo.call(t)}return!1},no=Object.prototype.hasOwnProperty;var ro=function(e,t,n,r,i,o){var s=1&n,a=pt(e),u=a.length;if(u!=pt(t).length&&!s)return!1;for(var c=u;c--;){var d=a[c];if(!(s?d in t:no.call(t,d)))return!1}var l=o.get(e),f=o.get(t);if(l&&f)return l==t&&f==e;var h=!0;o.set(e,t),o.set(t,e);for(var p=s;++c<u;){var g=e[d=a[c]],m=t[d];if(r)var v=s?r(m,g,d,t,e,o):r(g,m,d,e,t,o);if(!(void 0===v?g===m||i(g,m,n,r,o):v)){h=!1;break}p||(p="constructor"==d)}if(h&&!p){var _=e.constructor,y=t.constructor;_==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof y&&y instanceof y||(h=!1)}return o.delete(e),o.delete(t),h},io=Object.prototype.hasOwnProperty;var oo=function(e,t,n,r,i,o){var s=Oe(e),a=Oe(t),u=s?"[object Array]":Nt(e),c=a?"[object Array]":Nt(t),d="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),l="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),f=u==c;if(f&&Object(je.a)(e)){if(!Object(je.a)(t))return!1;s=!0,d=!1}if(f&&!d)return o||(o=new pe),s||Le(e)?Xi(e,t,n,r,i,o):to(e,t,u,n,r,i,o);if(!(1&n)){var h=d&&io.call(e,"__wrapped__"),p=l&&io.call(t,"__wrapped__");if(h||p){var g=h?e.value():e,m=p?t.value():t;return o||(o=new pe),i(g,m,n,r,o)}}return!!f&&(o||(o=new pe),ro(e,t,n,r,i,o))};var so=function e(t,n,r,i,o){return t===n||(null==t||null==n||!Se(t)&&!Se(n)?t!=t&&n!=n:oo(t,n,r,i,e,o))};var ao=function(e,t){return so(e,t)};var uo=function(e,t,n,r){var i=n.length,o=i,s=!r;if(null==e)return!o;for(e=Object(e);i--;){var a=n[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var u=(a=n[i])[0],c=e[u],d=a[1];if(s&&a[2]){if(void 0===c&&!(u in e))return!1}else{var l=new pe;if(r)var f=r(c,d,u,e,t,l);if(!(void 0===f?so(d,c,3,r,l):f))return!1}}return!0};var co=function(e){return e==e&&!j(e)};var lo=function(e){for(var t=Ge(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,co(i)]}return t};var fo=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}};var ho=function(e){var t=lo(e);return 1==t.length&&t[0][2]?fo(t[0][0],t[0][1]):function(n){return n===e||uo(n,e,t)}};var po=function(e,t){for(var n=0,r=(t=$r(t,e)).length;null!=e&&n<r;)e=e[Hr(t[n++])];return n&&n==r?e:void 0};var go=function(e,t,n){var r=null==e?void 0:po(e,t);return void 0===r?n:r};var mo=function(e,t){return null!=e&&t in Object(e)};var vo=function(e,t){return null!=e&&qr(e,t,mo)};var _o=function(e,t){return Ir(e)&&co(t)?fo(Hr(e),t):function(n){var r=go(n,e);return void 0===r&&r===t?vo(n,e):so(t,r,3)}};var yo=function(e){return function(t){return null==t?void 0:t[e]}};var bo=function(e){return function(t){return po(t,e)}};var wo=function(e){return Ir(e)?yo(Hr(e)):bo(e)};var So=function(e){return"function"==typeof e?e:null==e?gr:"object"==typeof e?Oe(e)?_o(e[0],e[1]):ho(e):wo(e)};var xo=function(e){return So("function"==typeof e?e:Yt(e,1))};var Eo=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var Ao=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o};var No=function(e,t){return t.length<2?e:po(e,Ao(t,0,-1))};var To=function(e,t){return t=$r(t,e),null==(e=No(e,t))||delete e[Hr(Eo(t))]};var Oo=function(e){return Nn(e)?void 0:e},jo=y?y.isConcatSpreadable:void 0;var Co=function(e){return Oe(e)||Te(e)||!!(jo&&e&&e[jo])};var Io=function e(t,n,r,i,o){var s=-1,a=t.length;for(r||(r=Co),o||(o=[]);++s<a;){var u=t[s];n>0&&r(u)?n>1?e(u,n-1,r,i,o):ct(o,u):i||(o[o.length]=u)}return o};var Ro=function(e){return(null==e?0:e.length)?Io(e,1):[]};var Mo=function(e){return Sr(_r(e,void 0,Ro),e+"")},ko=Mo((function(e,t){var n={};if(null==e)return n;var r=!1;t=Fr(t,(function(t){return t=$r(t,e),r||(r=t.length>1),t})),be(e,gt(e),n),r&&(n=Yt(n,7,Oo));for(var i=t.length;i--;)To(n,t[i]);return n}));var Do=function(e,t,n,r){if(!j(e))return e;for(var i=-1,o=(t=$r(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var u=Hr(t[i]),c=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(i!=s){var d=a[u];void 0===(c=r?r(d,u,a):void 0)&&(c=j(d)?d:Ie(t[i+1])?[]:{})}ye(a,u,c),a=a[u]}return e};var Po=function(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=po(e,s);n(a,s)&&Do(o,$r(s,e),a)}return o};var Fo=function(e,t){return Po(e,t,(function(t,n){return vo(e,n)}))},Lo=Mo((function(e,t){return null==e?{}:Fo(e,t)}));const Uo=function(e,t){let n=e||{};t||(t={}),this.preinitialize.apply(this,arguments),this.cid=mi(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{});const r=Wr(this,"defaults");n=Ii(Ar({},r,n),r),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};Uo.extend=Vr,Object.assign(Uo.prototype,vi,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(e){return Oi(this.attributes)},sync:function(e,t,n){return Kr(this)(e,t,n)},get:function(e){return this.attributes[e]},keys:function(){return Object.keys(this.attributes)},values:function(){return Object.values(this.attributes)},pairs:function(){return this.entries()},entries:function(){return Object.entries(this.attributes)},invert:function(){return Hi(this.attributes)},pick:function(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),Lo(this.attributes,e)},omit:function(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),ko(this.attributes,e)},isEmpty:function(){return ti(this.attributes)},escape:function(e){return Fi(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!xo(e,this)(this.attributes)},set:function(e,t,n){if(null==e)return this;let r;if("object"==typeof e?(r=e,n=t):(r={})[e]=t,n||(n={}),!this._validate(r,n))return!1;const i=n.unset,o=n.silent,s=[],a=this._changing;this._changing=!0,a||(this._previousAttributes=Oi(this.attributes),this.changed={});const u=this.attributes,c=this.changed,d=this._previousAttributes;for(const e in r)t=r[e],ao(u[e],t)||s.push(e),ao(d[e],t)?delete c[e]:c[e]=t,i?delete u[e]:u[e]=t;if(this.idAttribute in r&&(this.id=this.get(this.idAttribute)),!o){s.length&&(this._pending=n);for(let e=0;e<s.length;e++)this.trigger("change:"+s[e],this,u[s[e]],n)}if(a)return this;if(!o)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,Ar({},t,{unset:!0}))},clear:function(e){const t={};for(const e in this.attributes)t[e]=void 0;return this.set(t,Ar({},e,{unset:!0}))},hasChanged:function(e){return null==e?!ti(this.changed):Jr(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&Oi(this.changed);const t=this._changing?this._previousAttributes:this.attributes,n={};let r;for(const i in e){const o=e[i];ao(t[i],o)||(n[i]=o,r=!0)}return!!r&&n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return Oi(this._previousAttributes)},fetch:function(e){e=Ar({parse:!0},e);const t=this,n=e.success;return e.success=function(r){const i=e.parse?t.parse(r,e):r;if(!t.set(i,e))return!1;n&&n.call(e.context,t,r,e),t.trigger("sync",t,r,e)},Xr(this,e),this.sync("read",this,e)},save:function(e,t,n){let r;null==e||"object"==typeof e?(r=e,n=t):(r={})[e]=t;const i=(n=Ar({validate:!0,parse:!0},n)).wait,o=n.promise,s=o&&Gr();if(r&&!i){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;const a=this,u=n.success,c=n.error,d=this.attributes;n.success=function(e){a.attributes=d;let t=n.parse?a.parse(e,n):e;if(i&&(t=Ar({},r,t)),t&&!a.set(t,n))return!1;u&&u.call(n.context,a,e,n),a.trigger("sync",a,e,n),o&&s.resolve()},n.error=function(e,t,n){c&&c.call(n.context,e,t,n),o&&s.reject(t)},Xr(this,n),r&&i&&(this.attributes=Ar({},d,r));const l=this.isNew()?"create":n.patch?"patch":"update";"patch"!==l||n.attrs||(n.attrs=r);const f=this.sync(l,this,n);return this.attributes=d,o?s:f},destroy:function(e){e=e?Oi(e):{};const t=this,n=e.success,r=e.wait,i=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(o){r&&i(),n&&n.call(e.context,t,o,e),t.isNew()||t.trigger("sync",t,o,e)};let o=!1;return this.isNew()?Mi(e.success):(Xr(this,e),o=this.sync("delete",this,e)),r||i(),o},url:function(){const e=Wr(this,"urlRoot")||Wr(this.collection,"url")||Yr();if(this.isNew())return e;const t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},Ar({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=Ar({},this.attributes,e);const n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,Ar(t,{validationError:n})),!1)}});var zo=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i};
/**
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description This is the core utilities module.
 */const Bo=hr.g.Strophe,$o={isTagEqual:function(e,t){if(e.nodeTree)return $o.isTagEqual(e.nodeTree,t);if(e instanceof Element)return Bo.isTagEqual(e,t);throw Error("isTagEqual called with value which isn't an element or Strophe.Builder instance")}},Ho=new DOMParser,qo=Ho.parseFromString("invalid","text/xml").getElementsByTagName("parsererror")[0].namespaceURI;
/**
 * Clears the specified timeout and interval.
 * @method u#clearTimers
 * @param {number} timeout - Id if the timeout to clear.
 * @param {number} interval - Id of the interval to clear.
 * @private
 * @copyright Simen Bekkhus 2016
 * @license MIT
 */
function Jo(e,t){clearTimeout(e),clearInterval(t)}
/**
 * Creates a {@link Promise} that resolves if the passed in function returns a truthy value.
 * Rejects if it throws or does not return truthy within the given max_wait.
 * @method u#waitUntil
 * @param {Function} func - The function called every check_delay,
 *  and the result of which is the resolved value of the promise.
 * @param {number} [max_wait=300] - The time to wait before rejecting the promise.
 * @param {number} [check_delay=3] - The time to wait before each invocation of {func}.
 * @returns {Promise} A promise resolved with the value of func,
 *  or rejected with the exception thrown by it or it times out.
 * @copyright Simen Bekkhus 2016
 * @license MIT
 */$o.getJIDFromURI=function(e){return e.startsWith("xmpp:")&&e.endsWith("?join")?e.replace(/^xmpp:/,"").replace(/\?join$/,""):e},$o.toStanza=function(e){const t=Ho.parseFromString(e,"text/xml");if(t.getElementsByTagNameNS(qo,"parsererror").length)throw new Error("Parser Error: "+e);return t.firstElementChild},$o.getLongestSubstring=function(e,t){return t.reduce((function(t,n){return e.startsWith(n)&&n.length>t.length?n:t}),"")},$o.prefixMentions=function(e){let t=e.get("message");return(e.get("references")||[]).sort((e,t)=>t.begin-e.begin).forEach(e=>{t=`${t.slice(0,e.begin)}@${t.slice(e.begin)}`}),t},$o.isValidJID=function(e){return"string"==typeof e&&(2===zo(e.split("@")).length&&!e.startsWith("@")&&!e.endsWith("@"))},$o.isValidMUCJID=function(e){return!e.startsWith("@")&&!e.endsWith("@")},$o.isSameBareJID=function(e,t){return"string"==typeof e&&"string"==typeof t&&Bo.getBareJidFromJid(e).toLowerCase()===Bo.getBareJidFromJid(t).toLowerCase()},$o.isSameDomain=function(e,t){return"string"==typeof e&&"string"==typeof t&&Bo.getDomainFromJid(e).toLowerCase()===Bo.getDomainFromJid(t).toLowerCase()},$o.isNewMessage=function(e){return e instanceof Element?!(fr()(`result[xmlns="${Bo.NS.MAM}"]`,e).length&&fr()(`delay[xmlns="${Bo.NS.DELAY}"]`,e).length):(e instanceof Uo&&(e=e.attributes),!(e.is_delayed&&e.is_archived))},$o.shouldCreateMessage=function(e){return e.retracted||!$o.isEmptyMessage(e)},$o.shouldCreateGroupchatMessage=function(e){return e.nick&&($o.shouldCreateMessage(e)||e.is_tombstone)},$o.isEmptyMessage=function(e){return e instanceof Uo&&(e=e.attributes),!(e.oob_url||e.file||e.is_encrypted&&e.plaintext||e.message)},$o.isOnlyChatStateNotification=function(e){return e instanceof Element?null===e.querySelector("body")&&(null!==e.querySelector("active")||null!==e.querySelector("composing")||null!==e.querySelector("inactive")||null!==e.querySelector("paused")||null!==e.querySelector("gone")):(e instanceof Uo&&(e=e.attributes),e.chat_state&&$o.isEmptyMessage(e))},$o.isOnlyMessageDeliveryReceipt=function(e){return e instanceof Element?null===e.querySelector("body")&&null!==e.querySelector("received"):(e instanceof Uo&&(e=e.attributes),e.received&&$o.isEmptyMessage(e))},$o.isChatRoom=function(e){return e&&"chatroom"===e.get("type")},$o.isErrorObject=function(e){return e instanceof Error},$o.isErrorStanza=function(e){return!!In(e)&&"error"===e.getAttribute("type")},$o.isForbiddenError=function(e){return!!In(e)&&fr()(`error[type="auth"] forbidden[xmlns="${Bo.NS.STANZAS}"]`,e).length>0},$o.isServiceUnavailableError=function(e){return!!In(e)&&fr()(`error[type="cancel"] service-unavailable[xmlns="${Bo.NS.STANZAS}"]`,e).length>0},$o.merge=function e(t,n){for(const r in n)j(t[r])?e(t[r],n[r]):t[r]=n[r]},$o.getOuterWidth=function(e,t=!1){let n=e.offsetWidth;if(!t)return n;const r=window.getComputedStyle(e);return n+=parseInt(r.marginLeft?r.marginLeft:0,10)+parseInt(r.marginRight?r.marginRight:0,10),n},$o.stringToElement=function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild},$o.matchesSelector=function(e,t){const n=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector;return!!n&&n.call(e,t)},$o.queryChildren=function(e,t){return Array.from(e.childNodes).filter(e=>$o.matchesSelector(e,t))},$o.contains=function(e,t){const n=(e,n)=>e.get(n).toLowerCase().includes(t.toLowerCase());return function(t){if("object"==typeof e)return Object.keys(e).reduce((e,r)=>e||n(t,r),!1);if("string"==typeof e)return n(t,e);throw new TypeError("contains: wrong attribute type. Must be string or array.")}},$o.isOfType=function(e,t){return t.get("type")==e},$o.isInstance=function(e,t){return t instanceof e},$o.getAttribute=function(e,t){return t.get(e)},$o.contains.not=function(e,t){return function(n){return!$o.contains(e,t)(n)}},$o.rootContains=function(e,t){return e!==document||e.contains?e.contains?e.contains(t):window.HTMLElement.prototype.contains.call(e,t):document.head.contains(t)||document.body.contains(t)},$o.createFragmentFromText=function(e){var t,n=document.createDocumentFragment(),r=document.createElement("body");for(r.innerHTML=e;t=r.firstChild;)n.appendChild(t);return n},$o.isPersistableModel=function(e){return e.collection&&e.collection.browserStorage},$o.getResolveablePromise=function(){const e={isResolved:!1,isPending:!0,isRejected:!1},t=new Promise((t,n)=>{e.resolve=t,e.reject=n});return Object.assign(t,e),t.then((function(e){return t.isResolved=!0,t.isPending=!1,t.isRejected=!1,e}),(function(e){throw t.isResolved=!1,t.isPending=!1,t.isRejected=!0,e})),t},$o.interpolate=function(e,t){return e.replace(/{{{([^{}]*)}}}/g,(e,n)=>{var r=t[n];return"string"==typeof r||"number"==typeof r?r:e})},$o.onMultipleEvents=function(e=[],t){let n=[];function r(r){n.push(r),e.length===n.length&&(t(n),n=[])}e.forEach(e=>e.object.on(e.event,r))},$o.safeSave=function(e,t,n){$o.isPersistableModel(e)?e.save(t,n):e.set(t,n)},$o.siblingIndex=function(e){for(var t=0;e=e.previousElementSibling;t++);return t},$o.getCurrentWord=function(e,t,n){t||(t=e.selectionEnd||void 0);let[r]=e.value.slice(0,t).split(/\s/).slice(-1);return n&&([r]=r.split(n).slice(-1)),r},$o.replaceCurrentWord=function(e,t){const n=e.selectionEnd||void 0,r=Eo(e.value.slice(0,n).split(" ")),i=e.value;e.value=i.slice(0,n-r.length)+(t+" ")+i.slice(n),e.selectionEnd=n-r.length+t.length+1},$o.triggerEvent=function(e,t,n="Event",r=!0,i=!0){const o=document.createEvent(n);o.initEvent(t,r,i),e.dispatchEvent(o)},$o.getSelectValues=function(e){const t=[],n=e&&e.options;for(var r=0,i=n.length;r<i;r++){const e=n[r];e.selected&&t.push(e.value||e.text)}return t},$o.formatFingerprint=function(e){e=e.replace(/^05/,"");for(let t=1;t<8;t++){const n=8*t+t-1;e=e.slice(0,n)+" "+e.slice(n)}return e},$o.appendArrayBuffer=function(e,t){const n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},$o.arrayBufferToHex=function(e){return Array.prototype.map.call(new Uint8Array(e),e=>("00"+e.toString(16)).slice(-2)).join("")},$o.arrayBufferToString=function(e){return new TextDecoder("utf-8").decode(e)},$o.stringToArrayBuffer=function(e){return new TextEncoder("utf-8").encode(e).buffer},$o.arrayBufferToBase64=function(e){return btoa(new Uint8Array(e).reduce((e,t)=>e+String.fromCharCode(t),""))},$o.base64ToArrayBuffer=function(e){const t=window.atob(e),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return r.buffer},$o.getRandomInt=function(e){return Math.floor(Math.random()*Math.floor(e))},$o.placeCaretAtEnd=function(e){e!==document.activeElement&&e.focus();const t=2*e.value.length;setTimeout(()=>e.setSelectionRange(t,t),1),this.scrollTop=999999},$o.getUniqueId=function(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));return"string"==typeof e||"number"==typeof e?t+":"+e:t},$o.waitUntil=function(e,t=300,n=3){try{const t=e();if(t)return Promise.resolve(t)}catch(e){return Promise.reject(e)}const r=$o.getResolveablePromise(),i=new Error;const o=setInterval((function(){try{const t=e();t&&(Jo(s,o),r.resolve(t))}catch(e){Jo(s,o),r.reject(e)}}),n);const s=setTimeout((function(){Jo(s,o);const e="Wait until promise timed out: \n\n"+i.stack;console.trace(),kn.error(e),r.reject(new Error(e))}),t);return r};var Wo=$o;const Vo=hr.g.Strophe,Go=hr.g.$msg,{NS:Yo}=Vo;function Xo(e){const t=fr()(`spoiler[xmlns="${Vo.NS.SPOILER}"]`,e).pop();return{is_spoiler:!!t,spoiler_hint:null==t?void 0:t.textContent}}function Qo(e){const t=fr()(`x[xmlns="${Vo.NS.OUTOFBAND}"]`,e).pop();var n,r;return t?{oob_url:null===(n=t.querySelector("url"))||void 0===n?void 0:n.textContent,oob_desc:null===(r=t.querySelector("desc"))||void 0===r?void 0:r.textContent}:{}}function Ko(e,t){const n=fr()(`replace[xmlns="${Vo.NS.MESSAGE_CORRECT}"]`,e).pop();if(n){const e=n.getAttribute("id"),r=e;if(e){const n=fr()(`delay[xmlns="${Vo.NS.DELAY}"]`,t).pop();return{msgid:r,replace_id:e,edited:n?bn()(n.getAttribute("stamp")).toISOString():(new Date).toISOString()}}}return{}}function Zo(e,t){var n;const r=fr()(`encrypted[xmlns="${Vo.NS.OMEMO}"]`,e).pop(),i={is_encrypted:!!r};if(!r||zu.settings.get("clear_cache_on_logout"))return i;const o=r.querySelector("header");i.encrypted={device_id:o.getAttribute("sid")};const s=null===(n=t.omemo_store)||void 0===n?void 0:n.get("device_id"),a=s&&fr()(`key[rid="${s}"]`,r).pop();var u;a&&Object.assign(i.encrypted,{iv:o.querySelector("iv").textContent,key:a.textContent,payload:(null===(u=r.querySelector("payload"))||void 0===u?void 0:u.textContent)||null,prekey:["true","1"].includes(a.getAttribute("prekey"))});return i}function es(e,t){return"me"!==t.sender&&!t.is_carbon&&!t.is_archived&&fr()(`request[xmlns="${Vo.NS.RECEIPTS}"]`,e).length}function ts(e){const t=fr()(`received[xmlns="${Vo.NS.RECEIPTS}"]`,e).pop();return null==t?void 0:t.getAttribute("id")}function ns(e){var t;return null===(t=fr()(`\n        composing[xmlns="${Yo.CHATSTATES}"],\n        paused[xmlns="${Yo.CHATSTATES}"],\n        inactive[xmlns="${Yo.CHATSTATES}"],\n        active[xmlns="${Yo.CHATSTATES}"],\n        gone[xmlns="${Yo.CHATSTATES}"]`,e).pop())||void 0===t?void 0:t.nodeName}function rs(e){const t=Vo.NS.CARBONS;return fr()(`message > received[xmlns="${t}"]`,e).length>0||fr()(`message > sent[xmlns="${t}"]`,e).length>0}function is(e,t){const n={},r=fr()(`stanza-id[xmlns="${Vo.NS.SID}"]`,e).reduce((e,t)=>(e["stanza_id "+t.getAttribute("by")]=t.getAttribute("id"),e),{});Object.assign(n,r);const i=fr()(`message > result[xmlns="${Vo.NS.MAM}"]`,t).pop();if(i){n["stanza_id "+(t.getAttribute("from")||Pu.bare_jid)]=i.getAttribute("id")}const o=fr()(`origin-id[xmlns="${Vo.NS.SID}"]`,e).pop();return o&&(n.origin_id=o.getAttribute("id")),n}function os(e,t){const n=fr()(`> apply-to[xmlns="${Vo.NS.FASTEN}"]`,e).pop();if(n){const e=n.getAttribute("id");if(fr()(`> retract[xmlns="${Vo.NS.RETRACT}"]`,n).pop()){const n=fr()(`delay[xmlns="${Vo.NS.DELAY}"]`,t).pop();return{editable:!1,retracted:n?bn()(n.getAttribute("stamp")).toISOString():(new Date).toISOString(),retracted_id:e}}}else{const t=fr()(`> retracted[xmlns="${Vo.NS.RETRACT}"]`,e).pop();if(t)return{editable:!1,is_tombstone:!0,retracted:t.getAttribute("stamp")}}return{}}function ss(e){var t;const n=null===(t=e.querySelector("body"))||void 0===t?void 0:t.textContent;return fr()(`reference[xmlns="${Vo.NS.REFERENCE}"]`,e).map(e=>{const t=e.getAttribute("begin"),r=e.getAttribute("end");return{begin:t,end:r,type:e.getAttribute("type"),value:n.slice(t,r),uri:e.getAttribute("uri")}})}function as(e,t){zu.send(Go({to:e.getAttribute("from"),type:"error",id:e.getAttribute("id")}).c("error",{type:"cancel"}).c("not-allowed",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("text",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).t(t)),kn.warn("Rejecting message stanza with the following reason: "+t),kn.warn(e)}function us(e){if("error"===e.getAttribute("type")){const t=e.querySelector("error"),n=fr()(`text[xmlns="${Vo.NS.STANZAS}"]`,t).pop();return{is_error:!0,error_text:null==n?void 0:n.textContent,error_type:t.getAttribute("type"),error_condition:t.firstElementChild.nodeName}}return{}}class cs extends Error{constructor(e,t){super(e,t),this.name="StanzaParseError",this.stanza=t}}function ds(e){if(fr()(`message > forwarded[xmlns="${Vo.NS.FORWARD}"]`,e).length){as(e,"Forwarded messages not part of an encapsulating protocol are not supported");const t=e.getAttribute("from");return new cs("Ignoring unencapsulated forwarded message from "+t,e)}}const ls={isHeadline:e=>"headline"===e.getAttribute("type"),isServerMessage(e){const t=e.getAttribute("from");return!("error"===e.getAttribute("type")||!t||t.includes("@"))},getChatMarker:e=>fr()(`\n            acknowledged[xmlns="${Vo.NS.MARKERS}"],\n            displayed[xmlns="${Vo.NS.MARKERS}"],\n            received[xmlns="${Vo.NS.MARKERS}"]`,e).pop(),isArchived:e=>!!fr()(`message > result[xmlns="${Vo.NS.MAM}"]`,e).pop(),getAttributes:e=>e.getAttributeNames().reduce((t,n)=>(t[n]=Vo.xmlunescape(e.getAttribute(n)),t),{}),async parseMessage(e,t){var n,r,i,o,s,a;const u=ds(e);if(u)return u;let c=e.getAttribute("to");const d=Vo.getResourceFromJid(c);if(zu.settings.get("filter_by_resource")&&d&&d!==t.resource)return new cs("Ignoring incoming message intended for a different resource: "+c,e);const l=e;let f=e.getAttribute("from")||t.bare_jid;if(rs(e)){if(f!==t.bare_jid)return as(e,"Rejecting carbon from invalid JID"),new cs("Rejecting carbon from invalid JID "+c,e);{const t=`[xmlns="${Vo.NS.CARBONS}"] > forwarded[xmlns="${Vo.NS.FORWARD}"] > message`;c=(e=fr()(t,e).pop()).getAttribute("to"),f=e.getAttribute("from")}}const h=ls.isArchived(e);if(h){if(f!==t.bare_jid)return new cs("Invalid Stanza: alleged MAM message from "+e.getAttribute("from"),e);{const t=`[xmlns="${Vo.NS.MAM}"] > forwarded[xmlns="${Vo.NS.FORWARD}"] > message`;c=(e=fr()(t,e).pop()).getAttribute("to"),f=e.getAttribute("from")}}const p=Vo.getBareJidFromJid(f),g=p===t.bare_jid;if(g&&null===c)return new cs("Don't know how to handle message stanza without 'to' attribute. "+e.outerHTML,e);const m=ls.isHeadline(e),v=ls.isServerMessage(e);let _,y;if(!m&&!v&&(y=g?Vo.getBareJidFromJid(c):p,_=await zu.contacts.get(y),void 0===_&&!zu.settings.get("allow_non_roster_messaging")))return kn.error(e),new cs("Blocking messaging with a JID not in our roster because allow_non_roster_messaging is false.",e);const b=fr()(`delay[xmlns="${Vo.NS.DELAY}"]`,l).pop(),w=ls.getChatMarker(e),S=(new Date).toISOString();let x=Object.assign({contact_jid:y,is_archived:h,is_headline:m,is_server_message:v,body:null===(n=e.querySelector("body"))||void 0===n||null===(r=n.textContent)||void 0===r?void 0:r.trim(),chat_state:ns(e),from:Vo.getBareJidFromJid(e.getAttribute("from")),is_carbon:rs(l),is_delayed:!!b,is_markable:!!fr()(`markable[xmlns="${Vo.NS.MARKERS}"]`,e).length,is_marker:!!w,marker_id:w&&w.getAttribute("id"),msgid:e.getAttribute("id")||l.getAttribute("id"),nick:null===(i=_)||void 0===i||null===(o=i.attributes)||void 0===o?void 0:o.nickname,receipt_id:ts(e),received:(new Date).toISOString(),references:ss(e),sender:g?"me":"them",subject:null===(s=e.querySelector("subject"))||void 0===s?void 0:s.textContent,thread:null===(a=e.querySelector("thread"))||void 0===a?void 0:a.textContent,time:b?bn()(b.getAttribute("stamp")).toISOString():S,to:e.getAttribute("to"),type:e.getAttribute("type")},us(e),Qo(e),Xo(e),Ko(e,l),is(e,l),os(e,l),Zo(e,t));if(x.is_archived){const n=l.getAttribute("from");if(n&&n!==t.bare_jid)return new cs("Invalid Stanza: Forged MAM message from "+n,e)}return await zu.emojis.initialize(),x=Object.assign({message:x.body||x.error,is_only_emojis:!!x.body&&Wo.isOnlyEmojis(x.body),is_valid_receipt_request:es(e,x)},x),x.id=x.origin_id||x["stanza_id "+x.from]||Wo.getUniqueId(),zu.hook("parseMessage",e,x)},async parseMUCMessage(e,t,n){var r,i,o,s,a;const u=ds(e);if(u)return u;const c=`[xmlns="${Yo.MAM}"] > forwarded[xmlns="${Yo.FORWARD}"] > message`,d=e;if(e=fr()(c,e).pop()||e,fr()(`message > forwarded[xmlns="${Vo.NS.FORWARD}"]`,e).length)return new cs("Invalid Stanza: Forged MAM groupchat message from "+e.getAttribute("from"),e);const l=fr()(`delay[xmlns="${Vo.NS.DELAY}"]`,d).pop(),f=e.getAttribute("from"),h=Vo.unescapeNode(Vo.getResourceFromJid(f)),p=ls.getChatMarker(e),g=(new Date).toISOString();let m=Object.assign({from:f,nick:h,body:null===(r=e.querySelector("body"))||void 0===r||null===(i=r.textContent)||void 0===i?void 0:i.trim(),chat_state:ns(e),from_muc:Vo.getBareJidFromJid(f),from_real_jid:null===(o=t.occupants.findOccupant({nick:h}))||void 0===o?void 0:o.get("jid"),is_archived:ls.isArchived(d),is_carbon:rs(d),is_delayed:!!l,is_headline:ls.isHeadline(e),is_markable:!!fr()(`markable[xmlns="${Vo.NS.MARKERS}"]`,e).length,is_marker:!!p,marker_id:p&&p.getAttribute("id"),msgid:e.getAttribute("id")||d.getAttribute("id"),receipt_id:ts(e),received:(new Date).toISOString(),references:ss(e),subject:null===(s=e.querySelector("subject"))||void 0===s?void 0:s.textContent,thread:null===(a=e.querySelector("thread"))||void 0===a?void 0:a.textContent,time:l?bn()(l.getAttribute("stamp")).toISOString():g,to:e.getAttribute("to"),type:e.getAttribute("type")},us(e),Qo(e),Xo(e),Ko(e,d),is(e,d),os(e,d),function(e){const t=fr()(`apply-to[xmlns="${Vo.NS.FASTEN}"]`,e).pop();if(t){const e=t.getAttribute("id"),r=fr()(`moderated[xmlns="${Vo.NS.MODERATE}"]`,t).pop();if(r){var n;if(fr()(`retract[xmlns="${Vo.NS.RETRACT}"]`,r).pop())return{editable:!1,moderated:"retracted",moderated_by:r.getAttribute("by"),moderated_id:e,moderation_reason:null===(n=r.querySelector("reason"))||void 0===n?void 0:n.textContent}}}else{const t=fr()(`> moderated[xmlns="${Vo.NS.MODERATE}"]`,e).pop();if(t){var r;if(fr()(`retracted[xmlns="${Vo.NS.RETRACT}"]`,t).pop())return{editable:!1,is_tombstone:!0,moderated_by:t.getAttribute("by"),retracted:t.getAttribute("stamp"),moderation_reason:null===(r=t.querySelector("reason"))||void 0===r?void 0:r.textContent}}}return{}}(e),Zo(e,n));return await zu.emojis.initialize(),m=Object.assign({is_only_emojis:!!m.body&&Wo.isOnlyEmojis(m.body),is_valid_receipt_request:es(e,m),message:m.body||m.error,sender:m.nick===t.get("nick")?"me":"them"},m),m.is_archived&&d.getAttribute("from")!==m.from_muc?new cs("Invalid Stanza: Forged MAM message from "+d.getAttribute("from"),e):m.is_archived&&d.getAttribute("from")!==t.get("jid")?new cs("Invalid Stanza: Forged MAM groupchat message from "+e.getAttribute("from"),e):m.is_carbon?new cs("Invalid Stanza: MUC messages SHOULD NOT be XEP-0280 carbon copied",e):(m.id=m.origin_id||m["stanza_id "+(m.from_muc||m.from)]||Wo.getUniqueId(),zu.hook("parseMUCMessage",e,m))},parseMUCPresence(e){const t=e.getAttribute("from"),n=e.getAttribute("type"),r={from:t,nick:Vo.getResourceFromJid(t),type:n,states:[],hats:[],show:"unavailable"!==n?"online":"offline"};return Array.from(e.children).forEach(e=>{if(e.matches("status"))r.status=e.textContent||null;else if(e.matches("show"))r.show=e.textContent||"online";else if(e.matches("x")&&e.getAttribute("xmlns")===Vo.NS.MUC_USER)Array.from(e.children).forEach(e=>{"item"===e.nodeName?(r.affiliation=e.getAttribute("affiliation"),r.role=e.getAttribute("role"),r.jid=e.getAttribute("jid"),r.nick=e.getAttribute("nick")||r.nick):"status"==e.nodeName&&e.getAttribute("code")&&r.states.push(e.getAttribute("code"))});else if(e.matches("x")&&e.getAttribute("xmlns")===Vo.NS.VCARDUPDATE){var t;r.image_hash=null===(t=e.querySelector("photo"))||void 0===t?void 0:t.textContent}else e.matches("hats")&&e.getAttribute("xmlns")===Vo.NS.MUC_HATS&&(r.hats=Array.from(e.children).map(e=>e.matches("hat")&&{title:e.getAttribute("title"),uri:e.getAttribute("uri")}))}),r}};var fs=ls;var hs=function(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r};var ps=function(e,t){return function(n,r){if(null==n)return n;if(!Ve(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=Object(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}(Ui);var gs=function(e,t,n,r){return ps(e,(function(e,i,o){t(r,e,n(e),o)})),r};var ms=function(e,t){return function(n,r){var i=Oe(n)?hs:gs,o=t?t():{};return i(n,e,So(r,2),o)}},vs=Object.prototype.hasOwnProperty,_s=ms((function(e,t,n){vs.call(e,n)?++e[n]:ve(e,n,1)}));var ys=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1};var bs=function(e){return e!=e};var ws=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1};var Ss=function(e,t,n){return t==t?ws(e,t,n):ys(e,bs,n)};var xs=function(e,t){return!!(null==e?0:e.length)&&Ss(e,t,0)>-1};var Es=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1};var As=function(e,t,n,r){var i=-1,o=xs,s=!0,a=e.length,u=[],c=t.length;if(!a)return u;n&&(t=Fr(t,De(n))),r?(o=Es,s=!1):t.length>=200&&(o=Yi,s=!1,t=new Vi(t));e:for(;++i<a;){var d=e[i],l=null==n?d:n(d);if(d=r||0!==d?d:0,s&&l==l){for(var f=c;f--;)if(t[f]===l)continue e;u.push(d)}else o(t,l,r)||u.push(d)}return u};var Ns=function(e){return Se(e)&&Ve(e)},Ts=xr((function(e,t){return Ns(e)?As(e,Io(t,1,Ns,!0)):[]}));var Os=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0};var js=function(e,t){var n=!0;return ps(e,(function(e,r,i){return n=!!t(e,r,i)})),n};var Cs=function(e,t,n){var r=Oe(e)?Os:js;return n&&Er(e,t,n)&&(t=void 0),r(e,So(t,3))},Is=Math.max;var Rs=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:fi(n);return i<0&&(i=Is(r+i,0)),ys(e,So(t,3),i)},Ms=Math.max,ks=Math.min;var Ds=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=fi(n),i=n<0?Ms(r+i,0):ks(i,r-1)),ys(e,So(t,3),i,!0)},Ps=Object.prototype.hasOwnProperty,Fs=ms((function(e,t,n){Ps.call(e,n)?e[n].push(t):ve(e,n,[t])})),Ls=Math.max;var Us=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:fi(n);return i<0&&(i=Ls(r+i,0)),Ss(e,t,i)},zs=ms((function(e,t,n){ve(e,n,t)}));var Bs=function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r},$s=Math.max,Hs=Math.min;var qs=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=fi(n))<0?$s(r+i,0):Hs(i,r-1)),t==t?Bs(e,t,i):ys(e,bs,i,!0)};var Js=function(e,t){var n;return ps(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n};var Ws=function(e,t,n){var r=Oe(e)?Gi:Js;return n&&Er(e,t,n)&&(t=void 0),r(e,So(t,3))};var Vs=function(e,t){var n=-1,r=Ve(e)?Array(e.length):[];return ps(e,(function(e,i,o){r[++n]=t(e,i,o)})),r};var Gs=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e};var Ys=function(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=Or(e),s=void 0!==t,a=null===t,u=t==t,c=Or(t);if(!a&&!c&&!o&&e>t||o&&s&&u&&!a&&!c||r&&s&&u||!n&&u||!i)return 1;if(!r&&!o&&!c&&e<t||c&&n&&i&&!r&&!o||a&&n&&i||!s&&i||!u)return-1}return 0};var Xs=function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;++r<s;){var u=Ys(i[r],o[r]);if(u)return r>=a?u:u*("desc"==n[r]?-1:1)}return e.index-t.index};var Qs=function(e,t,n){t=t.length?Fr(t,(function(e){return Oe(e)?function(t){return po(t,1===e.length?e[0]:e)}:e})):[gr];var r=-1;t=Fr(t,De(So));var i=Vs(e,(function(e,n,i){return{criteria:Fr(t,(function(t){return t(e)})),index:++r,value:e}}));return Gs(i,(function(e,t){return Xs(e,t,n)}))},Ks=xr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&Er(e,t[0],t[1])?t=[]:n>2&&Er(t[0],t[1],t[2])&&(t=[t[0]]),Qs(e,Io(t,1),[])}));const Zs=Array.prototype.slice,ea=function(e,t){t||(t={}),this.preinitialize.apply(this,arguments),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,Ar({silent:!0},t))};ea.extend=Vr;const ta={add:!0,remove:!0,merge:!0},na={add:!0,remove:!1},ra=function(e,t,n){n=Math.min(Math.max(n,0),e.length);const r=Array(e.length-n),i=t.length;let o;for(o=0;o<r.length;o++)r[o]=e[o+n];for(o=0;o<i;o++)e[o+n]=t[o];for(o=0;o<r.length;o++)e[o+i+n]=r[o]};Object.assign(ea.prototype,vi,{model:Uo,preinitialize:function(){},initialize:function(){},toJSON:function(e){return this.map((function(t){return t.toJSON(e)}))},sync:function(e,t,n){return Kr(this)(e,t,n)},add:function(e,t){return this.set(e,Ar({merge:!1},t,na))},remove:function(e,t){t=Ar({},t);const n=!Array.isArray(e);e=n?[e]:e.slice();const r=this._removeModels(e,t);return!t.silent&&r.length&&(t.changes={added:[],merged:[],removed:r},this.trigger("update",this,t)),n?r[0]:r},set:function(e,t){if(null==e)return;(t=Ar({},ta,t)).parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);const n=!Array.isArray(e);e=n?[e]:e.slice();let r=t.at;null!=r&&(r=+r),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);const i=[],o=[],s=[],a=[],u={},c=t.add,d=t.merge,l=t.remove;let f=!1;const h=this.comparator&&null==r&&!1!==t.sort,p=Qt(this.comparator)?this.comparator:null;let g,m;for(m=0;m<e.length;m++){g=e[m];const n=this.get(g);if(n){if(d&&g!==n){let e=this._isModel(g)?g.attributes:g;t.parse&&(e=n.parse(e,t)),n.set(e,t),s.push(n),h&&!f&&(f=n.hasChanged(p))}u[n.cid]||(u[n.cid]=!0,i.push(n)),e[m]=n}else c&&(g=e[m]=this._prepareModel(g,t),g&&(o.push(g),this._addReference(g,t),u[g.cid]=!0,i.push(g)))}if(l){for(m=0;m<this.length;m++)g=this.models[m],u[g.cid]||a.push(g);a.length&&this._removeModels(a,t)}let v=!1;const _=!h&&c&&l;if(i.length&&_?(v=this.length!==i.length||Ws(this.models,(e,t)=>e!==i[t]),this.models.length=0,ra(this.models,i,0),this.length=this.models.length):o.length&&(h&&(f=!0),ra(this.models,o,null==r?this.length:r),this.length=this.models.length),f&&this.sort({silent:!0}),!t.silent){for(m=0;m<o.length;m++)null!=r&&(t.index=r+m),g=o[m],g.trigger("add",g,this,t);(f||v)&&this.trigger("sort",this,t),(o.length||a.length||s.length)&&(t.changes={added:o,removed:a,merged:s},this.trigger("update",this,t))}return n?e[0]:e},clearStore:async function(e={},t=(e=>e)){await Promise.all(this.models.filter(t).map(t=>new Promise(n=>{t.destroy(Object.assign(e,{success:n,error:(e,t)=>{console.error(t),n()}}))}))),await this.browserStorage.clear(),this.reset()},reset:function(e,t){t=t?Oi(t):{};for(let e=0;e<this.models.length;e++)this._removeReference(this.models[e],t);return t.previousModels=this.models,this._reset(),e=this.add(e,Ar({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,Ar({at:this.length},t))},pop:function(e){const t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,Ar({at:0},t))},shift:function(e){const t=this.at(0);return this.remove(t,e)},slice:function(){return Zs.apply(this.models,arguments)},filter:function(e,t){return this.models.filter(I(e)?e:t=>t.matches(e),t)},every:function(e){return Cs(this.models.map(e=>e.attributes),e)},difference:function(e){return Ts(this.models,e)},max:function(){return Math.max.apply(Math,this.models)},min:function(){return Math.min.apply(Math,this.models)},drop:function(e=1){return this.models.slice(e)},some:function(e){return Ws(this.models.map(e=>e.attributes),e)},sortBy:function(e){return Ks(this.models,I(e)?e:t=>Qt(e)?t.get(e):t.matches(e))},isEmpty:function(){return ti(this.models)},keyBy:function(e){return zs(this.models,e)},each:function(e,t){return this.forEach(e,t)},forEach:function(e,t){return this.models.forEach(e,t)},includes:function(e){return this.models.includes(e)},size:function(){return this.models.length},countBy:function(e){return _s(this.models,I(e)?e:t=>Qt(e)?t.get(e):t.matches(e))},groupBy:function(e){return Fs(this.models,I(e)?e:t=>Qt(e)?t.get(e):t.matches(e))},indexOf:function(e){return Us(this.models,e)},findLastIndex:function(e,t){return Ds(this.models,I(e)?e:t=>Qt(e)?t.get(e):t.matches(e),t)},lastIndexOf:function(e){return qs(this.models,e)},findIndex:function(e){return Rs(this.models,I(e)?e:t=>Qt(e)?t.get(e):t.matches(e))},last:function(){const e=null==this.models?0:this.models.length;return e?this.models[e-1]:void 0},head:function(){return this.models[0]},first:function(){return this.head()},map:function(e,t){return this.models.map(I(e)?e:t=>Qt(e)?t.get(e):t.matches(e),t)},reduce:function(e,t){return this.models.reduce(e,t||this.models[0])},reduceRight:function(e,t){return this.models.reduceRight(e,t||this.models[0])},toArray:function(){return Array.from(this.models)},get:function(e){if(null!=e)return this._byId[e]||this._byId[this.modelId(this._isModel(e)?e.attributes:e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},find:function(e,t){const n=I(e)?e:t=>t.matches(e);return this.models.find(n,t)},sort:function(e){let t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});const n=t.length;return I(t)&&(t=t.bind(this)),1===n||Qt(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){const t=(e=Ar({parse:!0},e)).success,n=this,r=e.promise&&Gr();return e.success=function(i){const o=e.reset?"reset":"set";n[o](i,e),t&&t.call(e.context,n,i,e),r&&r.resolve(),n.trigger("sync",n,i,e)},Xr(this,e),r||this.sync("read",this,e)},create:function(e,t){const n=(t=t?Oi(t):{}).wait,r=t.promise,i=r&&Gr();if(!(e=this._prepareModel(e,t)))return!1;n||this.add(e,t);const o=this,s=t.success,a=t.error;return t.success=function(e,t,a){n&&o.add(e,a),s&&s.call(a.context,e,t,a),r&&i.resolve(e)},t.error=function(e,t,n){a&&a.call(n.context,e,t,n),r&&i.reject(t)},e.save(null,Object.assign(t,{promise:!1})),r?i:e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},values:function(){return new oa(this,sa)},keys:function(){return new oa(this,aa)},entries:function(){return new oa(this,ua)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;(t=t?Oi(t):{}).collection=this;const n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_removeModels:function(e,t){const n=[];for(let r=0;r<e.length;r++){const i=this.get(e[r]);if(!i)continue;const o=this.indexOf(i);this.models.splice(o,1),this.length--,delete this._byId[i.cid];const s=this.modelId(i.attributes);null!=s&&delete this._byId[s],t.silent||(t.index=o,i.trigger("remove",i,this,t)),n.push(i),this._removeReference(i,t)}return n},_isModel:function(e){return e instanceof Uo},_addReference:function(e,t){this._byId[e.cid]=e;const n=this.modelId(e.attributes);null!=n&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];const n=this.modelId(e.attributes);null!=n&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if(t){if(("add"===e||"remove"===e)&&n!==this)return;if("destroy"===e&&this.remove(t,r),"change"===e){const e=this.modelId(t.previousAttributes()),n=this.modelId(t.attributes);e!==n&&(null!=e&&delete this._byId[e],null!=n&&(this._byId[n]=t))}}this.trigger.apply(this,arguments)}});const ia="function"==typeof Symbol&&Symbol.iterator;ia&&(ea.prototype[ia]=ea.prototype.values);const oa=function(e,t){this._collection=e,this._kind=t,this._index=0},sa=1,aa=2,ua=3;ia&&(oa.prototype[ia]=function(){return this}),oa.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){const e=this._collection.at(this._index);let t;if(this._index++,this._kind===sa)t=e;else{const n=this._collection.modelId(e.attributes);t=this._kind===aa?n:[n,e]}return{value:t,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var ca=n(54);class da extends hr.f.Connection{constructor(e,t){super(e,t),this.debouncedReconnect=Object(ca.debounce)(this.reconnect,2e3)}static generateResource(){return"/converse.js-"+Math.floor(139749528*Math.random()).toString()}async bind(){await zu.trigger("beforeResourceBinding",{synchronous:!0}),super.bind()}async onDomainDiscovered(e){const t=await e.text(),n=(new window.DOMParser).parseFromString(t,"text/xml").firstElementChild;if("XRD"!=n.nodeName||"http://docs.oasis-open.org/ns/xri/xrd-1.0"!=n.namespaceURI)return kn.warn("Could not discover XEP-0156 connection methods");const r=fr()('Link[rel="urn:xmpp:alt-connections:xbosh"]',n),i=fr()('Link[rel="urn:xmpp:alt-connections:websocket"]',n),o=r.map(e=>e.getAttribute("href")),s=i.map(e=>e.getAttribute("href"));0===o.length&&0===s.length?kn.warn("Neither BOSH nor WebSocket connection methods have been specified with XEP-0156."):(zu.settings.set("websocket_url",s.pop()),zu.settings.set("bosh_service_url",o.pop()),this.service=zu.settings.get("websocket_url")||zu.settings.get("bosh_service_url"),this.setProtocol())}async discoverConnectionMethods(e){const t={mode:"cors",headers:{Accept:"application/xrd+xml, text/xml"}},n=`https://${e}/.well-known/host-meta`;let r;try{r=await fetch(n,t)}catch(e){return kn.error("Failed to discover alternative connection methods at "+n),void kn.error(e)}r.status>=200&&r.status<400?await this.onDomainDiscovered(r):kn.warn("Could not discover XEP-0156 connection methods")}async connect(e,t,n){if(zu.settings.get("discover_connection_methods")){const t=hr.f.getDomainFromJid(e);await this.discoverConnectionMethods(t)}super.connect(e,t,n||this.onConnectStatusChanged,59)}async reconnect(){const{__:e}=Pu;return kn.debug("RECONNECTING: the connection has dropped, attempting to reconnect."),this.setConnectionStatus(hr.f.Status.RECONNECTING,e("The connection has dropped, attempting to reconnect.")),zu.trigger("will-reconnect"),this.reconnecting=!0,await Hu(),zu.user.login()}async onConnected(e){delete this.reconnecting,this.flush(),await Pu.setUserJID(this.jid),await zu.trigger("afterResourceBinding",e,{synchronous:!0}),e?zu.trigger("reconnected"):zu.trigger("connected")}setDisconnectionCause(e,t,n){void 0===e?(delete this.disconnection_cause,delete this.disconnection_reason):(void 0===this.disconnection_cause||n)&&(this.disconnection_cause=e,this.disconnection_reason=t)}setConnectionStatus(e,t){this.status=e,Pu.connfeedback.set({connection_status:e,message:t})}async finishDisconnection(){kn.debug("DISCONNECTED"),delete this.reconnecting,this.reset(),Hu(),await Ju(),delete Pu.connection,zu.trigger("disconnected")}onDisconnected(){if(!zu.settings.get("auto_reconnect"))return this.finishDisconnection();{const e=this.disconnection_reason;if(this.disconnection_cause===hr.f.Status.AUTHFAIL)return zu.settings.get("credentials_url")||zu.settings.get("authentication")===Pu.ANONYMOUS?zu.connection.reconnect():this.finishDisconnection();if(this.disconnection_cause===Pu.LOGOUT||e===hr.f.ErrorCondition.NO_AUTH_MECH||"host-unknown"===e||"remote-connection-failed"===e)return this.finishDisconnection();zu.connection.reconnect()}}onConnectStatusChanged(e,t){const{__:n}=Pu;var r;if(kn.debug("Status changed to: "+Pu.CONNECTION_STATUS[e]),e===hr.f.Status.ATTACHFAIL)this.setConnectionStatus(e),null===(r=this.worker_attach_promise)||void 0===r||r.resolve(!1);else if(e===hr.f.Status.CONNECTED||e===hr.f.Status.ATTACHED){var i,o;if(null!==(i=this.worker_attach_promise)&&void 0!==i&&i.isResolved&&this.status===hr.f.Status.ATTACHED)return;this.setConnectionStatus(e),null===(o=this.worker_attach_promise)||void 0===o||o.resolve(!0),Pu.send_initial_presence=!0,this.setDisconnectionCause(),this.reconnecting?(kn.debug(e===hr.f.Status.CONNECTED?"Reconnected":"Reattached"),this.onConnected(!0)):(kn.debug(e===hr.f.Status.CONNECTED?"Connected":"Attached"),this.restored&&(Pu.send_initial_presence=!1),this.onConnected())}else if(e===hr.f.Status.DISCONNECTED)this.setDisconnectionCause(e,t),this.onDisconnected();else if(e===hr.f.Status.BINDREQUIRED)this.bind();else if(e===hr.f.Status.ERROR)this.setConnectionStatus(e,n("An error occurred while connecting to the chat server."));else if(e===hr.f.Status.CONNECTING)this.setConnectionStatus(e);else if(e===hr.f.Status.AUTHENTICATING)this.setConnectionStatus(e);else if(e===hr.f.Status.AUTHFAIL)t||(t=n("Your XMPP address and/or password is incorrect. Please try again.")),this.setConnectionStatus(e,t),this.setDisconnectionCause(e,t,!0),this.onDisconnected();else if(e===hr.f.Status.CONNFAIL){var s;let r=t;"host-unknown"===t||"remote-connection-failed"==t?r=n("Sorry, we could not connect to the XMPP host with domain: %1$s",`"${hr.f.getDomainFromJid(this.jid)}"`):void 0!==t&&t===(null===hr.f||void 0===hr.f||null===(s=hr.f.ErrorCondition)||void 0===s?void 0:s.NO_AUTH_MECH)&&(r=n("The XMPP server did not offer a supported authentication mechanism")),this.setConnectionStatus(e,r),this.setDisconnectionCause(e,t)}else e===hr.f.Status.DISCONNECTING&&this.setDisconnectionCause(e,t)}isType(e){return"websocket"===e.toLowerCase()?this._proto instanceof hr.f.Websocket:"bosh"===e.toLowerCase()?hr.f.Bosh&&this._proto instanceof hr.f.Bosh:void 0}hasResumed(){var e;return null!==(e=zu.settings.get("connection_options"))&&void 0!==e&&e.worker||this.isType("bosh")?Pu.connfeedback.get("connection_status")===hr.f.Status.ATTACHED:!this.do_bind}restoreWorkerSession(){return this.attach(this.onConnectStatusChanged),this.worker_attach_promise=Wo.getResolveablePromise(),this.worker_attach_promise}}class la extends da{constructor(e,t){super(e,t),this.sent_stanzas=[],this.IQ_stanzas=[],this.IQ_ids=[],this.features=hr.f.xmlHtmlNode('<stream:features xmlns:stream="http://etherx.jabber.org/streams" xmlns="jabber:client"><ver xmlns="urn:xmpp:features:rosterver"/><csi xmlns="urn:xmpp:csi:0"/><this xmlns="http://jabber.org/protocol/caps" ver="UwBpfJpEt3IoLYfWma/o/p3FFRo=" hash="sha-1" node="http://prosody.im"/><bind xmlns="urn:ietf:params:xml:ns:xmpp-bind"><required/></bind><sm xmlns=\'urn:xmpp:sm:3\'/><session xmlns="urn:ietf:params:xml:ns:xmpp-session"><optional/></session></stream:features>').firstChild,this._proto._processRequest=()=>{},this._proto._disconnect=()=>this._onDisconnectTimeout(),this._proto._onDisconnectTimeout=()=>{},this._proto._connect=()=>{this.connected=!0,this.mock=!0,this.jid="romeo@montague.lit/orchard",this._changeConnectStatus(hr.f.Status.BINDREQUIRED)}}_processRequest(){}sendIQ(e,t,n){Object(ca.isElement)(e)||(e=e.nodeTree),this.IQ_stanzas.push(e);const r=super.sendIQ(e,t,n);return this.IQ_ids.push(r),r}send(e){return Object(ca.isElement)(e)?this.sent_stanzas.push(e):this.sent_stanzas.push(e.nodeTree),super.send(e)}async bind(){await zu.trigger("beforeResourceBinding",{synchronous:!0}),this.authenticated=!0,Pu.no_connection_on_bind||this._changeConnectStatus(hr.f.Status.CONNECTED)}}const fa=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)};fa.extend=Vr;const ha=/^[#\/]|\s+$/g,pa=/^\/+|\/+$/g,ga=/#.*$/;fa.started=!1,Object.assign(fa.prototype,vi,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){const e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){const t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){const e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(ha,"")},start:function(e){if(fa.started)throw new Error("history has already been started");if(fa.started=!0,this.options=Ar({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(pa,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){const e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;const e=document.body,t=e.insertBefore(this.iframe,e.firstChild).contentWindow;t.document.open(),t.document.close(),t.location.hash="#"+this.fragment}if(this._usePushState?addEventListener("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?addEventListener("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){this._usePushState?removeEventListener("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&removeEventListener("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),fa.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){let t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),Ws(this.handlers,(function(t){if(t.route.test(e))return t.callback(e),!0})))},navigate:function(e,t){if(!fa.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");let n=this.root;""!==e&&"?"!==e.charAt(0)||(n=n.slice(0,-1)||"/");const r=n+e;e=e.replace(ga,"");const i=this.decodeFragment(e);if(this.fragment!==i){if(this.fragment=i,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){const n=this.iframe.contentWindow;t.replace||(n.document.open(),n.document.close()),this._updateHash(n.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){const n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}});var ma=fa;var va=function(e){return Se(e)&&"[object RegExp]"==O(e)},_a=Pe.a&&Pe.a.isRegExp,ya=_a?De(_a):va;const ba=function(e={}){this.history=e.history||new ma,this.preinitialize.apply(this,arguments),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};ba.extend=Vr;const wa=/\((.*?)\)/g,Sa=/(\(\?)?:\w+/g,xa=/\*\w+/g,Ea=/[\-{}\[\]+?.,\\\^$|#\s]/g;Object.assign(ba.prototype,vi,{preinitialize:function(){},initialize:function(){},route:function(e,t,n){return ya(e)||(e=this._routeToRegExp(e)),I(t)&&(n=t,t=""),n||(n=this[t]),this.history.route(e,r=>{const i=this._extractParameters(e,r);!1!==this.execute(n,i,t)&&(this.trigger.apply(this,["route:"+t].concat(i)),this.trigger("route",t,i),this.history.trigger("route",this,t,i))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,t){return this.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;let e;this.routes=Wr(this,"routes");const t=Ge(this.routes);for(;null!=(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(Ea,"\\$&").replace(wa,"(?:$1)?").replace(Sa,(function(e,t){return t?e:"([^/?]+)"})).replace(xa,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){const n=e.exec(t).slice(1);return n.map((function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null}))}});var Aa=n(1),Na=function(){return _.a.Date.now()},Ta=Math.max,Oa=Math.min;var ja=function(e,t,n){var r,i,o,s,a,u,c=0,d=!1,l=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){var n=r,o=i;return r=i=void 0,c=t,s=e.apply(o,n)}function p(e){return c=e,a=setTimeout(m,t),d?h(e):s}function g(e){var n=e-u;return void 0===u||n>=t||n<0||l&&e-c>=o}function m(){var e=Na();if(g(e))return v(e);a=setTimeout(m,function(e){var n=t-(e-u);return l?Oa(n,o-(e-c)):n}(e))}function v(e){return a=void 0,f&&r?h(e):(r=i=void 0,s)}function _(){var e=Na(),n=g(e);if(r=arguments,i=this,u=e,n){if(void 0===a)return p(u);if(l)return clearTimeout(a),a=setTimeout(m,t),h(u)}return void 0===a&&(a=setTimeout(m,t)),s}return t=di(t)||0,j(n)&&(d=!!n.leading,o=(l="maxWait"in n)?Ta(di(n.maxWait)||0,t):o,f="trailing"in n?!!n.trailing:f),_.cancel=function(){void 0!==a&&clearTimeout(a),c=0,r=u=i=a=void 0},_.flush=function(){return void 0===a?s:v(Na())},_};var Ca=xr((function(e,t,n){t=$r(t,e);var r=null==(e=No(e,t))?e:e[Hr(Eo(t))];return null==r?void 0:mr(r,e,n)}));
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const Ia="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,Ra=(e,t,n=null)=>{for(;t!==n;){const n=t.nextSibling;e.removeChild(t),t=n}},Ma=`{{lit-${String(Math.random()).slice(2)}}}`,ka=`\x3c!--${Ma}--\x3e`,Da=new RegExp(`${Ma}|${ka}`);class Pa{constructor(e,t){this.parts=[],this.element=t;const n=[],r=[],i=document.createTreeWalker(t.content,133,null,!1);let o=0,s=-1,a=0;const{strings:u,values:{length:c}}=e;for(;a<c;){const e=i.nextNode();if(null!==e){if(s++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:n}=t;let r=0;for(let e=0;e<n;e++)Fa(t[e].name,"$lit$")&&r++;for(;r-- >0;){const t=u[a],n=za.exec(t)[2],r=n.toLowerCase()+"$lit$",i=e.getAttribute(r);e.removeAttribute(r);const o=i.split(Da);this.parts.push({type:"attribute",index:s,name:n,strings:o}),a+=o.length-1}}"TEMPLATE"===e.tagName&&(r.push(e),i.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(Ma)>=0){const r=e.parentNode,i=t.split(Da),o=i.length-1;for(let t=0;t<o;t++){let n,o=i[t];if(""===o)n=Ua();else{const e=za.exec(o);null!==e&&Fa(e[2],"$lit$")&&(o=o.slice(0,e.index)+e[1]+e[2].slice(0,-"$lit$".length)+e[3]),n=document.createTextNode(o)}r.insertBefore(n,e),this.parts.push({type:"node",index:++s})}""===i[o]?(r.insertBefore(Ua(),e),n.push(e)):e.data=i[o],a+=o}}else if(8===e.nodeType)if(e.data===Ma){const t=e.parentNode;null!==e.previousSibling&&s!==o||(s++,t.insertBefore(Ua(),e)),o=s,this.parts.push({type:"node",index:s}),null===e.nextSibling?e.data="":(n.push(e),s--),a++}else{let t=-1;for(;-1!==(t=e.data.indexOf(Ma,t+1));)this.parts.push({type:"node",index:-1}),a++}}else i.currentNode=r.pop()}for(const e of n)e.parentNode.removeChild(e)}}const Fa=(e,t)=>{const n=e.length-t.length;return n>=0&&e.slice(n)===t},La=e=>-1!==e.index,Ua=()=>document.createComment(""),za=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function Ba(e,t){const{element:{content:n},parts:r}=e,i=document.createTreeWalker(n,133,null,!1);let o=Ha(r),s=r[o],a=-1,u=0;const c=[];let d=null;for(;i.nextNode();){a++;const e=i.currentNode;for(e.previousSibling===d&&(d=null),t.has(e)&&(c.push(e),null===d&&(d=e)),null!==d&&u++;void 0!==s&&s.index===a;)s.index=null!==d?-1:s.index-u,o=Ha(r,o),s=r[o]}c.forEach(e=>e.parentNode.removeChild(e))}const $a=e=>{let t=11===e.nodeType?0:1;const n=document.createTreeWalker(e,133,null,!1);for(;n.nextNode();)t++;return t},Ha=(e,t=-1)=>{for(let n=t+1;n<e.length;n++){const t=e[n];if(La(t))return n}return-1};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const qa=new WeakMap,Ja=e=>"function"==typeof e&&qa.has(e),Wa={},Va={};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class Ga{constructor(e,t,n){this.__parts=[],this.template=e,this.processor=t,this.options=n}update(e){let t=0;for(const n of this.__parts)void 0!==n&&n.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=Ia?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],n=this.template.parts,r=document.createTreeWalker(e,133,null,!1);let i,o=0,s=0,a=r.nextNode();for(;o<n.length;)if(i=n[o],La(i)){for(;s<i.index;)s++,"TEMPLATE"===a.nodeName&&(t.push(a),r.currentNode=a.content),null===(a=r.nextNode())&&(r.currentNode=t.pop(),a=r.nextNode());if("node"===i.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(a.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(a,i.name,i.strings,this.options));o++}else this.__parts.push(void 0),o++;return Ia&&(document.adoptNode(e),customElements.upgrade(e)),e}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const Ya=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:e=>e}),Xa=` ${Ma} `;class Qa{constructor(e,t,n,r){this.strings=e,this.values=t,this.type=n,this.processor=r}getHTML(){const e=this.strings.length-1;let t="",n=!1;for(let r=0;r<e;r++){const e=this.strings[r],i=e.lastIndexOf("\x3c!--");n=(i>-1||n)&&-1===e.indexOf("--\x3e",i+1);const o=za.exec(e);t+=null===o?e+(n?Xa:ka):e.substr(0,o.index)+o[1]+o[2]+"$lit$"+o[3]+Ma}return t+=this.strings[e],t}getTemplateElement(){const e=document.createElement("template");let t=this.getHTML();return void 0!==Ya&&(t=Ya.createHTML(t)),e.innerHTML=t,e}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const Ka=e=>null===e||!("object"==typeof e||"function"==typeof e),Za=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);class eu{constructor(e,t,n){this.dirty=!0,this.element=e,this.name=t,this.strings=n,this.parts=[];for(let e=0;e<n.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new tu(this)}_getValue(){const e=this.strings,t=e.length-1,n=this.parts;if(1===t&&""===e[0]&&""===e[1]){const e=n[0].value;if("symbol"==typeof e)return String(e);if("string"==typeof e||!Za(e))return e}let r="";for(let i=0;i<t;i++){r+=e[i];const t=n[i];if(void 0!==t){const e=t.value;if(Ka(e)||!Za(e))r+="string"==typeof e?e:String(e);else for(const t of e)r+="string"==typeof t?t:String(t)}}return r+=e[t],r}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class tu{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===Wa||Ka(e)&&e===this.value||(this.value=e,Ja(e)||(this.committer.dirty=!0))}commit(){for(;Ja(this.value);){const e=this.value;this.value=Wa,e(this)}this.value!==Wa&&this.committer.commit()}}class nu{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(Ua()),this.endNode=e.appendChild(Ua())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=Ua()),e.__insert(this.endNode=Ua())}insertAfterPart(e){e.__insert(this.startNode=Ua()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(null===this.startNode.parentNode)return;for(;Ja(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=Wa,e(this)}const e=this.__pendingValue;e!==Wa&&(Ka(e)?e!==this.value&&this.__commitText(e):e instanceof Qa?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):Za(e)?this.__commitIterable(e):e===Va?(this.value=Va,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,n="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=n:this.__commitNode(document.createTextNode(n)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof Ga&&this.value.template===t)this.value.update(e.values);else{const n=new Ga(t,e.processor,this.options),r=n._clone();n.update(e.values),this.__commitNode(r),this.value=n}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let n,r=0;for(const i of e)n=t[r],void 0===n&&(n=new nu(this.options),t.push(n),0===r?n.appendIntoPart(this):n.insertAfterPart(t[r-1])),n.setValue(i),n.commit(),r++;r<t.length&&(t.length=r,this.clear(n&&n.endNode))}clear(e=this.startNode){Ra(this.startNode.parentNode,e.nextSibling,this.endNode)}}class ru{constructor(e,t,n){if(this.value=void 0,this.__pendingValue=void 0,2!==n.length||""!==n[0]||""!==n[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=n}setValue(e){this.__pendingValue=e}commit(){for(;Ja(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=Wa,e(this)}if(this.__pendingValue===Wa)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=Wa}}class iu extends eu{constructor(e,t,n){super(e,t,n),this.single=2===n.length&&""===n[0]&&""===n[1]}_createPart(){return new ou(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class ou extends tu{}let su=!1;(()=>{try{const e={get capture(){return su=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}})();class au{constructor(e,t,n){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=n,this.__boundHandleEvent=e=>this.handleEvent(e)}setValue(e){this.__pendingValue=e}commit(){for(;Ja(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=Wa,e(this)}if(this.__pendingValue===Wa)return;const e=this.__pendingValue,t=this.value,n=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),r=null!=e&&(null==t||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),r&&(this.__options=uu(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=Wa}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const uu=e=>e&&(su?{capture:e.capture,passive:e.passive,once:e.once}:e.capture)
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */;function cu(e){let t=du.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},du.set(e.type,t));let n=t.stringsArray.get(e.strings);if(void 0!==n)return n;const r=e.strings.join(Ma);return n=t.keyString.get(r),void 0===n&&(n=new Pa(e,e.getTemplateElement()),t.keyString.set(r,n)),t.stringsArray.set(e.strings,n),n}const du=new Map,lu=new WeakMap;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const fu=new
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class{handleAttributeExpressions(e,t,n,r){const i=t[0];if("."===i){return new iu(e,t.slice(1),n).parts}if("@"===i)return[new au(e,t.slice(1),r.eventContext)];if("?"===i)return[new ru(e,t.slice(1),n)];return new eu(e,t,n).parts}handleTextExpression(e){return new nu(e)}};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.3.0");const hu=(e,...t)=>new Qa(e,t,"html",fu),pu=(e,t)=>`${e}--${t}`;let gu=!0;void 0===window.ShadyCSS?gu=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),gu=!1);const mu=e=>t=>{const n=pu(t.type,e);let r=du.get(n);void 0===r&&(r={stringsArray:new WeakMap,keyString:new Map},du.set(n,r));let i=r.stringsArray.get(t.strings);if(void 0!==i)return i;const o=t.strings.join(Ma);if(i=r.keyString.get(o),void 0===i){const n=t.getTemplateElement();gu&&window.ShadyCSS.prepareTemplateDom(n,e),i=new Pa(t,n),r.keyString.set(o,i)}return r.stringsArray.set(t.strings,i),i},vu=["html","svg"],_u=new Set,yu=(e,t,n)=>{_u.add(e);const r=n?n.element:document.createElement("template"),i=t.querySelectorAll("style"),{length:o}=i;if(0===o)return void window.ShadyCSS.prepareTemplateStyles(r,e);const s=document.createElement("style");for(let e=0;e<o;e++){const t=i[e];t.parentNode.removeChild(t),s.textContent+=t.textContent}(e=>{vu.forEach(t=>{const n=du.get(pu(t,e));void 0!==n&&n.keyString.forEach(e=>{const{element:{content:t}}=e,n=new Set;Array.from(t.querySelectorAll("style")).forEach(e=>{n.add(e)}),Ba(e,n)})})})(e);const a=r.content;n?function(e,t,n=null){const{element:{content:r},parts:i}=e;if(null==n)return void r.appendChild(t);const o=document.createTreeWalker(r,133,null,!1);let s=Ha(i),a=0,u=-1;for(;o.nextNode();){u++;for(o.currentNode===n&&(a=$a(t),n.parentNode.insertBefore(t,n));-1!==s&&i[s].index===u;){if(a>0){for(;-1!==s;)i[s].index+=a,s=Ha(i,s);return}s=Ha(i,s)}}}(n,s,a.firstChild):a.insertBefore(s,a.firstChild),window.ShadyCSS.prepareTemplateStyles(r,e);const u=a.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==u)t.insertBefore(u.cloneNode(!0),t.firstChild);else if(n){a.insertBefore(s,a.firstChild);const e=new Set;e.add(s),Ba(n,e)}};window.JSCompiler_renameProperty=(e,t)=>e;const bu={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},wu=(e,t)=>t!==e&&(t==t||e==e),Su={attribute:!0,type:String,converter:bu,reflect:!1,hasChanged:wu};class xu extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((t,n)=>{const r=this._attributeNameForProperty(n,t);void 0!==r&&(this._attributeToPropertyMap.set(r,n),e.push(r))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach((e,t)=>this._classProperties.set(t,e))}}static createProperty(e,t=Su){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const n="symbol"==typeof e?Symbol():"__"+e,r=this.getPropertyDescriptor(e,n,t);void 0!==r&&Object.defineProperty(this.prototype,e,r)}static getPropertyDescriptor(e,t,n){return{get(){return this[t]},set(r){const i=this[e];this[t]=r,this.requestUpdateInternal(e,i,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this._classProperties&&this._classProperties.get(e)||Su}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty("finalized")||e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const n of t)this.createProperty(n,e[n])}}static _attributeNameForProperty(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,n=wu){return n(e,t)}static _propertyValueFromAttribute(e,t){const n=t.type,r=t.converter||bu,i="function"==typeof r?r:r.fromAttribute;return i?i(e,n):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const n=t.type,r=t.converter;return(r&&r.toAttribute||bu.toAttribute)(e,n)}initialize(){this._updateState=0,this._updatePromise=new Promise(e=>this._enableUpdatingResolver=e),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,t)=>this[t]=e),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,n){t!==n&&this._attributeToProperty(e,n)}_propertyToAttribute(e,t,n=Su){const r=this.constructor,i=r._attributeNameForProperty(e,n);if(void 0!==i){const e=r._propertyValueToAttribute(t,n);if(void 0===e)return;this._updateState=8|this._updateState,null==e?this.removeAttribute(i):this.setAttribute(i,e),this._updateState=-9&this._updateState}}_attributeToProperty(e,t){if(8&this._updateState)return;const n=this.constructor,r=n._attributeToPropertyMap.get(e);if(void 0!==r){const e=n.getPropertyOptions(r);this._updateState=16|this._updateState,this[r]=n._propertyValueFromAttribute(t,e),this._updateState=-17&this._updateState}}requestUpdateInternal(e,t,n){let r=!0;if(void 0!==e){const i=this.constructor;n=n||i.getPropertyOptions(e),i._valueHasChanged(this[e],t,n.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==n.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,n))):r=!1}!this._hasRequestedUpdate&&r&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(e,t){return this.requestUpdateInternal(e,t),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(e){}const e=this.performUpdate();return null!=e&&await e,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{e=this.shouldUpdate(t),e?this.update(t):this._markUpdated()}catch(t){throw e=!1,this._markUpdated(),t}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((e,t)=>this._propertyToAttribute(t,this[t],e)),this._reflectingProperties=void 0),this._markUpdated()}updated(e){}firstUpdated(e){}}xu.finalized=!0;const Eu=Element.prototype;Eu.msMatchesSelector||Eu.webkitMatchesSelector;
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const Au=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Nu=Symbol();class Tu{constructor(e,t){if(t!==Nu)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(Au?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litElementVersions||(window.litElementVersions=[])).push("2.4.0");const Ou={};class ju extends xu{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const e=this.getStyles();if(Array.isArray(e)){const t=(e,n)=>e.reduceRight((e,n)=>Array.isArray(n)?t(n,e):(e.add(n),e),n),n=t(e,new Set),r=[];n.forEach(e=>r.unshift(e)),this._styles=r}else this._styles=void 0===e?[]:[e];this._styles=this._styles.map(e=>{if(e instanceof CSSStyleSheet&&!Au){const t=Array.prototype.slice.call(e.cssRules).reduce((e,t)=>e+t.cssText,"");return new Tu(String(t),Nu)}return e})}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?Au?this.renderRoot.adoptedStyleSheets=e.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(e=>e.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){const t=this.render();super.update(e),t!==Ou&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)}))}render(){return Ou}}ju.finalized=!0,ju.render=(e,t,n)=>{if(!n||"object"!=typeof n||!n.scopeName)throw new Error("The `scopeName` option is required.");const r=n.scopeName,i=lu.has(t),o=gu&&11===t.nodeType&&!!t.host,s=o&&!_u.has(r),a=s?document.createDocumentFragment():t;if(((e,t,n)=>{let r=lu.get(t);void 0===r&&(Ra(t,t.firstChild),lu.set(t,r=new nu(Object.assign({templateFactory:cu},n))),r.appendInto(t)),r.setValue(e),r.commit()})(e,a,Object.assign({templateFactory:mu(r)},n)),s){const e=lu.get(a);lu.delete(a);const n=e.value instanceof Ga?e.value.template:void 0;yu(r,a,n),Ra(t,t.firstChild),t.appendChild(a),lu.set(t,e)}!i&&o&&window.ShadyCSS.styleElement(t.host)};var Cu=n(82);
/**
 * @module converse-core
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */bn.a.extend(_n.a),Aa.e.addNamespace("CARBONS","urn:xmpp:carbons:2"),Aa.e.addNamespace("CHATSTATES","http://jabber.org/protocol/chatstates"),Aa.e.addNamespace("CSI","urn:xmpp:csi:0"),Aa.e.addNamespace("DELAY","urn:xmpp:delay"),Aa.e.addNamespace("FASTEN","urn:xmpp:fasten:0"),Aa.e.addNamespace("FORWARD","urn:xmpp:forward:0"),Aa.e.addNamespace("HINTS","urn:xmpp:hints"),Aa.e.addNamespace("HTTPUPLOAD","urn:xmpp:http:upload:0"),Aa.e.addNamespace("IDLE","urn:xmpp:idle:1"),Aa.e.addNamespace("MAM","urn:xmpp:mam:2"),Aa.e.addNamespace("MODERATE","urn:xmpp:message-moderate:0"),Aa.e.addNamespace("NICK","http://jabber.org/protocol/nick"),Aa.e.addNamespace("OMEMO","eu.siacs.conversations.axolotl"),Aa.e.addNamespace("OUTOFBAND","jabber:x:oob"),Aa.e.addNamespace("PUBSUB","http://jabber.org/protocol/pubsub"),Aa.e.addNamespace("REGISTER","jabber:iq:register"),Aa.e.addNamespace("RETRACT","urn:xmpp:message-retract:0"),Aa.e.addNamespace("ROSTERX","http://jabber.org/protocol/rosterx"),Aa.e.addNamespace("RSM","http://jabber.org/protocol/rsm"),Aa.e.addNamespace("SID","urn:xmpp:sid:0"),Aa.e.addNamespace("SPOILER","urn:xmpp:spoiler:0"),Aa.e.addNamespace("STANZAS","urn:ietf:params:xml:ns:xmpp-stanzas"),Aa.e.addNamespace("VCARD","vcard-temp"),Aa.e.addNamespace("VCARDUPDATE","vcard-temp:x:update"),Aa.e.addNamespace("XFORM","jabber:x:data");class Iu extends Error{}const Ru=["converse-adhoc","converse-bookmarks","converse-bosh","converse-caps","converse-carbons","converse-chat","converse-chatboxes","converse-disco","converse-emoji","converse-headlines","converse-mam","converse-muc","converse-ping","converse-pubsub","converse-roster","converse-smacks","converse-status","converse-vcard"],Mu={allow_non_roster_messaging:!1,assets_path:"/dist",authentication:"login",auto_login:!1,auto_reconnect:!0,blacklisted_plugins:[],clear_cache_on_logout:!1,connection_options:{},credentials_url:null,discover_connection_methods:!0,geouri_regex:/https\:\/\/www.openstreetmap.org\/.*#map=[0-9]+\/([\-0-9.]+)\/([\-0-9.]+)\S*/g,geouri_replacement:"https://www.openstreetmap.org/?mlat=$1&mlon=$2#map=18/$1/$2",i18n:void 0,idle_presence_timeout:300,jid:void 0,keepalive:!0,loglevel:"info",locales:["af","ar","bg","ca","cs","de","eo","es","eu","en","fi","fr","gl","he","hi","hu","id","it","ja","nb","nl","mr","oc","pl","pt","pt_BR","ro","ru","tr","uk","vi","zh_CN","zh_TW"],nickname:void 0,password:void 0,persistent_store:"localStorage",rid:void 0,root:window.document,sid:void 0,singleton:!1,strict_plugin_dependencies:!1,view_mode:"overlayed",websocket_url:void 0,whitelisted_plugins:[]},ku={};ku[Aa.e.Status.ATTACHED]="ATTACHED",ku[Aa.e.Status.AUTHENTICATING]="AUTHENTICATING",ku[Aa.e.Status.AUTHFAIL]="AUTHFAIL",ku[Aa.e.Status.CONNECTED]="CONNECTED",ku[Aa.e.Status.CONNECTING]="CONNECTING",ku[Aa.e.Status.CONNFAIL]="CONNFAIL",ku[Aa.e.Status.DISCONNECTED]="DISCONNECTED",ku[Aa.e.Status.DISCONNECTING]="DISCONNECTING",ku[Aa.e.Status.ERROR]="ERROR",ku[Aa.e.Status.RECONNECTING]="RECONNECTING",ku[Aa.e.Status.REDIRECT]="REDIRECT";const Du={initialize(){},__:(...e)=>Object(Cu.sprintf)(...e)},Pu={log:kn,CONNECTION_STATUS:ku,templates:{},promises:{initialized:Wo.getResolveablePromise()},STATUS_WEIGHTS:{offline:6,unavailable:5,xa:4,away:3,dnd:2,chat:1,online:1},ANONYMOUS:"anonymous",CLOSED:"closed",EXTERNAL:"external",LOGIN:"login",LOGOUT:"logout",OPENED:"opened",PREBIND:"prebind",STANZA_TIMEOUT:1e4,SUCCESS:"success",FAILURE:"failure",DEFAULT_IMAGE_TYPE:"image/svg+xml",DEFAULT_IMAGE:"PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCI+CiA8cmVjdCB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgZmlsbD0iIzU1NSIvPgogPGNpcmNsZSBjeD0iNjQiIGN5PSI0MSIgcj0iMjQiIGZpbGw9IiNmZmYiLz4KIDxwYXRoIGQ9Im0yOC41IDExMiB2LTEyIGMwLTEyIDEwLTI0IDI0LTI0IGgyMyBjMTQgMCAyNCAxMiAyNCAyNCB2MTIiIGZpbGw9IiNmZmYiLz4KPC9zdmc+Cg==",TIMEOUTS:{PAUSED:1e4,INACTIVE:9e4},INACTIVE:"inactive",ACTIVE:"active",COMPOSING:"composing",PAUSED:"paused",GONE:"gone",PRIVATE_CHAT_TYPE:"chatbox",CHATROOMS_TYPE:"chatroom",HEADLINES_TYPE:"headline",CONTROLBOX_TYPE:"controlbox",default_connection_options:{explicitResourceBinding:!0},router:new ba,TimeoutError:Iu,isTestEnv:()=>"montague.lit/http-bind"===Lu.bosh_service_url,__:(...e)=>Du.__(...e),___:e=>e};let Fu;Pu.VERSION_NAME="v7.0.5",Object.assign(Pu,vi),sr.enable(Pu,"_converse","pluggable");let Lu={};function Uu(){var e;if(!Pu.bare_jid){const e="No JID to fetch user settings for";throw kn.error(e),Error(e)}if(null===(e=Fu)||void 0===e||!e.fetched){const e="converse.user-settings."+Pu.bare_jid;Fu=new Uo({id:e}),Fu.browserStorage=$u(e),Fu.fetched=Fu.fetch({promise:!0})}return Fu.fetched}const zu=Pu.api={connection:{connected(){var e;return(null==Pu||null===(e=Pu.connection)||void 0===e?void 0:e.connected)&&!0},disconnect(){Pu.connection&&Pu.connection.disconnect()},async reconnect(){const e=Pu.connfeedback.get("connection_status");if(zu.settings.get("authentication")===Pu.ANONYMOUS&&(await Hu(),await Ju()),e===Aa.e.Status.CONNFAIL?zu.connection.isType("websocket")&&zu.settings.get("bosh_service_url")?(await Pu.setUserJID(Pu.bare_jid),Pu.connection._proto._doDisconnect(),Pu.connection._proto=new Aa.e.Bosh(Pu.connection),Pu.connection.service=zu.settings.get("bosh_service_url")):zu.connection.isType("bosh")&&zu.settings.get("websocket_url")&&(zu.settings.get("authentication")===Pu.ANONYMOUS?await Pu.setUserJID(zu.settings.get("jid")):await Pu.setUserJID(Pu.bare_jid),Pu.connection._proto._doDisconnect(),Pu.connection._proto=new Aa.e.Websocket(Pu.connection),Pu.connection.service=zu.settings.get("websocket_url")):e===Aa.e.Status.AUTHFAIL&&zu.settings.get("authentication")===Pu.ANONYMOUS&&await Pu.setUserJID(zu.settings.get("jid")),!Pu.connection.reconnecting)return Pu.connection.reconnect();Pu.connection.debouncedReconnect()},isType:e=>Pu.connection.isType(e)},async trigger(e){if(!Pu._events)return;const t=Array.from(arguments),n=t.pop();if(n&&n.synchronous){const n=Pu._events[e]||[];await Promise.all(n.map(e=>e.callback.apply(e.ctx,t.splice(1))))}else Pu.trigger.apply(Pu,arguments);const r=Pu.promises[e];void 0!==r&&r.resolve()},hook(e,t,n){const r=Pu._events[e]||[];if(r.length){const e=r.reduce((e,n)=>e.then(e=>n.callback(t,e)),Promise.resolve(n));return e.catch(e=>{throw kn.error(e),e}),e}return n},user:{jid:()=>Pu.connection.jid,async login(e,t,n=!1){var r,i;if(e=e||Pu.jid,(null===(r=Pu.connection)||void 0===r||!r.jid||e&&!Wo.isSameDomain(Pu.connection.jid,e))&&await Pu.initConnection(),null!==(i=zu.settings.get("connection_options"))&&void 0!==i&&i.worker&&await Pu.connection.restoreWorkerSession())return;e&&(e=await Pu.setUserJID(e));const o=Pu.pluggable.plugins["converse-bosh"];if(o&&o.enabled()){if(await Pu.restoreBOSHSession())return;if(zu.settings.get("authentication")===Pu.PREBIND&&(!n||zu.settings.get("auto_login")))return Pu.startNewPreboundBOSHSession()}t=t||zu.settings.get("password");!async function(e,t){const{api:n}=Pu;n.settings.get("authentication")===Pu.LOGIN?e?qu(e):Pu.api.settings.get("credentials_url")?qu(await async function(){let e,t=0;for(;!e;){try{e=await Yu(t)}catch(e){kn.error("Could not fetch login credentials"),kn.error(e)}t=2e3}return e}()):Pu.jid&&(Pu.api.settings.get("password")||Pu.connection.pass)?qu():!Pu.isTestEnv()&&"credentials"in navigator?qu(await async function(){try{const e=await navigator.credentials.get({password:!0});if(e&&"password"==e.type&&Wo.isValidJID(e.id))return await Pu.setUserJID(e.id),{jid:e.id,password:e.password}}catch(e){kn.error(e)}}()):!Pu.isTestEnv()&&kn.warn("attemptNonPreboundSession: Couldn't find credentials to log in with"):![Pu.ANONYMOUS,Pu.EXTERNAL].includes(Pu.api.settings.get("authentication"))||t&&!Pu.api.settings.get("auto_login")||qu()}(e&&t?{jid:e,password:t}:null,n)},logout(){const e=Wo.getResolveablePromise(),t=()=>{Object.keys(Pu.promises).forEach(Bu),delete Pu.jid,zu.trigger("logout"),e.resolve()};return Pu.connection.setDisconnectionCause(Pu.LOGOUT,void 0,!0),void 0!==Pu.connection?(zu.listen.once("disconnected",()=>t()),Pu.connection.disconnect()):t(),e},settings:{getModel:async()=>(await Uu(),Fu),get:async(e,t)=>(await Uu(),void 0===Fu.get(e)?t:Fu.get(e)),async set(e,t){if(await Uu(),j(e))return Fu.save(e,{promise:!0});{const n={};return n[e]=t,Fu.save(n,{promise:!0})}},async clear(){await Uu(),Fu.clear()}}},settings:{extend(e){Wo.merge(Mu,e);const t=Object.keys(Lo(e,Object.keys(Mu))),n=Lo(Lu,t),r=Ar(Lo(e,t),n);Wo.merge(Pu.settings,r),Wo.merge(Pu,r)},update(e){return kn.warn("The api.settings.update method has been deprecated and will be removed. Please use api.settings.extend instead."),this.extend(e)},get(e){if(Object.keys(Mu).includes(e))return Pu[e]},set(e,t){const n={};j(e)?(Ar(Pu,Lo(e,Object.keys(Mu))),Ar(Pu.settings,Lo(e,Object.keys(Mu)))):"string"==typeof e&&(n[e]=t,Ar(Pu,Lo(n,Object.keys(Mu))),Ar(Pu.settings,Lo(n,Object.keys(Mu))))}},promises:{add(e,t=!0){(e=Array.isArray(e)?e:[e]).forEach(e=>{const n=Wo.getResolveablePromise();n.replace=t,Pu.promises[e]=n})}},listen:{once:Pu.once.bind(Pu),on:Pu.on.bind(Pu),not:Pu.off.bind(Pu),stanza(e,t,n){I(t)?(n=t,t={}):t=t||{},Pu.connection.addHandler(n,t.ns,e,t.type,t.id,t.from,t)}},waitUntil(e){if(I(e))return Wo.waitUntil(e);{const t=Pu.promises[e];return void 0===t?null:t}},send:e=>zu.connection.connected()?("string"==typeof e&&(e=Wo.toStanza(e)),"iq"===e.tagName?zu.sendIQ(e):(Pu.connection.send(e),void zu.trigger("send",e))):(kn.warn("Not sending stanza because we're not connected!"),void kn.warn(Aa.e.serialize(e))),sendIQ(e,t=Pu.STANZA_TIMEOUT,n=!0){var r,i;let o;return e=null!==(r=null===(i=e)||void 0===i?void 0:i.nodeTree)&&void 0!==r?r:e,["get","set"].includes(e.getAttribute("type"))?(t=t||Pu.STANZA_TIMEOUT,n?(o=new Promise((n,r)=>Pu.connection.sendIQ(e,n,r,t)),o.catch(n=>{if(null===n)throw new Iu(`Timeout error after ${t}ms for the following IQ stanza: ${Aa.e.serialize(e)}`)})):o=new Promise(n=>Pu.connection.sendIQ(e,n,n,t))):(Pu.connection.sendIQ(e),o=Promise.resolve()),zu.trigger("send",e),o}};function Bu(e){const t=Pu.promises[e];if(!t)throw new Error("Tried to replace non-existing promise: "+e);if(t.replace){const n=Wo.getResolveablePromise();n.replace=t.replace,Pu.promises[e]=n}else kn.debug(`Not replacing promise "${e}"`)}function $u(e,t){const n=Pu.storage[t||Pu.getDefaultStore()];return new mn(e,n)}async function Hu(){return await Pu.api.trigger("beforeTearDown",{synchronous:!0}),window.removeEventListener("click",Pu.onUserActivity),window.removeEventListener("focus",Pu.onUserActivity),window.removeEventListener("keypress",Pu.onUserActivity),window.removeEventListener("mousemove",Pu.onUserActivity),window.removeEventListener(Pu.unloadevent,Pu.onUserActivity),window.clearInterval(Pu.everySecondTrigger),Pu.api.trigger("afterTearDown"),Pu}function qu(e){if([Pu.ANONYMOUS,Pu.EXTERNAL].includes(Pu.api.settings.get("authentication"))){if(!Pu.jid)throw new Error("Config Error: when using anonymous login you need to provide the server's domain via the 'jid' option. Either when calling converse.initialize, or when calling _converse.api.user.login.");Pu.connection.reconnecting||Pu.connection.reset(),Pu.connection.connect(Pu.jid.toLowerCase())}else if(Pu.api.settings.get("authentication")===Pu.LOGIN){var t;const n=e?e.password:(null===(t=Pu.connection)||void 0===t?void 0:t.pass)||Pu.api.settings.get("password");if(!n){if(Pu.api.settings.get("auto_login"))throw new Error("autoLogin: If you use auto_login and authentication='login' then you also need to provide a password.");return Pu.connection.setDisconnectionCause(Aa.e.Status.AUTHFAIL,void 0,!0),void Pu.api.connection.disconnect()}Pu.connection.reconnecting||Pu.connection.reset(),Pu.connection.connect(Pu.jid,n)}}function Ju(){var e;return null===(e=Pu.session)||void 0===e||e.destroy(),delete Pu.session,Pu.shouldClearCache()&&Pu.api.user.settings.clear(),Pu.api.trigger("clearSession",{synchronous:!0})}async function Wu(e){var t;const n=zu.settings.get("connection_options").worker,r="converse.session-"+Aa.e.getBareJidFromJid(e).toLowerCase();(null===(t=Pu.session)||void 0===t?void 0:t.get("id"))!==r?(Pu.session=new Uo({id:r}),Pu.session.browserStorage=$u(r,n?"persistent":"session"),await new Promise(e=>Pu.session.fetch({success:e,error:e})),!n&&Pu.session.get("active")&&(Pu.session.clear(),Pu.session.save({id:r})),Vu(e),function(){if("sessionStorage"===zu.settings.get("persistent_store"))return;if("BrowserExtLocal"===Pu.api.settings.get("persistent_store"))return mn.localForage.defineDriver(dr.a).then(()=>mn.localForage.setDriver("webExtensionLocalStorage")),void(Pu.storage.persistent=mn.localForage);if("BrowserExtSync"===Pu.api.settings.get("persistent_store"))return mn.localForage.defineDriver(ur.a).then(()=>mn.localForage.setDriver("webExtensionSyncStorage")),void(Pu.storage.persistent=mn.localForage);const e={name:Pu.isTestEnv()?"converse-test-persistent":"converse-persistent",storeName:Pu.bare_jid};"localStorage"===Pu.api.settings.get("persistent_store")?(e.description="localStorage instance",e.driver=[mn.localForage.LOCALSTORAGE]):"IndexedDB"===Pu.api.settings.get("persistent_store")&&(e.description="indexedDB instance",e.driver=[mn.localForage.INDEXEDDB]),Pu.storage.persistent=mn.localForage.createInstance(e)}(),Pu.api.trigger("userSessionInitialized")):Vu(e)}function Vu(e){e=Pu.session.get("jid")||e,Pu.api.settings.get("authentication")===Pu.ANONYMOUS||Aa.e.getResourceFromJid(e)||(e=e.toLowerCase()+da.generateResource()),Pu.jid=e,Pu.bare_jid=Aa.e.getBareJidFromJid(e),Pu.resource=Aa.e.getResourceFromJid(e),Pu.domain=Aa.e.getDomainFromJid(e),Pu.session.save({jid:e,bare_jid:Pu.bare_jid,resource:Pu.resource,domain:Pu.domain,active:!0}),Pu.connection.jid=e}async function Gu(){var e;await zu.trigger("cleanup",{synchronous:!0}),Pu.router.history.stop(),document.removeEventListener("visibilitychange",Pu.saveWindowState),zu.trigger("unregisteredGlobalEventHandlers"),null===(e=Pu.connection)||void 0===e||e.reset(),Pu.stopListening(),Pu.off(),Pu.promises.initialized.isResolved&&zu.promises.add("initialized")}function Yu(e=0){return new Promise(ja((e,t)=>{const n=new XMLHttpRequest;n.open("GET",zu.settings.get("credentials_url"),!0),n.setRequestHeader("Accept","application/json, text/javascript"),n.onload=()=>{if(n.status>=200&&n.status<400){const t=JSON.parse(n.responseText);Pu.setUserJID(t.jid).then(()=>{e({jid:t.jid,password:t.password})})}else t(new Error(`${n.status}: ${n.responseText}`))},n.onerror=t,n.send()},e))}Pu.isUniView=function(){return["mobile","fullscreen","embedded"].includes(zu.settings.get("view_mode"))},Pu.getDefaultStore=function(){if(Pu.config.get("trusted")){return"sessionStorage"===zu.settings.get("persistent_store")?"session":"persistent"}return"session"},Pu.createStore=$u,Pu.shouldClearCache=()=>!Pu.config.get("trusted")||zu.settings.get("clear_cache_on_logout")||Pu.isTestEnv(),Pu.initConnection=function(){const e=Pu.api;if(!e.settings.get("bosh_service_url")){if(e.settings.get("authentication")===Pu.PREBIND)throw new Error("authentication is set to 'prebind' but we don't have a BOSH connection");if(!e.settings.get("websocket_url"))throw new Error("initConnection: you must supply a value for either the bosh_service_url or websocket_url or both.")}const t=Pu.isTestEnv()?la:da;if(("WebSocket"in window||"MozWebSocket"in window)&&e.settings.get("websocket_url"))Pu.connection=new t(e.settings.get("websocket_url"),Object.assign(Pu.default_connection_options,e.settings.get("connection_options")));else{if(!e.settings.get("bosh_service_url"))throw new Error("initConnection: this browser does not support websockets and bosh_service_url wasn't specified.");Pu.connection=new t(e.settings.get("bosh_service_url"),Object.assign(Pu.default_connection_options,e.settings.get("connection_options"),{keepalive:e.settings.get("keepalive")}))}!function(){const e={};e[Aa.e.LogLevel.DEBUG]="debug",e[Aa.e.LogLevel.INFO]="info",e[Aa.e.LogLevel.WARN]="warn",e[Aa.e.LogLevel.ERROR]="error",e[Aa.e.LogLevel.FATAL]="fatal",Aa.e.log=(t,n)=>kn.log(n,e[t]),Aa.e.error=e=>kn.error(e),Pu.connection.xmlInput=e=>kn.debug(e.outerHTML,"color: darkgoldenrod"),Pu.connection.xmlOutput=e=>kn.debug(e.outerHTML,"color: darkcyan")}(),e.trigger("connectionInitialized")},Pu.setUserJID=async function(e){return await Wu(e),Pu.api.trigger("setUserJID"),e},Pu.saveWindowState=function(e){let t;const n={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};t=(e=e||document.createEvent("Events")).type in n?n[e.type]:document.hidden?"hidden":"visible",Pu.windowState=t,zu.trigger("windowStateChanged",{state:t})},Pu.ConnectionFeedback=Uo.extend({defaults:{connection_status:Aa.e.Status.DISCONNECTED,message:""},initialize(){this.on("change",()=>zu.trigger("connfeedback",Pu.connfeedback))}});const Xu=window.converse||{};Object.assign(Xu,{CHAT_STATES:["active","composing","gone","inactive","paused"],keycodes:{TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,FORWARD_SLASH:47,AT:50,META:91,META_RIGHT:93},async initialize(e){if(await Gu(),"onpagehide"in window?Pu.unloadevent="pagehide":"onbeforeunload"in window?Pu.unloadevent="beforeunload":"onunload"in window&&(Pu.unloadevent="unload"),function(e){Pu.settings={},Lu=e;const t=Lo(e,Object.keys(Mu));Ar(Pu.settings,Mu,t),Ar(Pu,Mu,t)}(e),Pu.strict_plugin_dependencies=e.strict_plugin_dependencies,kn.setLogLevel(zu.settings.get("loglevel")),zu.settings.get("authentication")===Pu.ANONYMOUS&&zu.settings.get("auto_login")&&!zu.settings.get("jid"))throw new Error("Config Error: you need to provide the server's domain via the 'jid' option when using anonymous authentication with auto_login.");Pu.router.route(/^converse\?loglevel=(debug|info|warn|error|fatal)$/,"loglevel",e=>kn.setLogLevel(e)),Pu.connfeedback=new Pu.ConnectionFeedback,Pu.send_initial_presence=!0,await async function(){await mn.sessionStorageInitialized,Pu.storage={session:mn.localForage.createInstance({name:Pu.isTestEnv()?"converse-test-session":"converse-session",description:"sessionStorage instance",driver:["sessionStorageWrapper"]})}}(),await async function(){const e="converse.client-config";Pu.config=new Uo({id:e,trusted:!0}),Pu.config.browserStorage=$u(e,"session"),await new Promise(e=>Pu.config.fetch({success:e,error:e})),Pu.api.trigger("clientConfigInitialized")}(),await Du.initialize(),function(){Pu.pluggable.initialized_plugins=[];const e=Ru.concat(Pu.api.settings.get("whitelisted_plugins"));Pu.api.settings.get("singleton")&&["converse-bookmarks","converse-controlbox","converse-headline","converse-register"].forEach(e=>Pu.api.settings.get("blacklisted_plugins").push(e)),Pu.pluggable.initializePlugins({_converse:Pu},e,Pu.api.settings.get("blacklisted_plugins")),Pu.api.trigger("pluginsInitialized")}(),document.addEventListener("visibilitychange",Pu.saveWindowState),Pu.saveWindowState({type:document.hidden?"blur":"focus"}),zu.trigger("registeredGlobalEventHandlers"),!History.started&&Pu.router.history.start(),zu.settings.get("idle_presence_timeout")>0&&zu.listen.on("addClientFeatures",()=>zu.disco.own.features.add(Aa.e.NS.IDLE));const t=Pu.pluggable.plugins;if((zu.settings.get("auto_login")||zu.settings.get("keepalive")&&Ca(t["converse-bosh"],"enabled"))&&await zu.user.login(null,null,!0),zu.trigger("initialized"),Pu.isTestEnv())return Pu},plugins:{add(e,t){if(t.__name__=e,void 0!==Pu.pluggable.plugins[e])throw new TypeError(`Error: plugin with name "${e}" has already been registered!`);Pu.pluggable.plugins[e]=t}},env:{$build:Aa.a,$iq:Aa.b,$msg:Aa.c,$pres:Aa.d,utils:Wo,Collection:ea,Model:Uo,Promise:Promise,Strophe:Aa.e,dayjs:bn.a,html:hu,log:kn,sizzle:fr.a,sprintf:Cu.sprintf,stanza_utils:fs,u:Wo}});const Qu=new CustomEvent("converse-loaded",{detail:{converse:Xu}});window.dispatchEvent(Qu);const{Strophe:Ku}=Xu.env;let Zu,ec;Ku.addNamespace("ADHOC","http://jabber.org/protocol/commands");const tc={adhoc:{async getCommands(e){let t=[];try{n=await ec.disco.items(e,Ku.NS.ADHOC),t=fr()(`query[xmlns="${Ku.NS.DISCO_ITEMS}"][node="${Ku.NS.ADHOC}"] item`,n).map(fs.getAttributes)}catch(t){null===t?kn.error("Error: timeout while fetching ad-hoc commands for "+e):(kn.error("Error while fetching ad-hoc commands for "+e),kn.error(t))}var n;return t}}};Xu.plugins.add("converse-adhoc",{dependencies:["converse-disco"],initialize(){Zu=this._converse,ec=Zu.api,Object.assign(ec,tc)}});var nc=n(153),rc=n.n(nc);var ic=function(e){return function(t,n,r){var i=Object(t);if(!Ve(t)){var o=So(n,3);t=Ge(t),n=function(e){return o(i[e],e,i)}}var s=e(t,n,r);return s>-1?i[o?t[s]:s]:void 0}}(Rs);var oc=function(e,t){return e===t||uo(e,t,lo(t))};
/**
 * @module converse-chat
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */const{$msg:sc,Strophe:ac,sizzle:uc,utils:cc}=Xu.env,dc=Xu.env.utils;Xu.plugins.add("converse-chat",{dependencies:["converse-chatboxes","converse-disco"],initialize(){const{__:e}=Pu;zu.settings.extend({allow_message_corrections:"all",allow_message_retraction:"all",auto_join_private_chats:[],clear_messages_on_reconnection:!1,filter_by_resource:!1,send_chat_state_notifications:!0});const t=Uo.extend({initialize(){this.rosterContactAdded=dc.getResolveablePromise()},async setRosterContact(e){const t=await zu.contacts.get(e);t&&(this.contact=t,this.set("nickname",t.get("nickname")),this.rosterContactAdded.resolve())}});Pu.Message=t.extend({defaults:()=>({msgid:dc.getUniqueId(),time:(new Date).toISOString(),is_ephemeral:!1}),async initialize(){this.checkValidity()&&(this.initialized=dc.getResolveablePromise(),"chat"===this.get("type")&&(t.prototype.initialize.apply(this,arguments),this.setRosterContact(ac.getBareJidFromJid(this.get("from")))),this.get("file")&&this.on("change:put",this.uploadFile,this),this.setTimerForEphemeralMessage(),await zu.trigger("messageInitialized",this,{Synchronous:!0}),this.initialized.resolve())},setTimerForEphemeralMessage(){const e=()=>{this.ephemeral_timer=window.setTimeout(this.safeDestroy.bind(this),1e4)};return this.isEphemeral()?(e(),!0):(this.on("change:is_ephemeral",()=>this.isEphemeral()?e():clearTimeout(this.ephemeral_timer)),!1)},checkValidity(){return 3!==Object.keys(this.attributes).length||(this.validationError="Empty message",this.safeDestroy(),!1)},mayBeRetracted(){return"me"===this.get("sender")&&["all","own"].includes(zu.settings.get("allow_message_retraction"))},safeDestroy(){try{this.destroy()}catch(e){kn.error(e)}},isEphemeral(){return this.get("is_ephemeral")},getDisplayName(){return"groupchat"===this.get("type")?this.get("nick"):this.contact?this.contact.getDisplayName():this.vcard?this.vcard.getDisplayName():this.get("from")},getMessageText(){return this.get("is_encrypted")?this.get("plaintext")||this.get("body")||e("Undecryptable OMEMO message"):this.get("message")},isMeCommand(){const e=this.getMessageText();return!!e&&e.startsWith("/me ")},sendSlotRequestStanza(){if(!this.file)return Promise.reject(new Error("file is undefined"));const e=Xu.env.$iq({from:Pu.jid,to:this.get("slot_request_url"),type:"get"}).c("request",{xmlns:ac.NS.HTTPUPLOAD,filename:this.file.name,size:this.file.size,"content-type":this.file.type});return zu.sendIQ(e)},async getRequestSlotURL(){let t;try{t=await this.sendSlotRequestStanza()}catch(t){return kn.error(t),this.save({type:"error",message:e("Sorry, could not determine upload URL."),is_ephemeral:!0})}const n=t.querySelector("slot");if(!n)return this.save({type:"error",message:e("Sorry, could not determine file upload URL."),is_ephemeral:!0});this.save({get:n.querySelector("get").getAttribute("url"),put:n.querySelector("put").getAttribute("url")})},uploadFile(){const t=new XMLHttpRequest;t.onreadystatechange=()=>{t.readyState===XMLHttpRequest.DONE&&(kn.info("Status: "+t.status),200===t.status||201===t.status?this.save({upload:Pu.SUCCESS,oob_url:this.get("get"),message:this.get("get")}):t.onerror())},t.upload.addEventListener("progress",e=>{e.lengthComputable&&this.set("progress",e.loaded/e.total)},!1),t.onerror=()=>{let n;n=t.responseText?e('Sorry, could not succesfully upload your file. Your server’s response: "%1$s"',t.responseText):e("Sorry, could not succesfully upload your file."),this.save({type:"error",upload:Pu.FAILURE,message:n,is_ephemeral:!0})},t.open("PUT",this.get("put"),!0),t.setRequestHeader("Content-type",this.file.type),t.send(this.file)}}),Pu.Messages=ea.extend({model:Pu.Message,comparator:"time"}),Pu.ChatBox=t.extend({messagesCollection:Pu.Messages,defaults(){return{bookmarked:!1,chat_state:void 0,hidden:Pu.isUniView()&&!zu.settings.get("singleton"),message_type:"chat",nickname:void 0,num_unread:0,time_sent:new Date(0).toISOString(),time_opened:this.get("time_opened")||(new Date).getTime(),type:Pu.PRIVATE_CHAT_TYPE,url:""}},async initialize(){this.initialized=dc.getResolveablePromise(),t.prototype.initialize.apply(this,arguments);const e=this.get("jid");e&&(this.set({box_id:"box-"+e}),this.initNotifications(),this.initMessages(),this.get("type")===Pu.PRIVATE_CHAT_TYPE&&(this.presence=Pu.presences.findWhere({jid:e})||Pu.presences.create({jid:e}),await this.setRosterContact(e)),this.on("change:chat_state",this.sendChatState,this),await this.fetchMessages(),await zu.trigger("chatBoxInitialized",this,{Synchronous:!0}),this.initialized.resolve())},getMessagesCacheKey(){return`converse.messages-${this.get("jid")}-${Pu.bare_jid}`},initMessages(){this.messages=new this.messagesCollection,this.messages.fetched=dc.getResolveablePromise(),this.messages.fetched.then(()=>{zu.trigger("afterMessagesFetched",this)}),this.messages.chatbox=this,this.messages.browserStorage=Pu.createStore(this.getMessagesCacheKey()),this.listenTo(this.messages,"change:upload",e=>{e.get("upload")===Pu.SUCCESS&&zu.send(this.createMessageStanza(e))})},initNotifications(){this.notifications=new Uo},afterMessagesFetched(){zu.trigger("afterMessagesFetched",this)},fetchMessages(){if(this.messages.fetched_flag)return void kn.info("Not re-fetching messages for "+this.get("jid"));this.messages.fetched_flag=!0;const e=this.messages.fetched.resolve;return this.messages.fetch({add:!0,success:()=>{this.afterMessagesFetched(),e()},error:()=>{this.afterMessagesFetched(),e()}}),this.messages.fetched},async handleErrorMessageStanza(t){const n=await fs.parseMessage(t,Pu);if(!await this.shouldShowErrorMessage(n))return;const r=this.getMessageReferencedByError(n);if(r){const t={error:n.error,error_condition:n.error_condition,error_text:n.error_text,error_type:n.error_type,editable:!1};n.msgid===r.get("retraction_id")?(t.retraction_id=void 0,n.error||("forbidden"===n.error_condition?t.error=e("You're not allowed to retract your message."):t.error=e("Sorry, an error occurred while trying to retract your message."))):n.error||("forbidden"===n.error_condition?t.error=e("You're not allowed to send a message."):t.error=e("Sorry, an error occurred while trying to send your message.")),r.save(t)}else this.createMessage(n)},queueMessage(e){return this.msg_chain=(this.msg_chain||this.messages.fetched).then(()=>this.onMessage(e)).catch(e=>kn.error(e)),this.msg_chain},async onMessage(e){if(e=await e,dc.isErrorObject(e))return e.stanza&&kn.error(e.stanza),kn.error(e.message);const t=this.getDuplicateMessage(e);if(t)this.updateMessage(t,e);else if(!this.handleReceipt(e)&&!this.handleChatMarker(e)&&!await this.handleRetraction(e)&&(this.setEditable(e,e.time),e.chat_state&&"them"===e.sender&&this.notifications.set("chat_state",e.chat_state),dc.shouldCreateMessage(e))){const t=this.handleCorrection(e)||await this.createMessage(e);this.notifications.set({chat_state:null}),this.handleUnreadMessage(t)}},async clearMessages(){try{await this.messages.clearStore()}catch(e){this.messages.trigger("reset"),kn.error(e)}finally{delete this.msg_chain,delete this.messages.fetched_flag,this.messages.fetched=dc.getResolveablePromise()}},async close(){try{await new Promise((e,t)=>this.destroy({success:e,error:(e,n)=>t(n)}))}catch(e){kn.error(e)}finally{zu.settings.get("clear_messages_on_reconnection")&&await this.clearMessages()}},announceReconnection(){zu.trigger("chatReconnected",this)},async onReconnection(){zu.settings.get("clear_messages_on_reconnection")&&await this.clearMessages(),this.announceReconnection()},validate(e){if(!e.jid)return"Ignored ChatBox without JID";const t=Pu.auto_join_rooms.map(e=>j(e)?e.jid:e),n=zu.settings.get("auto_join_private_chats").concat(t);if(zu.settings.get("singleton")&&!n.includes(e.jid)&&!zu.settings.get("auto_join_on_invite")){const t=e.jid+" is not allowed because singleton is true and it's not being auto_joined";return kn.warn(t),t}},getDisplayName(){return this.contact?this.contact.getDisplayName():this.vcard?this.vcard.getDisplayName():this.get("jid")},async createMessageFromError(e){if(e instanceof Pu.TimeoutError){(await this.createMessage({type:"error",message:e.message,retry_event_id:e.retry_event_id})).error=e}},getOldestMessage(){for(let e=0;e<this.messages.length;e++){const t=this.messages.at(e);if(t.get("type")===this.get("message_type"))return t}},getMostRecentMessage(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages.at(e);if(t.get("type")===this.get("message_type"))return t}},getUpdatedMessageAttributes:(e,t)=>(({is_archived:e})=>({is_archived:e}))(t),updateMessage(e,t){const n=this.getUpdatedMessageAttributes(e,t);n&&e.save(n)},setChatState(e,t){return void 0!==this.chat_state_timeout&&(window.clearTimeout(this.chat_state_timeout),delete this.chat_state_timeout),e===Pu.COMPOSING?this.chat_state_timeout=window.setTimeout(this.setChatState.bind(this),Pu.TIMEOUTS.PAUSED,Pu.PAUSED):e===Pu.PAUSED&&(this.chat_state_timeout=window.setTimeout(this.setChatState.bind(this),Pu.TIMEOUTS.INACTIVE,Pu.INACTIVE)),this.set("chat_state",e,t),this},getMessageReferencedByError(e){const t=e.msgid;return t&&this.messages.models.find(e=>[e.get("msgid"),e.get("retraction_id")].includes(t))},shouldShowErrorMessage(e){if(this.getMessageReferencedByError(e)||e.body)return!0},isSameUser:(e,t)=>dc.isSameBareJID(e,t),findDanglingRetraction(e){if(!e.origin_id||!this.messages.length)return null;if(this.messages.last().get("time")>e.time){const t=Array.from(this.messages.models);return t.reverse(),t.find(({attributes:t})=>t.retracted_id===e.origin_id&&t.from===e.from&&!t.moderated_by)}},async handleRetraction(e){const t=["retracted","retracted_id","editable"];if(e.retracted){if(e.is_tombstone)return!1;const n=this.messages.findWhere({origin_id:e.retracted_id,from:e.from});return n?(n.save(Lo(e,t)),!0):(e.dangling_retraction=!0,await this.createMessage(e),!0)}{const n=this.findDanglingRetraction(e);if(n){const r=Lo(n.attributes,t),i=Object.assign({dangling_retraction:!1},e,r);return delete i.id,n.save(i),!0}}return!1},handleCorrection(e){if(!e.replace_id||!e.from)return;const t=this.messages.findWhere({msgid:e.replace_id,from:e.from});if(!t)return;const n=t.get("older_versions")||{};return e.time<t.get("time")&&t.get("edited")?(n[e.time]=e.message,t.save({older_versions:n})):(Object.keys(n).length?n[t.get("edited")]=t.get("message"):n[t.get("time")]=t.get("message"),delete(e=Object.assign(e,{older_versions:n})).id,e.time=t.get("time"),t.save(e)),t},getDuplicateMessage(e){const t=[...this.getStanzaIdQueryAttrs(e),this.getOriginIdQueryAttrs(e),this.getMessageBodyQueryAttrs(e)].filter(e=>e),n=this.messages.models;return ic(n,e=>t.reduce((t,n)=>t||oc(e.attributes,n),!1))},getOriginIdQueryAttrs:e=>e.origin_id&&{origin_id:e.origin_id,from:e.from},getStanzaIdQueryAttrs:e=>Object.keys(e).filter(e=>e.startsWith("stanza_id ")).map(t=>{const n={};return n["stanza_id "+t.replace(/^stanza_id /,"")]=e[t],n}),getMessageBodyQueryAttrs(e){if(e.message&&e.msgid){const t={from:e.from,msgid:e.msgid};return e.is_encrypted||(t.message=e.message),t}},retractOwnMessage(e){this.sendRetractionMessage(e),e.save({retracted:(new Date).toISOString(),retracted_id:e.get("origin_id"),retraction_id:e.get("id"),is_ephemeral:!0,editable:!1})},sendRetractionMessage(e){const t=e.get("origin_id");if(!t)throw new Error("Can't retract message without a XEP-0359 Origin ID");const n=sc({id:dc.getUniqueId(),to:this.get("jid"),type:"chat"}).c("store",{xmlns:ac.NS.HINTS}).up().c("apply-to",{id:t,xmlns:ac.NS.FASTEN}).c("retract",{xmlns:ac.NS.RETRACT});return Pu.connection.send(n)},sendMarkerForMessage(e){if(null!=e&&e.get("is_markable")){const t=ac.getBareJidFromJid(e.get("from"));this.sendMarker(t,e.get("msgid"),"displayed",e.get("type"))}},sendMarker(e,t,n,r){const i=sc({from:Pu.connection.jid,id:dc.getUniqueId(),to:e,type:r||"chat"}).c(n,{xmlns:ac.NS.MARKERS,id:t});zu.send(i)},handleChatMarker(e){if(ac.getBareJidFromJid(e.to)!==Pu.bare_jid)return!1;if(e.is_markable)return!this.contact||e.is_archived||e.is_carbon||this.sendMarker(e.from,e.msgid,"received"),!1;if(e.marker_id){const t=this.messages.findWhere({msgid:e.marker_id}),n="marker_"+e.marker;return t&&!t.get(n)&&t.save({field_name:(new Date).toISOString()}),!0}},sendReceiptStanza(e,t){const n=sc({from:Pu.connection.jid,id:dc.getUniqueId(),to:e,type:"chat"}).c("received",{xmlns:ac.NS.RECEIPTS,id:t}).up().c("store",{xmlns:ac.NS.HINTS}).up();zu.send(n)},handleReceipt(e){if("them"===e.sender)if(e.is_valid_receipt_request)this.sendReceiptStanza(e.from,e.msgid);else if(e.receipt_id){const t=this.messages.findWhere({msgid:e.receipt_id});return t&&!t.get("received")&&t.save({received:(new Date).toISOString()}),!0}return!1},createMessageStanza(e){const t=sc({from:Pu.connection.jid,to:this.get("jid"),type:this.get("message_type"),id:e.get("edited")&&dc.getUniqueId()||e.get("msgid")}).c("body").t(e.get("message")).up().c(Pu.ACTIVE,{xmlns:ac.NS.CHATSTATES}).root();return"chat"===e.get("type")&&t.c("request",{xmlns:ac.NS.RECEIPTS}).root(),e.get("is_spoiler")&&(e.get("spoiler_hint")?t.c("spoiler",{xmlns:ac.NS.SPOILER},e.get("spoiler_hint")).root():t.c("spoiler",{xmlns:ac.NS.SPOILER}).root()),(e.get("references")||[]).forEach(e=>{const n={xmlns:ac.NS.REFERENCE,begin:e.begin,end:e.end,type:e.type};e.uri&&(n.uri=e.uri),t.c("reference",n).root()}),e.get("oob_url")&&t.c("x",{xmlns:ac.NS.OUTOFBAND}).c("url").t(e.get("oob_url")).root(),e.get("edited")&&t.c("replace",{xmlns:ac.NS.MESSAGE_CORRECT,id:e.get("msgid")}).root(),e.get("origin_id")&&t.c("origin-id",{xmlns:ac.NS.SID,id:e.get("origin_id")}).root(),t},getOutgoingMessageAttributes(e,t){const n=this.get("composing_spoiler"),r=dc.getUniqueId(),i=e?dc.httpToGeoUri(dc.shortnamesToUnicode(e),Pu):void 0;return{from:Pu.bare_jid,fullname:Pu.xmppstatus.get("fullname"),id:r,is_only_emojis:!!e&&dc.isOnlyEmojis(e),jid:this.get("jid"),message:i,msgid:r,nickname:this.get("nickname"),sender:"me",spoiler_hint:n?t:void 0,time:(new Date).toISOString(),type:this.get("message_type"),body:i,is_spoiler:n,origin_id:r}},setEditable(e,t){if(!e.is_headline&&!dc.isEmptyMessage(e)&&"me"===e.sender)if("all"===zu.settings.get("allow_message_corrections"))e.editable=!(e.file||e.retracted||"oob_url"in e);else if("last"===zu.settings.get("allow_message_corrections")&&t>this.get("time_sent")){this.set({time_sent:t});const n=this.messages.findWhere({editable:!0});n&&n.save({editable:!1}),e.editable=!(e.file||e.retracted||"oob_url"in e)}},async createMessage(e,t){e.time=e.time||(new Date).toISOString(),await this.messages.fetched;return this.messages.create(e,Object.assign({wait:!0,promise:!0},t))},async sendMessage(e,t){const n=this.getOutgoingMessageAttributes(e,t);let r=this.messages.findWhere("correcting");if(r){const e=r.get("older_versions")||{};e[r.get("time")]=r.get("message"),r.save({correcting:!1,edited:(new Date).toISOString(),message:n.message,older_versions:e,references:n.references,is_only_emojis:n.is_only_emojis,origin_id:dc.getUniqueId(),received:void 0})}else this.setEditable(n,(new Date).toISOString()),r=await this.createMessage(n);return zu.send(this.createMessageStanza(r)),zu.trigger("sendMessage",{chatbox:this,message:r}),r},sendChatState(){if(zu.settings.get("send_chat_state_notifications")&&this.get("chat_state")){const e=zu.settings.get("send_chat_state_notifications");if(Array.isArray(e)&&!e.includes(this.get("chat_state")))return;zu.send(sc({id:dc.getUniqueId(),to:this.get("jid"),type:"chat"}).c(this.get("chat_state"),{xmlns:ac.NS.CHATSTATES}).up().c("no-store",{xmlns:ac.NS.HINTS}).up().c("no-permanent-store",{xmlns:ac.NS.HINTS}))}},async sendFiles(t){var n;const r=(await zu.disco.features.get(ac.NS.HTTPUPLOAD,Pu.domain)).pop();if(!r)return void this.createMessage({message:e("Sorry, looks like file upload is not supported by your server."),type:"error",is_ephemeral:!0});const i=r.dataforms.where({FORM_TYPE:{value:ac.NS.HTTPUPLOAD,type:"hidden"}}).pop(),o=window.parseInt(null===(n=((null==i?void 0:i.attributes)||{})["max-file-size"])||void 0===n?void 0:n.value),s=null==r?void 0:r.id;s?Array.from(t).forEach(async t=>{if(!window.isNaN(o)&&window.parseInt(t.size)>o)return this.createMessage({message:e("The size of your file, %1$s, exceeds the maximum allowed by your server, which is %2$s.",t.name,rc()(o)),type:"error",is_ephemeral:!0});{const e=Object.assign(this.getOutgoingMessageAttributes(),{file:!0,progress:0,slot_request_url:s});this.setEditable(e,(new Date).toISOString());const n=await this.createMessage(e,{silent:!0});n.file=t,this.messages.trigger("add",n),n.getRequestSlotURL()}}):this.createMessage({message:e("Sorry, looks like file upload is not supported by your server."),type:"error",is_ephemeral:!0})},maybeShow(e){if(e){if(Pu.isUniView()){const e=e=>!e.get("hidden")&&e.get("jid")!==this.get("jid")&&"controlbox"!==e.get("id");Pu.chatboxes.filter(e).forEach(e=>dc.safeSave(e,{hidden:!0}))}dc.safeSave(this,{hidden:!1})}return Pu.isUniView()&&this.get("hidden")?void 0:this.trigger("show")},isHidden(){return Pu.isUniView()&&this.get("hidden")||this.isScrolledUp()||"hidden"===Pu.windowState},handleUnreadMessage(e){if(null!=e&&e.get("body")&&cc.isNewMessage(e))if(this.isHidden()){const t={num_unread:this.get("num_unread")+1};0===this.get("num_unread")&&(t.first_unread_id=e.get("id")),this.save(t)}else this.sendMarkerForMessage(e)},clearUnreadMsgCounter(){this.get("num_unread")>0&&this.sendMarkerForMessage(this.messages.last()),dc.safeSave(this,{num_unread:0})},isScrolledUp(){return this.get("scrolled",!0)}}),Pu.handleMessageStanza=async function(e){if(fs.isServerMessage(e)){const t=e.getAttribute("from");return kn.info("handleMessageStanza: Ignoring incoming server message from JID: "+t)}const t=await fs.parseMessage(e,Pu);if(dc.isErrorObject(t))return t.stanza&&kn.error(t.stanza),kn.error(t.message);const n=!!uc(`body, encrypted[xmlns="${ac.NS.OMEMO}"]`,e).length,r=await zu.chats.get(t.contact_jid,{nickname:t.nick},n);await(null==r?void 0:r.queueMessage(t));const i={stanza:e,attrs:t,chatbox:r};zu.trigger("message",i)},Pu.router.route("converse/chat?jid=:jid",(function(e){if(!cc.isValidJID(e))return kn.warn(`Invalid JID "${e}" provided in URL fragment`);zu.chats.open(e)})),zu.listen.on("chatBoxesFetched",(function(){zu.settings.get("auto_join_private_chats").forEach(e=>{Pu.chatboxes.where({jid:e}).length||("string"==typeof e?zu.chats.open(e):kn.error('Invalid jid criteria specified for "auto_join_private_chats"'))}),zu.trigger("privateChatsAutoJoined")})),zu.listen.on("presencesInitialized",(function(){Pu.connection.addHandler(e=>uc(`message > result[xmlns="${ac.NS.MAM}"]`,e).pop()?(kn.warn('Received a MAM message with type "chat".'),!0):(Pu.handleMessageStanza(e),!0),null,"message","chat"),Pu.connection.addHandler(e=>(null!==e.getAttribute("type")||Pu.handleMessageStanza(e),!0),ac.NS.RECEIPTS,"message"),Pu.connection.addHandler(e=>(async function(e){const t=ac.getBareJidFromJid(e.getAttribute("from"));if(cc.isSameBareJID(t,Pu.bare_jid))return;const n=await zu.chatboxes.get(t);null==n||n.handleErrorMessageStanza(e)}(e),!0),null,"message","error")})),zu.listen.on("clearSession",async()=>{if(Pu.shouldClearCache()){await Promise.all(Pu.chatboxes.map(e=>e.messages&&e.messages.clearStore({silent:!0})));const e=e=>e.get("type")!==Pu.CONTROLBOX_TYPE;Pu.chatboxes.clearStore({silent:!0},e)}}),Object.assign(zu,{chats:{async create(e,t){if("string"==typeof e){if(t&&(null==t||!t.fullname)){var n;const r=await zu.contacts.get(e);t.fullname=null==r||null===(n=r.attributes)||void 0===n?void 0:n.fullname}const r=zu.chats.get(e,t,!0);return r||void kn.error("Could not open chatbox for JID: "+e)}return Array.isArray(e)?Promise.all(e.forEach(async n=>{var r;const i=await zu.contacts.get(e);return t.fullname=null==i||null===(r=i.attributes)||void 0===r?void 0:r.fullname,zu.chats.get(n,t,!0).maybeShow()})):(kn.error("chats.create: You need to provide at least one JID"),null)},async open(e,t,n){if("string"==typeof e){const r=await zu.chats.get(e,t,!0);return r?r.maybeShow(n):r}if(Array.isArray(e))return Promise.all(e.map(e=>zu.chats.get(e,t,!0).then(e=>e&&e.maybeShow(n))).filter(e=>e));const r="chats.open: You need to provide at least one JID";throw kn.error(r),new Error(r)},async get(e,t={},n=!1){async function r(e){let r=await zu.chatboxes.get(e);return!r&&n?r=await zu.chatboxes.create(e,t,Pu.ChatBox):(r=r&&r.get("type")===Pu.PRIVATE_CHAT_TYPE?r:null,r&&Object.keys(t).length&&r.save(t)),r}if(void 0===e){return(await zu.chatboxes.get()).filter(e=>e.get("type")===Pu.PRIVATE_CHAT_TYPE)}return"string"==typeof e?r(e):Promise.all(e.map(e=>r(e)))}}})}});
/**
 * @module converse-disco
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description Converse plugin which add support for XEP-0030: Service Discovery
 */
const{Strophe:lc,$iq:fc,utils:hc}=Xu.env;Xu.plugins.add("converse-disco",{initialize(){function e(){if(!Pu.stream_features){const e="converse.stream-features-"+lc.getBareJidFromJid(Pu.jid);zu.promises.add("streamFeaturesAdded"),Pu.stream_features=new ea,Pu.stream_features.browserStorage=Pu.createStore(e,"session")}}function t(){zu.trigger("streamFeaturesAdded")}zu.promises.add("discoInitialized"),zu.promises.add("streamFeaturesAdded"),Pu.DiscoEntity=Uo.extend({idAttribute:"jid",initialize(e,t){this.waitUntilFeaturesDiscovered=hc.getResolveablePromise(),this.dataforms=new ea;let n="converse.dataforms-"+this.get("jid");this.dataforms.browserStorage=Pu.createStore(n,"session"),this.features=new ea,n="converse.features-"+this.get("jid"),this.features.browserStorage=Pu.createStore(n,"session"),this.listenTo(this.features,"add",this.onFeatureAdded),this.fields=new ea,n="converse.fields-"+this.get("jid"),this.fields.browserStorage=Pu.createStore(n,"session"),this.listenTo(this.fields,"add",this.onFieldAdded),this.identities=new ea,n="converse.identities-"+this.get("jid"),this.identities.browserStorage=Pu.createStore(n,"session"),this.fetchFeatures(t),this.items=new Pu.DiscoEntities,n="converse.disco-items-"+this.get("jid"),this.items.browserStorage=Pu.createStore(n,"session"),this.items.fetch()},async getIdentity(e,t){return await this.waitUntilFeaturesDiscovered,this.identities.findWhere({category:e,type:t})},async hasFeature(e){if(await this.waitUntilFeaturesDiscovered,this.features.findWhere({var:e}))return this},onFeatureAdded(e){e.entity=this,zu.trigger("serviceDiscovered",e)},onFieldAdded(e){e.entity=this,zu.trigger("discoExtensionFieldDiscovered",e)},async fetchFeatures(e){if(e.ignore_cache)this.queryInfo();else{const e=this.features.browserStorage.name,t=await this.features.browserStorage.store.getItem(e);t&&0===t.length||null===t?this.queryInfo():(this.features.fetch({add:!0,success:()=>{this.waitUntilFeaturesDiscovered.resolve(this),this.trigger("featuresDiscovered")}}),this.identities.fetch({add:!0}))}},async queryInfo(){let e;try{e=await zu.disco.info(this.get("jid"),null)}catch(e){return null===e?kn.error("Timeout for disco#info query for "+this.get("jid")):kn.error(e),void this.waitUntilFeaturesDiscovered.resolve(this)}this.onInfo(e)},onDiscoItems(e){fr()(`query[xmlns="${lc.NS.DISCO_ITEMS}"] item`,e).forEach(e=>{if(e.getAttribute("node"))return;const t=e.getAttribute("jid");if(void 0===this.items.get(t)){const e=Pu.disco_entities.get(t);e?this.items.add(e):this.items.create({jid:t})}})},async queryForItems(){if(0===this.identities.where({category:"server"}).length)return;const e=await zu.disco.items(this.get("jid"));this.onDiscoItems(e)},onInfo(e){Array.from(e.querySelectorAll("identity")).forEach(e=>{this.identities.create({category:e.getAttribute("category"),type:e.getAttribute("type"),name:e.getAttribute("name")})}),fr()(`x[type="result"][xmlns="${lc.NS.XFORM}"]`,e).forEach(e=>{const t={};fr()("field",e).forEach(e=>{var n;t[e.getAttribute("var")]={value:null===(n=e.querySelector("value"))||void 0===n?void 0:n.textContent,type:e.getAttribute("type")}}),this.dataforms.create(t)}),e.querySelector(`feature[var="${lc.NS.DISCO_ITEMS}"]`)&&this.queryForItems(),Array.from(e.querySelectorAll("feature")).forEach(t=>{this.features.create({var:t.getAttribute("var"),from:e.getAttribute("from")})}),fr()('x[type="result"][xmlns="jabber:x:data"] field',e).forEach(t=>{var n;this.fields.create({var:t.getAttribute("var"),value:null===(n=t.querySelector("value"))||void 0===n?void 0:n.textContent,from:e.getAttribute("from")})}),this.waitUntilFeaturesDiscovered.resolve(this),this.trigger("featuresDiscovered")}}),Pu.DiscoEntities=ea.extend({model:Pu.DiscoEntity,fetchEntities(){return new Promise((e,t)=>{this.fetch({add:!0,success:e,error(e,n){kn.error(n),t(new Error("Could not fetch disco entities"))}})})}});const n=this;function r(e){const t=e.getElementsByTagName("query")[0].getAttribute("node"),r={xmlns:lc.NS.DISCO_INFO};t&&(r.node=t);const i=fc({type:"result",id:e.getAttribute("id")}),o=e.getAttribute("from");return null!==o&&i.attrs({to:o}),i.c("query",r),n._identities.forEach(e=>{const t={category:e.category,type:e.type};e.name&&(t.name=e.name),e.lang&&(t["xml:lang"]=e.lang),i.c("identity",t).up()}),n._features.forEach(e=>i.c("feature",{var:e}).up()),zu.send(i.tree()),!0}async function i(){zu.disco.own.identities.add("client","web","Converse"),zu.disco.own.features.add(lc.NS.CHATSTATES),zu.disco.own.features.add(lc.NS.DISCO_INFO),zu.disco.own.features.add(lc.NS.ROSTERX),zu.settings.get("message_carbons")&&zu.disco.own.features.add(lc.NS.CARBONS),zu.trigger("addClientFeatures"),Pu.connection.addHandler(r,lc.NS.DISCO_INFO,"iq","get",null,null),Pu.disco_entities=new Pu.DiscoEntities;const e="converse.disco-entities-"+Pu.bare_jid;Pu.disco_entities.browserStorage=Pu.createStore(e,"session");const t=await Pu.disco_entities.fetchEntities();0!==t.length&&t.get(Pu.domain)||Pu.disco_entities.create({jid:Pu.domain}),zu.trigger("discoInitialized")}n._identities=[],n._features=[],zu.listen.on("userSessionInitialized",async()=>{e(),Pu.connfeedback.get("connection_status")===lc.Status.ATTACHED&&(await new Promise((e,t)=>Pu.stream_features.fetch({success:e,error:t})),t())}),zu.listen.on("beforeResourceBinding",(function(){e(),Array.from(Pu.connection.features.childNodes).forEach(e=>{Pu.stream_features.create({name:e.nodeName,xmlns:e.getAttribute("xmlns")})}),t()})),zu.listen.on("reconnected",i),zu.listen.on("connected",i),zu.listen.on("beforeTearDown",async()=>{zu.promises.add("streamFeaturesAdded"),Pu.stream_features&&(await Pu.stream_features.clearStore(),delete Pu.stream_features)}),zu.listen.on("clearSession",()=>{Pu.shouldClearCache()&&Pu.disco_entities&&(Array.from(Pu.disco_entities.models).forEach(e=>e.features.clearStore()),Array.from(Pu.disco_entities.models).forEach(e=>e.identities.clearStore()),Array.from(Pu.disco_entities.models).forEach(e=>e.dataforms.clearStore()),Array.from(Pu.disco_entities.models).forEach(e=>e.fields.clearStore()),Pu.disco_entities.clearStore(),delete Pu.disco_entities)}),Object.assign(zu,{disco:{stream:{async getFeature(e,t){if(await zu.waitUntil("streamFeaturesAdded"),!e||!t)throw new Error("name and xmlns need to be provided when calling disco.stream.getFeature");if(void 0!==Pu.stream_features||zu.connection.connected())return Pu.stream_features.findWhere({name:e,xmlns:t});{const n=`Tried to get feature ${e} ${t} but _converse.stream_features has been torn down`;kn.warn(n)}}},own:{identities:{add(e,t,r,i){for(var o=0;o<n._identities.length;o++)if(n._identities[o].category==e&&n._identities[o].type==t&&n._identities[o].name==r&&n._identities[o].lang==i)return!1;n._identities.push({category:e,type:t,name:r,lang:i})},clear(){n._identities=[]},get:()=>n._identities},features:{add(e){for(var t=0;t<n._features.length;t++)if(n._features[t]==e)return!1;n._features.push(e)},clear(){n._features=[]},get:()=>n._features}},info(e,t){const n={xmlns:lc.NS.DISCO_INFO};t&&(n.node=t);const r=fc({from:Pu.connection.jid,to:e,type:"get"}).c("query",n);return zu.sendIQ(r)},items(e,t){const n={xmlns:lc.NS.DISCO_ITEMS};return t&&(n.node=t),zu.sendIQ(fc({from:Pu.connection.jid,to:e,type:"get"}).c("query",n))},entities:{async get(e,t=!1){if(await zu.waitUntil("discoInitialized"),!e)return Pu.disco_entities;if(void 0===Pu.disco_entities&&!zu.connection.connected()){const t=`Tried to look up entity ${e} but _converse.disco_entities has been torn down`;return void kn.warn(t)}const n=Pu.disco_entities.get(e);return n||!t?n:zu.disco.entities.create(e)},create:(e,t)=>Pu.disco_entities.create({jid:e},t)},features:{async get(e,t){if(!t)throw new TypeError("You need to provide an entity JID");await zu.waitUntil("discoInitialized");let n=await zu.disco.entities.get(t,!0);if(void 0===Pu.disco_entities&&!zu.connection.connected()){const n=`Tried to get feature ${e} for ${t} but _converse.disco_entities has been torn down`;return void kn.warn(n)}n=await n.waitUntilFeaturesDiscovered;const r=[...n.items.map(t=>t.hasFeature(e)),n.hasFeature(e)];return(await Promise.all(r)).filter(j)}},supports:async(e,t)=>(await zu.disco.features.get(e,t)).length>0,async refresh(e){if(!e)throw new TypeError("api.disco.refresh: You need to provide an entity JID");await zu.waitUntil("discoInitialized");let t=await zu.disco.entities.get(e);return t?(t.features.reset(),t.fields.reset(),t.identities.reset(),t.waitUntilFeaturesDiscovered.isPending||(t.waitUntilFeaturesDiscovered=hc.getResolveablePromise()),t.queryInfo()):t=await zu.disco.entities.create(e,{ignore_cache:!0}),t.waitUntilFeaturesDiscovered},refreshFeatures:e=>zu.refresh(e),async getFeatures(e){if(!e)throw new TypeError("api.disco.getFeatures: You need to provide an entity JID");await zu.waitUntil("discoInitialized");let t=await zu.disco.entities.get(e,!0);return t=await t.waitUntilFeaturesDiscovered,t.features},async getFields(e){if(!e)throw new TypeError("api.disco.getFields: You need to provide an entity JID");await zu.waitUntil("discoInitialized");let t=await zu.disco.entities.get(e,!0);return t=await t.waitUntilFeaturesDiscovered,t.fields},async getIdentity(e,t,n){const r=await zu.disco.entities.get(n,!0);if(void 0!==r||zu.connection.connected())return r.getIdentity(e,t);{const t=`Tried to look up category ${e} for ${n} but _converse.disco_entities has been torn down`;kn.warn(t)}}}})}});const pc=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|((\\s|^)(\\*\\\\0\\/\\*|\\*\\\\O\\/\\*|\\-___\\-|\\:'\\-\\)|'\\:\\-\\)|'\\:\\-D|\\>\\:\\-\\)|>\\:\\-\\)|'\\:\\-\\(|\\>\\:\\-\\(|>\\:\\-\\(|\\:'\\-\\(|O\\:\\-\\)|0\\:\\-3|0\\:\\-\\)|0;\\^\\)|O;\\-\\)|0;\\-\\)|O\\:\\-3|\\-__\\-|\\:\\-Þ|\\:\\-Þ|\\<\\/3|<\\/3|\\:'\\)|\\:\\-D|'\\:\\)|'\\=\\)|'\\:D|'\\=D|\\>\\:\\)|>\\:\\)|\\>;\\)|>;\\)|\\>\\=\\)|>\\=\\)|;\\-\\)|\\*\\-\\)|;\\-\\]|;\\^\\)|'\\:\\(|'\\=\\(|\\:\\-\\*|\\:\\^\\*|\\>\\:P|>\\:P|X\\-P|\\>\\:\\[|>\\:\\[|\\:\\-\\(|\\:\\-\\[|\\>\\:\\(|>\\:\\(|\\:'\\(|;\\-\\(|\\>\\.\\<|>\\.<|#\\-\\)|%\\-\\)|X\\-\\)|\\\\0\\/|\\\\O\\/|0\\:3|0\\:\\)|O\\:\\)|O\\=\\)|O\\:3|B\\-\\)|8\\-\\)|B\\-D|8\\-D|\\-_\\-|\\>\\:\\\\|>\\:\\\\|\\>\\:\\/|>\\:\\/|\\:\\-\\/|\\:\\-\\.|\\:\\-P|\\:Þ|\\:Þ|\\:\\-b|\\:\\-O|O_O|\\>\\:O|>\\:O|\\:\\-X|\\:\\-#|\\:\\-\\)|\\(y\\)|\\<3|<3|\\:D|\\=D|;\\)|\\*\\)|;\\]|;D|\\:\\*|\\=\\*|\\:\\(|\\:\\[|\\=\\(|\\:@|;\\(|D\\:|\\:\\$|\\=\\$|#\\)|%\\)|X\\)|B\\)|8\\)|\\:\\/|\\:\\\\|\\=\\/|\\=\\\\|\\:L|\\=L|\\:P|\\=P|\\:b|\\:O|\\:X|\\:#|\\=X|\\=#|\\:\\)|\\=\\]|\\=\\)|\\:\\])(?=\\s|$|[!,.?]))","gi"),gc=/(?:\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f)|[#*0-9]\ufe0f?\u20e3|(?:[©®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5\udeeb\udeec\udef4-\udefa\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd71\udd73-\udd76\udd7a-\udda2\udda5-\uddaa\uddae-\uddb4\uddb7\uddba\uddbc-\uddca\uddd0\uddde-\uddff\ude70-\ude73\ude78-\ude7a\ude80-\ude82\ude90-\ude95]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,mc=Xu.env.utils;Xu.emojis={initialized:!1,initialized_promise:mc.getResolveablePromise()};const vc={"*\\0/*":"1f646","*\\O/*":"1f646","-___-":"1f611",":'-)":"1f602","':-)":"1f605","':-D":"1f605",">:-)":"1f606","':-(":"1f613",">:-(":"1f620",":'-(":"1f622","O:-)":"1f607","0:-3":"1f607","0:-)":"1f607","0;^)":"1f607","O;-)":"1f607","0;-)":"1f607","O:-3":"1f607","-__-":"1f611",":-Þ":"1f61b","</3":"1f494",":')":"1f602",":-D":"1f603","':)":"1f605","'=)":"1f605","':D":"1f605","'=D":"1f605",">:)":"1f606",">;)":"1f606",">=)":"1f606",";-)":"1f609","*-)":"1f609",";-]":"1f609",";^)":"1f609","':(":"1f613","'=(":"1f613",":-*":"1f618",":^*":"1f618",">:P":"1f61c","X-P":"1f61c",">:[":"1f61e",":-(":"1f61e",":-[":"1f61e",">:(":"1f620",":'(":"1f622",";-(":"1f622",">.<":"1f623","#-)":"1f635","%-)":"1f635","X-)":"1f635","\\0/":"1f646","\\O/":"1f646","0:3":"1f607","0:)":"1f607","O:)":"1f607","O=)":"1f607","O:3":"1f607","B-)":"1f60e","8-)":"1f60e","B-D":"1f60e","8-D":"1f60e","-_-":"1f611",">:\\":"1f615",">:/":"1f615",":-/":"1f615",":-.":"1f615",":-P":"1f61b",":Þ":"1f61b",":-b":"1f61b",":-O":"1f62e",O_O:"1f62e",">:O":"1f62e",":-X":"1f636",":-#":"1f636",":-)":"1f642","(y)":"1f44d","<3":"2764",":D":"1f603","=D":"1f603",";)":"1f609","*)":"1f609",";]":"1f609",";D":"1f609",":*":"1f618","=*":"1f618",":(":"1f61e",":[":"1f61e","=(":"1f61e",":@":"1f620",";(":"1f622","D:":"1f628",":$":"1f633","=$":"1f633","#)":"1f635","%)":"1f635","X)":"1f635","B)":"1f60e","8)":"1f60e",":/":"1f615",":\\":"1f615","=/":"1f615","=\\":"1f615",":L":"1f615","=L":"1f615",":P":"1f61b","=P":"1f61b",":b":"1f61b",":O":"1f62e",":X":"1f636",":#":"1f636","=X":"1f636","=#":"1f636",":)":"1f642","=]":"1f642","=)":"1f642",":]":"1f642"};function _c(e){if(e.indexOf("-")>-1){const t=[],n=e.split("-");for(let e=0;e<n.length;e++){let r=parseInt(n[e],16);if(r>=65536&&r<=1114111){const e=Math.floor((r-65536)/1024)+55296,t=(r-65536)%1024+56320;r=String.fromCharCode(e)+String.fromCharCode(t)}else r=String.fromCharCode(r);t.push(r)}return t.join("")}return function(e){let t="string"==typeof e?parseInt(e,16):e;return t<65536?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}(e)}function yc(){var e;return Xu.emojis.toned||(Xu.emojis.toned=(e=Object.values(Xu.emojis.json.people).filter(e=>e.sn.includes("_tone")).map(e=>e.sn.replace(/_tone[1-5]/,"")),[...new Set(e)])),Xu.emojis.toned}function bc(e){if(!Xu.emojis.initialized)throw new Error("getShortnameReferences called before emojis are initialized. To avoid this problem, first await the converse.emojis.initilaized_promise.");return[...e.matchAll(Xu.emojis.shortnames_regex)].filter(e=>e[0].length>0).map(e=>{const t=Xu.emojis.by_sn[e[0]].cp;return{cp:t,begin:e.index,end:e.index+e[0].length,shortname:e[0],emoji:t?_c(t):null}})}function wc(e){const t=[];return function(e,t){const n=/\uFE0F/g,r=String.fromCharCode(8205);String(e).replace(gc,(e,i,o)=>{const s=function(e){const t=[];let n=0,r=0;for(;r<e.length;){const i=e.charCodeAt(r++);n?(t.push((65536+(n-55296<<10)+(i-56320)).toString(16)),n=0):55296<=i&&i<=56319?n=i:t.push(i.toString(16))}return t.join("-")}(e.indexOf(r)<0?e.replace(n,""):e);s&&t(s,e,o)})}(e,(e,n,r)=>{var i;t.push({begin:r,cp:e,emoji:n,end:r+n.length,shortname:(null===(i=mc.getEmojisByAtrribute("cp")[e])||void 0===i?void 0:i.sn)||""})}),t}function Sc(e,t){let n=[e];return[...bc(e),...wc(e)].sort((e,t)=>t.begin-e.begin).forEach(e=>{const r=n.shift(),i=function(e,t={unicode_only:!1,add_title_wrapper:!1}){const n=e.emoji,r=e.shortname;if(n){if(t.unicode_only)return n;if(zu.settings.get("use_system_emojis"))return t.add_title_wrapper&&r?hu`<span title="${r}">${n}</span>`:n;{const t=zu.settings.get("emoji_image_path");return hu`<img class="emoji"
                draggable="false"
                title="${r}"
                alt="${n}"
                src="${t}/72x72/${e.cp}.png"/>`}}return t.unicode_only?r:hu`<img class="emoji"
            draggable="false"
            title="${r}"
            alt="${r}"
            src="${Xu.emojis.by_sn[r].url}">`}(e,t);n="string"==typeof i?[r.slice(0,e.begin)+i+r.slice(e.end),...n]:[r.slice(0,e.begin),i,r.slice(e.end),...n]}),n}Xu.plugins.add("converse-emoji",{initialize(){const{___:e}=Pu;zu.settings.extend({emoji_image_path:"https://twemoji.maxcdn.com/v/12.1.6/",emoji_categories:{smileys:":grinning:",people:":thumbsup:",activity:":soccer:",travel:":motorcycle:",objects:":bomb:",nature:":rainbow:",food:":hotdog:",symbols:":musical_note:",flags:":flag_ac:",custom:null},emoji_category_labels:{smileys:e("Smileys and emotions"),people:e("People"),activity:e("Activities"),travel:e("Travel"),objects:e("Objects"),nature:e("Animals and nature"),food:e("Food and drink"),symbols:e("Symbols"),flags:e("Flags"),custom:e("Stickers")}}),Pu.EmojiPicker=Uo.extend({defaults:{current_category:"smileys",current_skintone:"",scroll_position:0}});const t={};Object.assign(mc,{shortnamesToEmojis:(e,t={unicode_only:!1,add_title_wrapper:!1})=>Sc(e=function(e){return e.replace(pc,(e,t,n,r)=>{if(void 0===r||""===r||!(mc.unescapeHTML(r)in vc))return e;r=mc.unescapeHTML(r);return n+_c(vc[r].toUpperCase())})}(e),t),shortnamesToUnicode:e=>mc.shortnamesToEmojis(e,{unicode_only:!0})[0],isOnlyEmojis(e){const t=e.trim().split(/\s+/);if(0===t.length||t.length>3)return!1;return t.filter(e=>{const t=wc(mc.shortnamesToUnicode(e));return 1===t.length&&(e===t[0].shortname||e===t[0].emoji)}).length===t.length},getEmojisByAtrribute(e){if(t[e])return t[e];if("category"===e)return Xu.emojis.json;const n=Xu.emojis.list.map(t=>t[e]).filter((e,t,n)=>n.indexOf(e)==t);return t[e]={},n.forEach(n=>t[e][n]=Xu.emojis.list.find(t=>t[e]===n)),t[e]}}),Object.assign(zu,{emojis:{async initialize(){if(!Xu.emojis.initialized){Xu.emojis.initialized=!0;const{default:e}=await n.e(0).then(n.t.bind(null,326,3));Xu.emojis.json=e,Xu.emojis.by_sn=Object.keys(e).reduce((t,n)=>Object.assign(t,e[n]),{}),Xu.emojis.list=Object.values(Xu.emojis.by_sn),Xu.emojis.list.sort((e,t)=>e.sn<t.sn?-1:e.sn>t.sn?1:0),Xu.emojis.shortnames=Xu.emojis.list.map(e=>e.sn);const t=()=>Xu.emojis.shortnames.map(e=>e.replace(/[+]/g,"\\$&")).join("|");Xu.emojis.shortnames_regex=new RegExp(t(),"gi"),Xu.emojis.toned=yc(),Xu.emojis.initialized_promise.resolve()}return Xu.emojis.initialized_promise}}})}});var xc=function(e,t,n){for(var r=-1,i=e.length,o=t.length,s={};++r<i;){var a=r<o?t[r]:void 0;n(s,e[r],a)}return s};var Ec=function(e,t){return xc(e||[],t||[],ye)},Ac=Math.min;var Nc=function(e,t,n){for(var r=n?Es:xs,i=e[0].length,o=e.length,s=o,a=Array(o),u=1/0,c=[];s--;){var d=e[s];s&&t&&(d=Fr(d,De(t))),u=Ac(d.length,u),a[s]=!n&&(t||i>=120&&d.length>=120)?new Vi(s&&d):void 0}d=e[0];var l=-1,f=a[0];e:for(;++l<i&&c.length<u;){var h=d[l],p=t?t(h):h;if(h=n||0!==h?h:0,!(f?Yi(f,p):r(c,p,n))){for(s=o;--s;){var g=a[s];if(!(g?Yi(g,p):r(e[s],p,n)))continue e}f&&f.push(p),c.push(h)}}return c};var Tc=function(e){return Ns(e)?e:[]},Oc=xr((function(e){var t=Fr(e,Tc);return t.length&&t[0]===e[0]?Nc(t):[]}));
/**
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description This is the MUC utilities module.
 */
const{Strophe:jc,sizzle:Cc}=Xu.env;var Ic={computeAffiliationsDelta(e,t,n,r){const i=n.map(e=>e.jid),o=r.map(e=>e.jid);let s=Ts(i,o).map(e=>n[Us(i,e)]);return e||(s=s.concat(n.filter(e=>{const t=Us(o,e.jid);return t>=0&&e.affiliation!==r[t].affiliation}))),t&&(s=s.concat(Ts(o,i).map(e=>({jid:e,affiliation:"none"})))),s},parseMemberListIQ:e=>Cc(`query[xmlns="${jc.NS.MUC_ADMIN}"] item`,e).map(e=>{const t={affiliation:e.getAttribute("affiliation")},n=e.getAttribute("jid");Wo.isValidJID(n)?t.jid=n:t.nick=n;const r=e.getAttribute("nick");r&&(t.nick=r);return e.getAttribute("role")&&(t.role=r),t})};
/**
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description This is the form utilities module.
 */Wo.webForm2xForm=function(e){const t=e.getAttribute("name");if(!t)return null;let n;return n="checkbox"===e.getAttribute("type")?e.checked?1:0:"TEXTAREA"==e.tagName?e.value.split("\n").filter(e=>e.trim()):"SELECT"==e.tagName?Wo.getSelectValues(e):e.value,Wo.toStanza(`\n        <field var="${t}">\n            ${n.constructor===Array?n.map(e=>`<value>${e}</value>`):`<value>${n}</value>`}\n        </field>`)};var Rc=Wo;
/**
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description Pure functions to help funcitonally parse messages.
 * @todo Other parsing helpers can be made more abstract and placed here.
 */const Mc={mention_regex:/(?:\s|^)([@][\w_-]+(?:\.\w+)*)/gi,matchRegexInText:e=>t=>e.matchAll(t)},kc=(e,t)=>e.replace(RegExp("\\"+t,"ig"),"\\"+t);Mc.escapeCharacters=e=>t=>e.split("").reduce(kc,t),Mc.escapeRegexString=Mc.escapeCharacters("[\\^$.?*+(){}"),Mc.findFirstMatchInArray=e=>t=>{for(let n=0;n<e.length;n++)if(0===t.localeCompare(e[n],void 0,{sensitivity:"base"}))return e[n];return null};const Dc=([e,t],n,r)=>{let i=e,{begin:o,end:s}=n;const{value:a}=n;return o-=r,s=s-r-1,i=`${i.slice(0,o)}${a}${i.slice(s+1)}`,[i,[...t,{...n,begin:o,end:s}]]};Mc.reduceTextFromReferences=(e,t)=>t.reduce(Dc,[e,[]]);var Pc=Mc;
/**
 * @module converse-muc
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description Implements the non-view logic for XEP-0045 Multi-User Chat
 */Xu.MUC_TRAFFIC_STATES=["entered","exited"],Xu.MUC_ROLE_CHANGES=["op","deop","voice","mute"];const Fc=["301","303","333","307","321","322"],Lc={moderator:1,participant:2,visitor:3,none:2},{Strophe:Uc,$iq:zc,$build:Bc,$msg:$c,$pres:Hc,sizzle:qc}=Xu.env;Uc.addNamespace("MUC_ADMIN",Uc.NS.MUC+"#admin"),Uc.addNamespace("MUC_OWNER",Uc.NS.MUC+"#owner"),Uc.addNamespace("MUC_REGISTER","jabber:iq:register"),Uc.addNamespace("MUC_ROOMCONF",Uc.NS.MUC+"#roomconfig"),Uc.addNamespace("MUC_USER",Uc.NS.MUC+"#user"),Uc.addNamespace("MUC_HATS","xmpp:prosody.im/protocol/hats:1"),Xu.MUC_NICK_CHANGED_CODE="303",Xu.ROOM_FEATURES=["passwordprotected","unsecured","hidden","publicroom","membersonly","open","persistent","temporary","nonanonymous","semianonymous","moderated","unmoderated","mam_enabled"],Xu.ROOMSTATUS={CONNECTED:0,CONNECTING:1,NICKNAME_REQUIRED:2,PASSWORD_REQUIRED:3,DISCONNECTED:4,ENTERED:5,DESTROYED:6},Xu.plugins.add("converse-muc",{dependencies:["converse-chatboxes","converse-chat","converse-disco","converse-controlbox"],overrides:{ChatBoxes:{model(e,t){const{_converse:n}=this.__super__;return e&&e.type==n.CHATROOMS_TYPE?new n.ChatRoom(e,t):this.__super__.model.apply(this,arguments)}}},initialize(){const{__:e,___:t}=Pu;if(zu.settings.extend({allow_muc:!0,allow_muc_invitations:!0,auto_join_on_invite:!1,auto_join_rooms:[],auto_register_muc_nickname:!1,hide_muc_participants:!1,locked_muc_domain:!1,muc_domain:void 0,muc_fetch_members:!0,muc_history_max_stanzas:void 0,muc_instant_rooms:!0,muc_nickname_from_jid:!1,muc_send_probes:!1,muc_show_join_leave:!0,muc_show_logs_before_join:!1}),zu.promises.add(["roomsAutoJoined"]),zu.settings.get("locked_muc_domain")&&"string"!=typeof zu.settings.get("muc_domain"))throw new Error("Config Error: it makes no sense to set locked_muc_domain to true when muc_domain is not set");Pu.muc={info_messages:{100:e("This groupchat is not anonymous"),102:e("This groupchat now shows unavailable members"),103:e("This groupchat does not show unavailable members"),104:e("The groupchat configuration has changed"),170:e("Groupchat logging is now enabled"),171:e("Groupchat logging is now disabled"),172:e("This groupchat is now no longer anonymous"),173:e("This groupchat is now semi-anonymous"),174:e("This groupchat is now fully-anonymous"),201:e("A new groupchat has been created")},new_nickname_messages:{210:t("Your nickname has been automatically set to %1$s"),303:t("Your nickname has been changed to %1$s")},disconnect_messages:{301:e("You have been banned from this groupchat"),333:e("You have exited this groupchat due to a technical problem"),307:e("You have been kicked from this groupchat"),321:e("You have been removed from this groupchat because of an affiliation change"),322:e("You have been removed from this groupchat because the groupchat has changed to members-only and you're not a member"),332:e("You have been removed from this groupchat because the service hosting it is being shut down")}},Pu.router.route("converse/room?jid=:jid",(async function(e){if(!Rc.isValidMUCJID(e))return kn.warn(`invalid jid "${e}" provided in url fragment`);await zu.waitUntil("roomsAutoJoined"),zu.settings.get("allow_bookmarks")&&await zu.waitUntil("bookmarksInitialized"),zu.rooms.open(e)})),Pu.getDefaultMUCNickname=function(){if(!Pu.xmppstatus)throw new Error("Can't call _converse.getDefaultMUCNickname before the statusInitialized has been fired.");const e=Pu.xmppstatus.getNickname();return e||(zu.settings.get("muc_nickname_from_jid")?Uc.unescapeNode(Uc.getNodeFromJid(Pu.bare_jid)):void 0)},Pu.ChatRoomMessage=Pu.Message.extend({initialize(){this.checkValidity()&&(this.get("file")&&this.on("change:put",this.uploadFile,this),this.setTimerForEphemeralMessage()||this.setOccupant(),zu.trigger("chatRoomMessageInitialized",this))},mayBeModerated(){return["all","moderator"].includes(zu.settings.get("allow_message_retraction"))&&this.collection.chatbox.canModerateMessages()},checkValidity(){const e=Pu.Message.prototype.checkValidity.call(this);return!e&&this.collection.chatbox.debouncedRejoin(),e},onOccupantRemoved(){var e;this.stopListening(this.occupant),delete this.occupant;const t=null==this||null===(e=this.collection)||void 0===e?void 0:e.chatbox;if(!t)return kn.error("Could not get collection.chatbox for message: "+JSON.stringify(this.toJSON()));this.listenTo(t.occupants,"add",this.onOccupantAdded)},onOccupantAdded(e){if(e.get("nick")===Uc.getResourceFromJid(this.get("from"))){var t;this.occupant=e,this.trigger("occupantAdded"),this.listenTo(this.occupant,"destroy",this.onOccupantRemoved);const n=null==this||null===(t=this.collection)||void 0===t?void 0:t.chatbox;if(!n)return kn.error("Could not get collection.chatbox for message: "+JSON.stringify(this.toJSON()));this.stopListening(n.occupants,"add",this.onOccupantAdded)}},setOccupant(){var e;if("groupchat"!==this.get("type"))return;const t=null==this||null===(e=this.collection)||void 0===e?void 0:e.chatbox;if(!t)return kn.error("Could not get collection.chatbox for message: "+JSON.stringify(this.toJSON()));const n=Uc.getResourceFromJid(this.get("from"));if(this.occupant=t.occupants.findWhere({nick:n}),!this.occupant&&zu.settings.get("muc_send_probes")){this.occupant=t.occupants.create({nick:n,type:"unavailable"});const e=`${t.get("jid")}/${n}`;zu.user.presence.send("probe",e)}this.occupant?this.listenTo(this.occupant,"destroy",this.onOccupantRemoved):this.listenTo(t.occupants,"add",this.onOccupantAdded)}});const n=Uo.extend({defaults:()=>({connection_status:Xu.ROOMSTATUS.DISCONNECTED})});if(Pu.ChatRoomMessages=ea.extend({model:Pu.ChatRoomMessage,comparator:"time"}),Pu.ChatRoom=Pu.ChatBox.extend({messagesCollection:Pu.ChatRoomMessages,defaults(){return{num_unread_general:0,bookmarked:!1,chat_state:void 0,hidden:Pu.isUniView()&&!zu.settings.get("singleton"),hidden_occupants:!!zu.settings.get("hide_muc_participants"),message_type:"groupchat",name:"",num_unread:0,roomconfig:{},time_opened:this.get("time_opened")||(new Date).getTime(),time_sent:new Date(0).toISOString(),type:Pu.CHATROOMS_TYPE}},async initialize(){this.initialized=Rc.getResolveablePromise(),this.debouncedRejoin=ja(this.rejoin,250),this.set("box_id","box-"+this.get("jid")),this.initNotifications(),this.initMessages(),this.initOccupants(),this.initDiscoModels(),this.registerHandlers(),this.on("change:chat_state",this.sendChatState,this),await this.restoreSession(),this.session.on("change:connection_status",this.onConnectionStatusChanged,this),this.listenTo(this.occupants,"add",this.onOccupantAdded),this.listenTo(this.occupants,"remove",this.onOccupantRemoved),this.listenTo(this.occupants,"change:show",this.onOccupantShowChanged),this.listenTo(this.occupants,"change:affiliation",this.createAffiliationChangeMessage),this.listenTo(this.occupants,"change:role",this.createRoleChangeMessage);await this.restoreFromCache()||this.join(),await zu.trigger("chatRoomInitialized",this,{Synchronous:!0}),this.initialized.resolve()},async restoreFromCache(){return this.session.get("connection_status")===Xu.ROOMSTATUS.ENTERED&&await this.isJoined()?(await new Promise(e=>this.features.fetch({success:e,error:e})),await this.fetchOccupants().catch(e=>kn.error(e)),await this.fetchMessages().catch(e=>kn.error(e)),!0):(await this.clearCache(),!1)},async join(e,t){if(this.session.get("connection_status")===Xu.ROOMSTATUS.ENTERED)return this;if(await this.refreshDiscoInfo(),!(e=await this.getAndPersistNickname(e)))return Rc.safeSave(this.session,{connection_status:Xu.ROOMSTATUS.NICKNAME_REQUIRED}),zu.settings.get("muc_show_logs_before_join")&&await this.fetchMessages(),this;const n=Hc({from:Pu.connection.jid,to:this.getRoomJIDAndNick()}).c("x",{xmlns:Uc.NS.MUC}).c("history",{maxstanzas:this.features.get("mam_enabled")?0:zu.settings.get("muc_history_max_stanzas")}).up();return(t=t||this.get("password"))&&n.cnode(Uc.xmlElement("password",[],t)),this.session.save("connection_status",Xu.ROOMSTATUS.CONNECTING),zu.send(n),this},async clearCache(){this.session.save("connection_status",Xu.ROOMSTATUS.DISCONNECTED),this.occupants.length?this.occupants.filter(e=>!e.isMember()).forEach(e=>e.destroy()):this.occupants.clearStore(),zu.settings.get("clear_messages_on_reconnection")&&await this.clearMessages()},onOccupantAdded(e){zu.settings.get("muc_show_join_leave")&&this.session.get("connection_status")===Xu.ROOMSTATUS.ENTERED&&"online"===e.get("show")&&this.updateNotifications(e.get("nick"),"entered")},onOccupantRemoved(e){zu.settings.get("muc_show_join_leave")&&this.session.get("connection_status")===Xu.ROOMSTATUS.ENTERED&&"online"===e.get("show")&&this.updateNotifications(e.get("nick"),"exited")},onOccupantShowChanged(e){!e.get("states").includes("303")&&zu.settings.get("muc_show_join_leave")&&("offline"===e.get("show")?this.updateNotifications(e.get("nick"),"exited"):"online"===e.get("show")&&this.updateNotifications(e.get("nick"),"entered"))},rejoin(){return this.clearCache(),this.join()},async onConnectionStatusChanged(){this.session.get("connection_status")===Xu.ROOMSTATUS.ENTERED&&(await this.occupants.fetchMembers(),await this.fetchMessages(),zu.trigger("enteredNewRoom",this),zu.settings.get("auto_register_muc_nickname")&&await zu.disco.supports(Uc.NS.MUC_REGISTER,this.get("jid"))&&this.registerNickname())},async onReconnection(){this.registerHandlers(),await this.rejoin(),this.announceReconnection()},restoreSession(){const e=`muc.session-${Pu.bare_jid}-${this.get("jid")}`;return this.session=new n({id:e}),this.session.browserStorage=Pu.createStore(e,"session"),new Promise(e=>this.session.fetch({success:e,error:e}))},initDiscoModels(){let e=`converse.muc-features-${Pu.bare_jid}-${this.get("jid")}`;this.features=new Uo(Object.assign({id:e},Ec(Xu.ROOM_FEATURES,Xu.ROOM_FEATURES.map(()=>!1)))),this.features.browserStorage=Pu.createStore(e,"session"),e="converse.muc-config-{_converse.bare_jid}-"+this.get("jid"),this.config=new Uo,this.config.browserStorage=Pu.createStore(e,"session")},initOccupants(){this.occupants=new Pu.ChatRoomOccupants;const e=`converse.occupants-${Pu.bare_jid}${this.get("jid")}`;this.occupants.browserStorage=Pu.createStore(e,"session"),this.occupants.chatroom=this},fetchOccupants(){return this.occupants.fetched=new Promise(e=>{this.occupants.fetch({add:!0,silent:!0,success:e,error:e})}),this.occupants.fetched},handleAffiliationChangedMessage(e){const t=qc(`x[xmlns="${Uc.NS.MUC_USER}"] item`,e).pop();if(t){const n=e.getAttribute("from"),r=e.getAttribute("type"),i=t.getAttribute("affiliation"),o=t.getAttribute("jid"),s={from:n,type:r,affiliation:i,nick:Uc.getNodeFromJid(o),states:[],show:"unavailable"==r?"offline":"online",role:t.getAttribute("role"),jid:Uc.getBareJidFromJid(o),resource:Uc.getResourceFromJid(o)},a=this.occupants.findOccupant({jid:s.jid});a?a.save(s):this.occupants.create(s)}},async handleErrorMessageStanza(t){const n=await fs.parseMUCMessage(t,this,Pu);if(!await this.shouldShowErrorMessage(n))return;const r=this.getMessageReferencedByError(n);if(r){const t={error:n.error,error_condition:n.error_condition,error_text:n.error_text,error_type:n.error_type,editable:!1};n.msgid===r.get("retraction_id")?(t.retraction_id=void 0,n.error||("forbidden"===n.error_condition?t.error=e("You're not allowed to retract your message."):"not-acceptable"===n.error_condition?t.error=e("Your retraction was not delivered because you're not present in the groupchat."):t.error=e("Sorry, an error occurred while trying to retract your message."))):n.error||("forbidden"===n.error_condition?t.error=e("Your message was not delivered because you weren't allowed to send it."):"not-acceptable"===n.error_condition?t.error=e("Your message was not delivered because you're not present in the groupchat."):t.error=e("Sorry, an error occurred while trying to send your message.")),r.save(t)}else this.createMessage(n)},async handleMessageStanza(e){if(fs.isArchived(e))return kn.warn('Received a MAM message with type "groupchat"');this.createInfoMessages(e),this.fetchFeaturesIfConfigurationChanged(e);const t=await fs.parseMUCMessage(e,this,Pu),n={stanza:e,attrs:t,chatbox:this};return zu.trigger("message",n),t&&this.queueMessage(t)},registerHandlers(){const e=this.get("jid");this.removeHandlers(),this.presence_handler=Pu.connection.addHandler(e=>this.onPresence(e)||!0,null,"presence",null,null,e,{ignoreNamespaceFragment:!0,matchBareFromJid:!0}),this.message_handler=Pu.connection.addHandler(e=>!!this.handleMessageStanza(e)||!0,null,"message","groupchat",null,e,{matchBareFromJid:!0}),this.affiliation_message_handler=Pu.connection.addHandler(e=>this.handleAffiliationChangedMessage(e)||!0,Uc.NS.MUC_USER,"message",null,null,e)},removeHandlers(){return this.message_handler&&(Pu.connection&&Pu.connection.deleteHandler(this.message_handler),delete this.message_handler),this.presence_handler&&(Pu.connection&&Pu.connection.deleteHandler(this.presence_handler),delete this.presence_handler),this.affiliation_message_handler&&(Pu.connection&&Pu.connection.deleteHandler(this.affiliation_message_handler),delete this.affiliation_message_handler),this},invitesAllowed(){return zu.settings.get("allow_muc_invitations")&&(this.features.get("open")||"owner"===this.getOwnAffiliation())},getDisplayName(){const e=this.get("name");return e||("hidden"===zu.settings.get("locked_muc_domain")?Uc.getNodeFromJid(this.get("jid")):this.get("jid"))},sendTimedMessage(e){"function"==typeof e.tree&&(e=e.tree());let t=e.getAttribute("id");t||(t=this.getUniqueId("sendIQ"),e.setAttribute("id",t));const n=Rc.getResolveablePromise(),r=Pu.connection.addTimedHandler(Pu.STANZA_TIMEOUT,()=>(Pu.connection.deleteHandler(i),n.reject(new Pu.TimeoutError("Timeout Error: No response from server")),!1)),i=Pu.connection.addHandler(e=>{r&&Pu.connection.deleteTimedHandler(r),"groupchat"===e.getAttribute("type")?n.resolve(e):n.reject(e)},null,"message",["error","groupchat"],t);return zu.send(e),n},async retractOwnMessage(t){const n=t.get("origin_id");if(!n)throw new Error("Can't retract message without a XEP-0359 Origin ID");const r=t.get("editable"),i=$c({id:Rc.getUniqueId(),to:this.get("jid"),type:"groupchat"}).c("store",{xmlns:Uc.NS.HINTS}).up().c("apply-to",{id:n,xmlns:Uc.NS.FASTEN}).c("retract",{xmlns:Uc.NS.RETRACT});t.set({retracted:(new Date).toISOString(),retracted_id:n,retraction_id:i.nodeTree.getAttribute("id"),editable:!1});try{await this.sendTimedMessage(i)}catch(n){throw t.save({editable:r,error_type:"timeout",error:e("A timeout happened while while trying to retract your message."),retracted:void 0,retracted_id:void 0}),n}},async retractOtherMessage(e,t){const n=e.get("editable");e.save({moderated:"retracted",moderated_by:Pu.bare_jid,moderated_id:e.get("msgid"),moderation_reason:t,editable:!1});const r=await this.sendRetractionIQ(e,t);return(null===r||Rc.isErrorStanza(r))&&e.save({editable:n,moderated:void 0,moderated_by:void 0,moderated_id:void 0,moderation_reason:void 0}),r},sendRetractionIQ(e,t){const n=zc({to:this.get("jid"),type:"set"}).c("apply-to",{id:e.get("stanza_id "+this.get("jid")),xmlns:Uc.NS.FASTEN}).c("moderate",{xmlns:Uc.NS.MODERATE}).c("retract",{xmlns:Uc.NS.RETRACT}).up().c("reason").t(t||"");return zu.sendIQ(n,null,!1)},sendDestroyIQ(e,t){const n=Bc("destroy");t&&n.attrs({jid:t});const r=zc({to:this.get("jid"),type:"set"}).c("query",{xmlns:Uc.NS.MUC_OWNER}).cnode(n.node);return e&&e.length>0&&r.c("reason",e),zu.sendIQ(r)},async leave(e){if(this.features.destroy(),this.occupants.clearStore(),Pu.disco_entities){const e=Pu.disco_entities.get(this.get("jid"));e&&await new Promise((t,n)=>e.destroy({success:t,error:n}))}zu.connection.connected()&&zu.user.presence.send("unavailable",this.getRoomJIDAndNick(),e),Rc.safeSave(this.session,{connection_status:Xu.ROOMSTATUS.DISCONNECTED}),this.removeHandlers()},async close(){return await new Promise(e=>this.session.destroy({success:e,error:(t,n)=>{kn.error(n),e()}})),await new Promise(e=>this.features.destroy({success:e,error:(t,n)=>{kn.error(n),e()}})),Pu.ChatBox.prototype.close.call(this)},canModerateMessages(){const e=this.getOwnOccupant();return e&&e.isModerator()&&zu.disco.supports(Uc.NS.MODERATE,this.get("jid"))},getAllKnownNicknames(){return[...new Set([...this.occupants.map(e=>e.get("nick")),...this.messages.map(e=>e.get("nick"))])].filter(e=>e)},getAllKnownNicknamesRegex(){const e=this.getAllKnownNicknames().join("|"),t=Pc.escapeRegexString(e);return RegExp(`(?:\\s|^)@(${t})(?![\\w@-])`,"ig")},getOccupantByJID(e){return this.occupants.findOccupant({jid:e})},getOccupantByNickname(e){return this.occupants.findOccupant({nick:e})},parseTextForReferences(e){if(!e)return["",[]];const t=Pc.matchRegexInText(e);if(!t(Pc.mention_regex))return[e,[]];const n=this.getAllKnownNicknames(),r=Pc.findFirstMatchInArray(n),i=e=>{const t=this.get("jid"),n=this.getOccupant(e)||this.getOccupant(t),r=n&&n.get("jid")||`${t}/${e}`;return encodeURI("xmpp:"+r)},o=[...t(this.getAllKnownNicknamesRegex())].map(e=>{const t=e[0].indexOf("@"),n=e.index+t,o=n+e[0].length-t,s=r(e[1]);return{begin:n,end:o,value:s,type:"mention",uri:i(s)}}),[s,a]=Pc.reduceTextFromReferences(e,o);return[s,a]},getOutgoingMessageAttributes(e,t){const n=this.get("composing_spoiler"),[r,i]=this.parseTextForReferences(e),o=Rc.getUniqueId(),s=r?Rc.httpToGeoUri(Rc.shortnamesToUnicode(r),Pu):void 0;return{body:s,is_spoiler:n,origin_id:o,references:i,id:o,msgid:o,from:`${this.get("jid")}/${this.get("nick")}`,fullname:this.get("nick"),is_only_emojis:!!r&&Rc.isOnlyEmojis(r),message:s,nick:this.get("nick"),sender:"me",spoiler_hint:n?t:void 0,type:"groupchat"}},getRoomJIDAndNick(){const e=this.get("nick");return Uc.getBareJidFromJid(this.get("jid"))+(null!==e?"/"+e:"")},sendChatState(){if(!zu.settings.get("send_chat_state_notifications")||!this.get("chat_state")||this.session.get("connection_status")!==Xu.ROOMSTATUS.ENTERED||this.features.get("moderated")&&"visitor"===this.getOwnRole())return;const e=zu.settings.get("send_chat_state_notifications");if(Array.isArray(e)&&!e.includes(this.get("chat_state")))return;const t=this.get("chat_state");t!==Pu.GONE&&zu.send($c({to:this.get("jid"),type:"groupchat"}).c(t,{xmlns:Uc.NS.CHATSTATES}).up().c("no-store",{xmlns:Uc.NS.HINTS}).up().c("no-permanent-store",{xmlns:Uc.NS.HINTS}))},directInvite(e,t){this.features.get("membersonly")&&this.updateMemberLists([{jid:e,affiliation:"member",reason:t}]);const n={xmlns:"jabber:x:conference",jid:this.get("jid")};null!==t&&(n.reason=t),this.get("password")&&(n.password=this.get("password"));const r=$c({from:Pu.connection.jid,to:e,id:Rc.getUniqueId()}).c("x",n);zu.send(r),zu.trigger("roomInviteSent",{room:this,recipient:e,reason:t})},refreshDiscoInfo(){return zu.disco.refresh(this.get("jid")).then(()=>this.getDiscoInfo()).catch(e=>kn.error(e))},getDiscoInfo(){return zu.disco.getIdentity("conference","text",this.get("jid")).then(e=>this.save({name:null==e?void 0:e.get("name")})).then(()=>this.getDiscoInfoFields()).then(()=>this.getDiscoInfoFeatures()).catch(e=>kn.error(e))},async getDiscoInfoFields(){const e=(await zu.disco.getFields(this.get("jid"))).reduce((e,t)=>{const n=t.get("var");return n&&n.startsWith("muc#roominfo_")&&(e[n.replace("muc#roominfo_","")]=t.get("value")),e},{});this.config.save(e)},async getDiscoInfoFeatures(){const e=await zu.disco.getFeatures(this.get("jid")),t=Object.assign(Ec(Xu.ROOM_FEATURES,Xu.ROOM_FEATURES.map(()=>!1)),{fetched:(new Date).toISOString()});e.each(e=>{const n=e.get("var");n.startsWith("muc_")?t[n.replace("muc_","")]=!0:n===Uc.NS.MAM&&(t.mam_enabled=!0)}),this.features.save(t)},setAffiliation(e,t){return t=t.filter(t=>void 0===t.affiliation||t.affiliation===e),Promise.all(t.map(t=>this.sendAffiliationIQ(e,t)))},addFieldValue(e){const t=e.getAttribute("type");if("fixed"===t)return e;const n=e.getAttribute("var").replace("muc#roomconfig_",""),r=this.get("roomconfig");if(n in r){let i;switch(t){case"boolean":i=[r[n]?1:0];break;case"list-multi":i=r[n];break;default:i=[r[n]]}e.innerHTML=i.map(e=>Bc("value").t(e)).join("")}return e},async autoConfigureChatRoom(){const e=await this.fetchRoomConfiguration(),t=qc("field",e).map(e=>this.addFieldValue(e));if(t.length)return this.sendConfiguration(t)},fetchRoomConfiguration(){return zu.sendIQ(zc({to:this.get("jid"),type:"get"}).c("query",{xmlns:Uc.NS.MUC_OWNER}))},sendConfiguration(e=[]){const t=zc({to:this.get("jid"),type:"set"}).c("query",{xmlns:Uc.NS.MUC_OWNER}).c("x",{xmlns:Uc.NS.XFORM,type:"submit"});return e.forEach(e=>t.cnode(e).up()),zu.sendIQ(t)},getOwnRole(){var e,t;return null===(e=this.getOwnOccupant())||void 0===e||null===(t=e.attributes)||void 0===t?void 0:t.role},getOwnAffiliation(){var e,t;return null===(e=this.getOwnOccupant())||void 0===e||null===(t=e.attributes)||void 0===t?void 0:t.affiliation},getOwnOccupant(){return this.occupants.findWhere({jid:Pu.bare_jid})},sendAffiliationIQ(e,t){const n=zc({to:this.get("jid"),type:"set"}).c("query",{xmlns:Uc.NS.MUC_ADMIN}).c("item",{affiliation:t.affiliation||e,nick:t.nick,jid:t.jid});return void 0!==t.reason&&n.c("reason",t.reason),zu.sendIQ(n)},setAffiliations(e){const t=[...new Set(e.map(e=>e.affiliation))];return Promise.all(t.map(t=>this.setAffiliation(t,e)))},setRole(e,t,n,r,i){const o=Bc("item",{nick:e.get("nick"),role:t}),s=zc({to:this.get("jid"),type:"set"}).c("query",{xmlns:Uc.NS.MUC_ADMIN}).cnode(o.node);return null!==n&&s.c("reason",n),zu.sendIQ(s).then(r).catch(i)},getOccupant(e){return Rc.isValidJID(e)?this.getOccupantByJID(e):this.getOccupantByNickname(e)},getOccupantsWithRole(e){return this.getOccupantsSortedBy("nick").filter(t=>t.get("role")===e).map(e=>({jid:e.get("jid"),nick:e.get("nick"),role:e.get("role")}))},getOccupantsWithAffiliation(e){return this.getOccupantsSortedBy("nick").filter(t=>t.get("affiliation")===e).map(e=>({jid:e.get("jid"),nick:e.get("nick"),affiliation:e.get("affiliation")}))},getOccupantsSortedBy(e){return Array.from(this.occupants.models).sort((t,n)=>t.get(e)<n.get(e)?-1:t.get(e)>n.get(e)?1:0)},async getAffiliationList(e){const t=zc({to:this.get("jid"),type:"get"}).c("query",{xmlns:Uc.NS.MUC_ADMIN}).c("item",{affiliation:e}),n=await zu.sendIQ(t,null,!1);if(null===n){const t=`Error: timeout while fetching ${e} list for MUC ${this.get("jid")}`,r=new Error(t);return kn.warn(t),kn.warn(n),r}if(Rc.isErrorStanza(n)){const t=`Error: not allowed to fetch ${e} list for MUC ${this.get("jid")}`,r=new Error(t);return kn.warn(t),kn.warn(n),r}return Ic.parseMemberListIQ(n).filter(e=>e).sort((e,t)=>e.nick<t.nick?-1:e.nick>t.nick?1:0)},async updateMemberLists(e){const t=(await Promise.all(["member","admin","owner"].map(e=>this.getAffiliationList(e)))).reduce((e,t)=>Rc.isErrorObject(t)?e:[...t,...e],[]);await this.setAffiliations(Ic.computeAffiliationsDelta(!0,!1,e,t)),await this.occupants.fetchMembers()},async getAndPersistNickname(e){return(e=e||this.get("nick")||await this.getReservedNick()||Pu.getDefaultMUCNickname())&&this.save({nick:e},{silent:!0}),e},async getReservedNick(){const e=zc({to:this.get("jid"),from:Pu.connection.jid,type:"get"}).c("query",{xmlns:Uc.NS.DISCO_INFO,node:"x-roomuser-item"}),t=await zu.sendIQ(e,null,!1);if(Rc.isErrorObject(t))throw t;const n=t.querySelector('query[node="x-roomuser-item"] identity');return n?n.getAttribute("name"):null},async registerNickname(){const t=this.get("nick"),n=this.get("jid");let r,i;try{r=await zu.sendIQ(zc({to:n,from:Pu.connection.jid,type:"get"}).c("query",{xmlns:Uc.NS.MUC_REGISTER}))}catch(t){return qc(`not-allowed[xmlns="${Uc.NS.STANZAS}"]`,t).length?i=e("You're not allowed to register yourself in this groupchat."):qc(`registration-required[xmlns="${Uc.NS.STANZAS}"]`,t).length&&(i=e("You're not allowed to register in this groupchat because it's members-only.")),kn.error(t),i}const o=qc("field required",r).map(e=>e.parentElement);if(o.length>1&&"muc#register_roomnick"!==o[0].getAttribute("var"))return kn.error(`Can't register the user register in the groupchat ${n} due to the required fields`);try{await zu.sendIQ(zc({to:n,from:Pu.connection.jid,type:"set"}).c("query",{xmlns:Uc.NS.MUC_REGISTER}).c("x",{xmlns:Uc.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#register").up().up().c("field",{var:"muc#register_roomnick"}).c("value").t(t))}catch(t){return qc(`service-unavailable[xmlns="${Uc.NS.STANZAS}"]`,t).length?i=e("Can't register your nickname in this groupchat, it doesn't support registration."):qc(`bad-request[xmlns="${Uc.NS.STANZAS}"]`,t).length&&(i=e("Can't register your nickname in this groupchat, invalid data form supplied.")),kn.error(i),kn.error(t),i}},updateOccupantsOnPresence(e){var t,n;const r=fs.parseMUCPresence(e);if("error"===r.type||!r.jid&&!r.nick)return!0;const i=this.occupants.findOccupant(r);if("unavailable"===r.type&&i&&!r.states.includes(Xu.MUC_NICK_CHANGED_CODE)&&!["admin","owner","member"].includes(r.affiliation))return i.set(r),void i.destroy();const o=r.jid||"",s=Object.assign(r,{jid:Uc.getBareJidFromJid(o)||(null==i||null===(t=i.attributes)||void 0===t?void 0:t.jid),resource:Uc.getResourceFromJid(o)||(null==i||null===(n=i.attributes)||void 0===n?void 0:n.resource)});i?i.save(s):this.occupants.create(s)},fetchFeaturesIfConfigurationChanged(e){const t=["104","170","171","172","173","174"];qc("status",e).filter(e=>t.includes(e.getAttribute("status"))).length&&this.refreshDiscoInfo()},isSameUser(e,t){const n=Uc.getBareJidFromJid(e),r=Uc.getBareJidFromJid(t),i=Uc.getResourceFromJid(e),o=Uc.getResourceFromJid(t);if(Rc.isSameBareJID(e,t))return n!==this.get("jid")||i===o;return(n===this.get("jid")?this.occupants.findOccupant({nick:i}):this.occupants.findOccupant({jid:n}))===(r===this.get("jid")?this.occupants.findOccupant({nick:o}):this.occupants.findOccupant({jid:r}))},async isSubjectHidden(){return(await zu.user.settings.get("mucs_with_hidden_subject",[])).includes(this.get("jid"))},async toggleSubjectHiddenState(){const e=this.get("jid"),t=await zu.user.settings.get("mucs_with_hidden_subject",[]);t.includes(this.get("jid"))?zu.user.settings.set("mucs_with_hidden_subject",t.filter(t=>t!==e)):zu.user.settings.set("mucs_with_hidden_subject",[...t,e])},async handleSubjectChange(t){if("string"==typeof t.subject&&!t.thread&&!t.message){const n=t.subject,r=t.nick;if(Rc.safeSave(this,{subject:{author:r,text:t.subject||""}}),!t.is_delayed&&r){const i=e(n?"Topic set by %1$s":"Topic cleared by %1$s",r),o=this.messages.last();(null==o?void 0:o.get("nick"))===t.nick&&"info"===(null==o?void 0:o.get("type"))&&(null==o?void 0:o.get("message"))===i||this.createMessage({message:i,nick:t.nick,type:"info"}),await this.isSubjectHidden()&&this.toggleSubjectHiddenState()}return!0}return!1},setSubject(e=""){zu.send($c({to:this.get("jid"),from:Pu.connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(e).tree())},ignorableCSN(e){return e.chat_state&&!e.body&&(e.is_delayed||this.isOwnMessage(e))},isOwnMessage(e){let t;return t=In(e)?e.getAttribute("from"):e instanceof Pu.Message?e.get("from"):e.from,Uc.getResourceFromJid(t)==this.get("nick")},getUpdatedMessageAttributes(e,t){const n=Pu.ChatBox.prototype.getUpdatedMessageAttributes.call(this,e,t);if(this.isOwnMessage(t)){const r=Object.keys(t).filter(e=>e.startsWith("stanza_id"));Object.assign(n,Lo(t,r)),e.get("received")||(n.received=(new Date).toISOString())}return n},async isJoined(){const e=this.get("jid"),t=zc({to:`${e}/${this.get("nick")}`,type:"get"}).c("ping",{xmlns:Uc.NS.PING});try{await zu.sendIQ(t)}catch(t){return null===t?kn.warn("isJoined: Timeout error while checking whether we're joined to MUC: "+e):kn.warn("isJoined: Apparently we're no longer connected to MUC: "+e),!1}return!0},async rejoinIfNecessary(){if(!await this.isJoined())return this.rejoin(),!0},async shouldShowErrorMessage(e){return("not-acceptable"!==e.error_condition||!await this.rejoinIfNecessary())&&Pu.ChatBox.prototype.shouldShowErrorMessage.call(this,e)},findDanglingModeration(e){if(!this.messages.length)return null;if(this.messages.last().get("time")>e.time){const t=Array.from(this.messages.models),n=e["stanza_id "+this.get("jid")];return n?(t.reverse(),t.find(({attributes:e})=>"retracted"===e.moderated&&e.moderated_id===n&&e.moderated_by)):null}},async handleModeration(e){const t=["editable","moderated","moderated_by","moderated_id","moderation_reason"];if("retracted"===e.moderated){const n={};n["stanza_id "+this.get("jid")]=e.moderated_id;const r=this.messages.findWhere(n);return r?(r.save(Lo(e,t)),!0):(e.dangling_moderation=!0,await this.createMessage(e),!0)}{const n=this.findDanglingModeration(e);if(n){const r=Lo(n.attributes,t),i=Object.assign({dangling_moderation:!1},e,r);return delete i.id,n.save(i),!0}}return!1},removeNotification(e,t){const n=this.notifications.toJSON();(t=Array.isArray(t)?t:[t]).forEach(t=>{const r=Array.from(n[t]||[]);if(r.includes(e)){const n=r.indexOf(e);r.splice(n,1),this.notifications.set(t,Array.from(r))}})},updateNotifications(e,t){const n=this.notifications.toJSON(),r=n[t]||[];if(r.includes(e))return;const i=(i,o)=>(i[o]=o===t?[...r,e]:(n[o]||[]).filter(t=>t!==e),i),o=Xu.CHAT_STATES.reduce(i,{}),s=Xu.MUC_TRAFFIC_STATES.reduce(i,{}),a=Xu.MUC_ROLE_CHANGES.reduce(i,{});this.notifications.set(Object.assign(o,s,a)),window.setTimeout(()=>this.removeNotification(e,t),1e4)},async onMessage(e){if(e=await e,Rc.isErrorObject(e))return e.stanza&&kn.error(e.stanza),kn.error(e.message);const t=this.getDuplicateMessage(e);if(t)return this.updateMessage(t,e);if(!(e.is_valid_receipt_request||e.is_marker||this.ignorableCSN(e))){if(await this.handleRetraction(e)||await this.handleModeration(e)||await this.handleSubjectChange(e))return this.removeNotification(e.nick,["composing","paused"]);if(this.setEditable(e,e.time),e.chat_state&&this.updateNotifications(e.nick,e.chat_state),Rc.shouldCreateGroupchatMessage(e)){const t=this.handleCorrection(e)||await this.createMessage(e);this.removeNotification(e.nick,["composing","paused"]),this.handleUnreadMessage(t)}}},handleModifyError(e){var t;const n=null===(t=e.querySelector("error text"))||void 0===t?void 0:t.textContent;if(n)if(this.session.get("connection_status")===Xu.ROOMSTATUS.CONNECTING)this.setDisconnectionMessage(n);else{const e={type:"error",message:n,is_ephemeral:!0};this.createMessage(e)}},handleDisconnection(e){var t;const n=null!==e.querySelector("status[code='110']"),r=qc(`x[xmlns="${Uc.NS.MUC_USER}"]`,e).pop();if(!r)return;const i=qc("status",r).map(e=>e.getAttribute("code")),o=Oc(i,Object.keys(Pu.muc.disconnect_messages));if(!(n&&o.length>0))return;const s=r.querySelector("item"),a=s?null===(t=s.querySelector("reason"))||void 0===t?void 0:t.textContent:void 0,u=s?Ca(s.querySelector("actor"),"getAttribute","nick"):void 0,c=Pu.muc.disconnect_messages[o[0]];this.setDisconnectionMessage(c,a,u)},getActionInfoMessage:(t,n,r)=>"301"===t?r?e("%1$s has been banned by %2$s",n,r):e("%1$s has been banned",n):"303"===t?e("%1$s's nickname has changed",n):"307"===t?r?e("%1$s has been kicked out by %2$s",n,r):e("%1$s has been kicked out",n):"321"===t?e("%1$s has been removed because of an affiliation change",n):"322"===t?e("%1$s has been removed for not being a member",n):void 0,createAffiliationChangeMessage(t){const n=t._previousAttributes.affiliation;if(!n)return;const r=t.get("affiliation");"admin"===n?this.createMessage({type:"info",message:e("%1$s is no longer an admin of this groupchat",t.get("nick"))}):"owner"===n?this.createMessage({type:"info",message:e("%1$s is no longer an owner of this groupchat",t.get("nick"))}):"outcast"===n&&this.createMessage({type:"info",message:e("%1$s is no longer banned from this groupchat",t.get("nick"))}),"none"===r&&"member"===n&&this.createMessage({type:"info",message:e("%1$s is no longer a member of this groupchat",t.get("nick"))}),"member"===r?this.createMessage({type:"info",message:e("%1$s is now a member of this groupchat",t.get("nick"))}):"admin"!==r&&"owner"!=r||this.createMessage({type:"info",message:e("%1$s is now an %2$s of this groupchat",t.get("nick"),r)})},createRoleChangeMessage(e,t){if("none"===t||e.changed.affiliation)return;const n=e._previousAttributes.role;"moderator"===n?this.updateNotifications(e.get("nick"),"deop"):"visitor"===n&&this.updateNotifications(e.get("nick"),"voice"),"visitor"===e.get("role")?this.updateNotifications(e.get("nick"),"mute"):"moderator"===e.get("role")&&(["owner","admin"].includes(e.get("affiliation"))||this.updateNotifications(e.get("nick"),"op"))},createInfoMessage(t,n,r){const i={type:"info"};if("110"!==t&&("100"!==t||r)){if(t in Pu.muc.info_messages)i.message=Pu.muc.info_messages[t];else if(!r&&Fc.includes(t)){var o,s;const e=Uc.getResourceFromJid(n.getAttribute("from")),r=n.querySelector(`x[xmlns="${Uc.NS.MUC_USER}"] item`);i.actor=r?null===(o=r.querySelector("actor"))||void 0===o?void 0:o.getAttribute("nick"):void 0,i.reason=r?null===(s=r.querySelector("reason"))||void 0===s?void 0:s.textContent:void 0,i.message=this.getActionInfoMessage(t,e,i.actor)}else if(r&&t in Pu.muc.new_nickname_messages){let o;r&&"210"===t?o=Uc.getResourceFromJid(n.getAttribute("from")):r&&"303"===t&&(o=n.querySelector(`x[xmlns="${Uc.NS.MUC_USER}"] item`).getAttribute("nick")),this.save("nick",o),i.message=e(Pu.muc.new_nickname_messages[t],o)}if(i.message){if("201"===t&&this.messages.findWhere(i))return;if(t in Pu.muc.info_messages&&this.messages.length&&this.messages.pop().get("message")===i.message)return;this.createMessage(i)}}},createInfoMessages(e){const t=qc(`x[xmlns="${Uc.NS.MUC_USER}"] status`,e).map(e=>e.getAttribute("code"));t.includes("333")&&t.includes("307")&&t.splice(t.indexOf("307"),1);const n=t.includes("110");t.forEach(t=>this.createInfoMessage(t,e,n))},setDisconnectionMessage(e,t,n){this.save({disconnection_message:e,disconnection_reason:t,disconnection_actor:n}),this.session.save({connection_status:Xu.ROOMSTATUS.DISCONNECTED})},onNicknameClash(t){if(zu.settings.get("muc_nickname_from_jid")){const e=t.getAttribute("from").split("/")[1];if(e===Pu.getDefaultMUCNickname())this.join(e+"-2");else{const t=e.lastIndexOf("-"),n=e.substring(t+1,e.length);this.join(e.substring(0,t+1)+String(Number(n)+1))}}else this.save({nickname_validation_message:e("The nickname you chose is reserved or currently in use, please choose a different one.")}),this.session.save({connection_status:Xu.ROOMSTATUS.NICKNAME_REQUIRED})},onErrorPresence(t){var n;const r=t.querySelector("error"),i=r.getAttribute("type"),o=null===(n=qc(`text[xmlns="${Uc.NS.STANZAS}"]`,r).pop())||void 0===n?void 0:n.textContent;if("modify"===i)this.handleModifyError(t);else if("auth"===i){if(qc(`not-authorized[xmlns="${Uc.NS.STANZAS}"]`,r).length&&(this.save({password_validation_message:o||e("Password incorrect")}),this.session.save({connection_status:Xu.ROOMSTATUS.PASSWORD_REQUIRED})),r.querySelector("registration-required")){const t=e("You are not on the member list of this groupchat.");this.setDisconnectionMessage(t,o)}else if(r.querySelector("forbidden")){const t=e("You have been banned from this groupchat.");this.setDisconnectionMessage(t,o)}}else if("cancel"===i)if(r.querySelector("not-allowed")){const t=e("You are not allowed to create new groupchats.");this.setDisconnectionMessage(t,o)}else if(r.querySelector("not-acceptable")){const t=e("Your nickname doesn't conform to this groupchat's policies.");this.setDisconnectionMessage(t,o)}else if(qc(`gone[xmlns="${Uc.NS.STANZAS}"]`,r).length){var s;const e=null===(s=qc(`gone[xmlns="${Uc.NS.STANZAS}"]`,r).pop())||void 0===s?void 0:s.textContent.replace(/^xmpp:/,"").replace(/\?join$/,"");this.save({moved_jid:e,destroyed_reason:o}),this.session.save({connection_status:Xu.ROOMSTATUS.DESTROYED})}else if(r.querySelector("conflict"))this.onNicknameClash(t);else if(r.querySelector("item-not-found")){const t=e("This groupchat does not (yet) exist.");this.setDisconnectionMessage(t,o)}else if(r.querySelector("service-unavailable")){const t=e("This groupchat has reached its maximum number of participants.");this.setDisconnectionMessage(t,o)}else if(r.querySelector("remote-server-not-found")){const t=e("Remote server not found"),n=o?e('The explanation given is: "%1$s".',o):void 0;this.setDisconnectionMessage(t,n)}},onPresence(e){if("error"===e.getAttribute("type"))return this.onErrorPresence(e);this.createInfoMessages(e),e.querySelector("status[code='110']")?(this.onOwnPresence(e),"none"!==this.getOwnRole()&&this.session.get("connection_status")===Xu.ROOMSTATUS.CONNECTING&&this.session.save("connection_status",Xu.ROOMSTATUS.CONNECTED)):this.updateOccupantsOnPresence(e)},onOwnPresence(e){if("unavailable"!==e.getAttribute("type")){const t=this.session.get("connection_status");t!==Xu.ROOMSTATUS.ENTERED?(this.session.save("connection_status",Xu.ROOMSTATUS.ENTERED,{silent:!0}),this.updateOccupantsOnPresence(e),this.session.trigger("change:connection_status",this.session,t)):this.updateOccupantsOnPresence(e)}else this.updateOccupantsOnPresence(e);if("unavailable"===e.getAttribute("type"))this.handleDisconnection(e);else{if(e.querySelector("status[code='201']"))if(this.get("auto_configure"))this.autoConfigureChatRoom().then(()=>this.refreshDiscoInfo());else{if(!zu.settings.get("muc_instant_rooms"))return void this.trigger("configurationNeeded");this.sendConfiguration().then(()=>this.refreshDiscoInfo())}else this.features.get("fetched")||("owner"===this.getOwnAffiliation()&&this.get("auto_configure")?this.autoConfigureChatRoom().then(()=>this.refreshDiscoInfo()):this.getDiscoInfo())}this.session.save({connection_status:Xu.ROOMSTATUS.ENTERED})},isUserMentioned(e){const t=this.get("nick");if(e.get("references").length){return e.get("references").filter(e=>"mention"===e.type).map(e=>e.value).includes(t)}return new RegExp(`\\b${t}\\b`).test(e.get("message"))},handleUnreadMessage(e){if(null!=e&&e.get("body")&&Rc.isNewMessage(e))if(this.isHidden()){const t={num_unread_general:this.get("num_unread_general")+1};0===this.get("num_unread_general")&&(t.first_unread_id=e.get("id")),this.isUserMentioned(e)&&(t.num_unread=this.get("num_unread")+1),this.save(t)}else this.sendMarkerForMessage(e)},clearUnreadMsgCounter(){(this.get("num_unread_general")>0||this.get("num_unread")>0)&&this.sendMarkerForMessage(this.messages.last()),Rc.safeSave(this,{num_unread:0,num_unread_general:0})}}),Pu.ChatRoomOccupant=Uo.extend({defaults:{hats:[],show:"offline",states:[]},initialize(e){this.set(Object.assign({id:Rc.getUniqueId()},e)),this.on("change:image_hash",this.onAvatarChanged,this)},onAvatarChanged(){const e=this.get("image_hash"),t=[];this.get("jid")&&t.push(Pu.vcards.findWhere({jid:this.get("jid")})),t.push(Pu.vcards.findWhere({jid:this.get("from")})),t.filter(e=>e).forEach(t=>{e&&t.get("image_hash")!==e&&zu.vcard.update(t,!0)})},getDisplayName(){return this.get("nick")||this.get("jid")},isMember(){return["admin","owner","member"].includes(this.get("affiliation"))},isModerator(){return["admin","owner"].includes(this.get("affiliation"))||"moderator"===this.get("role")},isSelf(){return this.get("states").includes("110")}}),Pu.ChatRoomOccupants=ea.extend({model:Pu.ChatRoomOccupant,comparator(e,t){const n=e.get("role")||"none",r=t.get("role")||"none";if(Lc[n]===Lc[r]){const n=e.getDisplayName().toLowerCase(),r=t.getDisplayName().toLowerCase();return n<r?-1:n>r?1:0}return Lc[n]<Lc[r]?-1:1},getAutoFetchedAffiliationLists(){const e=zu.settings.get("muc_fetch_members");return Array.isArray(e)?e:e?["member","admin","owner"]:[]},async fetchMembers(){const e=this.getAutoFetchedAffiliationLists();if(0===e.length)return;const t=await Promise.all(e.map(e=>this.chatroom.getAffiliationList(e))),n=t.reduce((e,t)=>Rc.isErrorObject(t)?e:[...t,...e],[]),r=e.filter(n=>!Rc.isErrorObject(t[e.indexOf(n)])),i=n.map(e=>e.jid).filter(e=>void 0!==e),o=n.map(e=>!e.jid&&e.nick||void 0).filter(e=>void 0!==e);this.filter(e=>r.includes(e.get("affiliation"))&&!o.includes(e.get("nick"))&&!i.includes(e.get("jid"))).forEach(e=>{e.get("jid")!==Pu.bare_jid&&("offline"===e.get("show")?e.destroy():e.save("affiliation",null))}),n.forEach(e=>{const t=e.jid?this.findOccupant({jid:e.jid}):this.findOccupant({nick:e.nick});t?t.save(e):this.create(e)}),zu.trigger("membersFetched")},findOccupant(e){const t=Uc.getBareJidFromJid(e.jid);return t&&this.findWhere({jid:t})||this.findWhere({nick:e.nick})}}),Pu.RoomsPanelModel=Uo.extend({defaults:function(){return{muc_domain:zu.settings.get("muc_domain"),nick:Pu.getDefaultMUCNickname()}},setDomain(e){zu.settings.get("locked_muc_domain")||this.save("muc_domain",Uc.getDomainFromJid(e))}}),Pu.onDirectMUCInvitation=async function(t){const n=qc('x[xmlns="jabber:x:conference"]',t).pop(),r=Uc.getBareJidFromJid(t.getAttribute("from")),i=n.getAttribute("jid"),o=n.getAttribute("reason");let s;if(zu.settings.get("auto_join_on_invite"))s=!0;else{let t=Pu.roster.get(r);t=t?t.getDisplayName():r,s=o?confirm(e('%1$s has invited you to join a groupchat: %2$s, and left the following reason: "%3$s"',t,i,o)):confirm(e("%1$s has invited you to join a groupchat: %2$s",t,i))}if(!0===s){(await async function(e,t){t.type=Pu.CHATROOMS_TYPE,t.id=e;const n=await zu.rooms.get(e,t,!0);return n.maybeShow(!0),n}(i,{password:n.getAttribute("password")})).session.get("connection_status")===Xu.ROOMSTATUS.DISCONNECTED&&Pu.chatboxes.get(i).rejoin()}},zu.settings.get("allow_muc_invitations")){const e=function(){Pu.connection.addHandler(e=>(Pu.onDirectMUCInvitation(e),!0),"jabber:x:conference","message")};zu.listen.on("connected",e),zu.listen.on("reconnected",e)}function r(){return Pu.chatboxes.filter(e=>e.get("type")===Pu.CHATROOMS_TYPE).forEach(e=>e.session.save({connection_status:Xu.ROOMSTATUS.DISCONNECTED}))}zu.listen.on("beforeTearDown",()=>{Pu.chatboxes.where({type:Pu.CHATROOMS_TYPE}).forEach(e=>Rc.safeSave(e.session,{connection_status:Xu.ROOMSTATUS.DISCONNECTED}))}),zu.listen.on("windowStateChanged",(async function(e){if("visible"===e.state&&zu.connection.connected()){(await zu.rooms.get()).forEach(e=>e.rejoinIfNecessary())}})),zu.listen.on("addClientFeatures",()=>{zu.settings.get("allow_muc")&&zu.disco.own.features.add(Uc.NS.MUC),zu.settings.get("allow_muc_invitations")&&zu.disco.own.features.add("jabber:x:conference")}),zu.listen.on("chatBoxesFetched",(async function(){await Promise.all(zu.settings.get("auto_join_rooms").map(e=>"string"==typeof e?Pu.chatboxes.where({jid:e}).length?Promise.resolve():zu.rooms.open(e):j(e)?zu.rooms.open(e.jid,{...e}):(kn.error('Invalid muc criteria specified for "auto_join_rooms"'),Promise.resolve()))),zu.trigger("roomsAutoJoined")})),zu.listen.on("beforeResourceBinding",()=>{Pu.connection.addHandler(e=>{const t=Uc.getBareJidFromJid(e.getAttribute("from"));return Pu.chatboxes.get(t)||zu.waitUntil("chatBoxesFetched").then(async()=>{const n=Pu.chatboxes.get(t);n&&(await n.initialized,n.message_handler.run(e))}),!0},null,"message","groupchat")}),zu.listen.on("disconnected",r),zu.listen.on("statusInitialized",()=>{window.addEventListener(Pu.unloadevent,()=>{!zu.connection.isType("websocket")||zu.settings.get("enable_smacks")&&Pu.session.get("smacks_stream_id")||r()})}),Xu.env.muc_utils=Ic,Object.assign(zu,{rooms:{create(e,t={}){if(!(t="string"==typeof t?{nick:t}:t||{}).nick&&zu.settings.get("muc_nickname_from_jid")&&(t.nick=Uc.getNodeFromJid(Pu.bare_jid)),void 0===e)throw new TypeError("rooms.create: You need to provide at least one JID");return"string"==typeof e?zu.rooms.get(Rc.getJIDFromURI(e),t,!0):e.map(e=>zu.rooms.get(Rc.getJIDFromURI(e),t,!0))},async open(e,t={},n=!1){if(await zu.waitUntil("chatBoxesFetched"),void 0===e){const e="rooms.open: You need to provide at least one JID";throw kn.error(e),new TypeError(e)}if("string"==typeof e){const r=await zu.rooms.get(e,t,!0);return r&&r.maybeShow(n),r}{const r=await Promise.all(e.map(e=>zu.rooms.get(e,t,!0)));return r.forEach(e=>e.maybeShow(n)),r}},async get(e,t={},n=!1){async function r(e){e=Rc.getJIDFromURI(e);let r=await zu.chatboxes.get(e);return!r&&n?r=await zu.chatboxes.create(e,t,Pu.ChatRoom):(r=r&&r.get("type")===Pu.CHATROOMS_TYPE?r:null,r&&Object.keys(t).length&&r.save(t)),r}if(void 0===e){return(await zu.chatboxes.get()).filter(e=>e.get("type")===Pu.CHATROOMS_TYPE)}return"string"==typeof e?r(e):Promise.all(e.map(e=>r(e)))}}})}});
/**
 * @module converse-bookmarks
 * @description
 * Converse.js plugin which adds views for bookmarks specified in XEP-0048.
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */
const{Strophe:Jc,$iq:Wc,sizzle:Vc}=Xu.env,Gc=Xu.env.utils;function Yc(e){return Vc(`event[xmlns="${Jc.NS.PUBSUB}#event"] items[node="${Jc.NS.BOOKMARKS}"]`,e).length&&zu.waitUntil("bookmarksInitialized").then(()=>Pu.bookmarks.createBookmarksFromStanza(e)).catch(e=>kn.fatal(e)),!0}Jc.addNamespace("BOOKMARKS","storage:bookmarks"),Xu.plugins.add("converse-bookmarks",{dependencies:["converse-chatboxes","converse-muc"],overrides:{ChatRoom:{getDisplayName(){const{_converse:e}=this.__super__;if(this.get("bookmarked")&&e.bookmarks){const t=e.bookmarks.findWhere({jid:this.get("jid")});if(t)return t.get("name")}return this.__super__.getDisplayName.apply(this,arguments)},getAndPersistNickname(e){const{_converse:t}=this.__super__;return e=e||t.getNicknameFromBookmark(this.get("jid")),this.__super__.getAndPersistNickname.call(this,e)}}},initialize(){const{__:e}=Pu;zu.settings.extend({allow_bookmarks:!0,allow_public_bookmarks:!1,muc_respect_autojoin:!0}),zu.promises.add("bookmarksInitialized"),Pu.getNicknameFromBookmark=function(e){if(!Pu.bookmarks||!zu.settings.get("allow_bookmarks"))return null;const t=Pu.bookmarks.findWhere({jid:e});return t?t.get("nick"):void 0},Pu.Bookmark=Uo.extend({idAttribute:"jid",getDisplayName(){return Jc.xmlunescape(this.get("name"))}}),Pu.Bookmarks=ea.extend({model:Pu.Bookmark,comparator:e=>e.get("name").toLowerCase(),initialize(){this.on("add",e=>this.openBookmarkedRoom(e).then(e=>this.markRoomAsBookmarked(e)).catch(e=>kn.fatal(e))),this.on("remove",this.markRoomAsUnbookmarked,this),this.on("remove",this.sendBookmarkStanza,this);const e="converse.room-bookmarks"+Pu.bare_jid;this.fetched_flag=e+"fetched",this.browserStorage=Pu.createStore(e)},async openBookmarkedRoom(e){if(zu.settings.get("muc_respect_autojoin")&&e.get("autojoin")){(await zu.rooms.create(e.get("jid"),{nick:e.get("nick")})).maybeShow()}return e},fetchBookmarks(){const e=Gc.getResolveablePromise();return window.sessionStorage.getItem(this.fetched_flag)?this.fetch({success:()=>e.resolve(),error:()=>e.resolve()}):this.fetchBookmarksFromServer(e),e},createBookmark(e){this.create(e),this.sendBookmarkStanza().catch(t=>this.onBookmarkError(t,e))},sendBookmarkStanza(){const e=Wc({type:"set",from:Pu.connection.jid}).c("pubsub",{xmlns:Jc.NS.PUBSUB}).c("publish",{node:Jc.NS.BOOKMARKS}).c("item",{id:"current"}).c("storage",{xmlns:Jc.NS.BOOKMARKS});return this.forEach(t=>{e.c("conference",{name:t.get("name"),autojoin:t.get("autojoin"),jid:t.get("jid")}).c("nick").t(t.get("nick")).up().up()}),e.up().up().up(),e.c("publish-options").c("x",{xmlns:Jc.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t("http://jabber.org/protocol/pubsub#publish-options").up().up().c("field",{var:"pubsub#persist_items"}).c("value").t("true").up().up().c("field",{var:"pubsub#access_model"}).c("value").t("whitelist"),zu.sendIQ(e)},onBookmarkError(t,n){kn.error("Error while trying to add bookmark"),kn.error(t),zu.alert("error",e("Error"),[e("Sorry, something went wrong while trying to save your bookmark.")]),this.findWhere({jid:n.jid}).destroy()},fetchBookmarksFromServer(e){const t=Wc({from:Pu.connection.jid,type:"get"}).c("pubsub",{xmlns:Jc.NS.PUBSUB}).c("items",{node:Jc.NS.BOOKMARKS});zu.sendIQ(t).then(t=>this.onBookmarksReceived(e,t)).catch(t=>this.onBookmarksReceivedError(e,t))},markRoomAsBookmarked(e){const t=Pu.chatboxes.get(e.get("jid"));void 0!==t&&t.save("bookmarked",!0)},markRoomAsUnbookmarked(e){const t=Pu.chatboxes.get(e.get("jid"));void 0!==t&&t.save("bookmarked",!1)},createBookmarksFromStanza(e){const t=Jc.NS.BOOKMARKS;Vc(`items[node="${t}"] item storage[xmlns="${t}"] conference`,e).forEach(e=>{var t;const n=e.getAttribute("jid"),r=this.get(n),i={jid:n,name:e.getAttribute("name")||n,autojoin:"true"===e.getAttribute("autojoin"),nick:(null===(t=e.querySelector("nick"))||void 0===t?void 0:t.textContent)||""};r?r.save(i):this.create(i)})},onBookmarksReceived(e,t){if(this.createBookmarksFromStanza(t),window.sessionStorage.setItem(this.fetched_flag,!0),void 0!==e)return e.resolve()},onBookmarksReceivedError(t,n){if(null===n)kn.error("Error: timeout while fetching bookmarks"),zu.alert("error",e("Timeout Error"),[e("The server did not return your bookmarks within the allowed time. You can reload the page to request them again.")]);else{if(t)return n.querySelector('error[type="cancel"] item-not-found')?(window.sessionStorage.setItem(this.fetched_flag,!0),t.resolve()):(kn.error("Error while fetching bookmarks"),kn.error(n),t.reject(new Error("Could not fetch bookmarks")));kn.error("Error while fetching bookmarks"),kn.error(n)}},getUnopenedBookmarks(){return this.filter(e=>!Pu.chatboxes.get(e.get("jid")))}}),Pu.BookmarksList=Uo.extend({defaults:{"toggle-state":Pu.OPENED}}),Pu.checkBookmarksSupport=async function(){const e=await zu.disco.getIdentity("pubsub","pep",Pu.bare_jid);return Pu.allow_public_bookmarks?!!e:zu.disco.supports(Jc.NS.PUBSUB+"#publish-options",Pu.bare_jid)};const t=async function(){zu.settings.get("allow_bookmarks")&&await Pu.checkBookmarksSupport()&&(Pu.bookmarks=new Pu.Bookmarks,await Pu.bookmarks.fetchBookmarks(),zu.trigger("bookmarksInitialized"))};zu.listen.on("addClientFeatures",()=>{zu.settings.get("allow_bookmarks")&&zu.disco.own.features.add(Jc.NS.BOOKMARKS+"+notify")}),zu.listen.on("clearSession",()=>{void 0!==Pu.bookmarks&&(Pu.bookmarks.clearStore({silent:!0}),window.sessionStorage.removeItem(Pu.bookmarks.fetched_flag),delete Pu.bookmarks)}),zu.listen.on("reconnected",t),zu.listen.on("connected",async()=>{const{connection:e}=Pu;e.addHandler(Yc,null,"message","headline",null,Pu.bare_jid),await Promise.all([zu.waitUntil("chatBoxesFetched")]),t()})}});n(142);
/**
 * @module converse-bosh
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description Converse.js plugin which add support for XEP-0206: XMPP Over BOSH
 */const{Strophe:Xc}=Xu.env;Xu.plugins.add("converse-bosh",{enabled:()=>!Pu.api.settings.get("blacklisted_plugins").includes("converse-bosh"),initialize(){zu.settings.extend({bosh_service_url:void 0,prebind_url:null}),Pu.startNewPreboundBOSHSession=function(){if(!zu.settings.get("prebind_url"))throw new Error("startNewPreboundBOSHSession: If you use prebind then you MUST supply a prebind_url");const e=new XMLHttpRequest;e.open("GET",zu.settings.get("prebind_url"),!0),e.setRequestHeader("Accept","application/json, text/javascript"),e.onload=async function(){if(e.status>=200&&e.status<400){const t=JSON.parse(e.responseText),n=await Pu.setUserJID(t.jid);Pu.connection.attach(n,t.sid,t.rid,Pu.connection.onConnectStatusChanged)}else e.onerror()},e.onerror=function(){delete Pu.connection,zu.trigger("noResumeableBOSHSession",Pu)},e.send()},Pu.restoreBOSHSession=async function(){const e=(await async function(){const e="converse.bosh-session";if(Pu.bosh_session||(Pu.bosh_session=new Uo({id:e}),Pu.bosh_session.browserStorage=Pu.createStore(e,"session"),await new Promise(e=>Pu.bosh_session.fetch({success:e,error:e}))),Pu.jid){if(Pu.bosh_session.get("jid")!==Pu.jid){const e=await Pu.setUserJID(Pu.jid);Pu.bosh_session.clear({silent:!0}),Pu.bosh_session.save({jid:e})}}else{const e=Pu.bosh_session.get("jid");e&&await Pu.setUserJID(e)}return Pu.bosh_session}()).get("jid");if(e&&Pu.connection._proto instanceof Xc.Bosh)try{return Pu.connection.restore(e,Pu.connection.onConnectStatusChanged),!0}catch(t){return!Pu.isTestEnv()&&kn.warn("Could not restore session for jid: "+e+" Error message: "+t.message),!1}return!1},zu.listen.on("clearSession",()=>{if(void 0===Pu.bosh_session){const e="converse.bosh-session";sessionStorage.removeItem(e),sessionStorage.removeItem(`${e}-${e}`)}else Pu.bosh_session.destroy(),delete Pu.bosh_session}),zu.listen.on("setUserJID",()=>{void 0!==Pu.bosh_session&&Pu.bosh_session.save({jid:Pu.jid})}),zu.listen.on("addClientFeatures",()=>zu.disco.own.features.add(Xc.NS.BOSH)),Object.assign(zu,{tokens:{get:e=>void 0===Pu.connection?null:"rid"===e.toLowerCase()?Pu.connection.rid||Pu.connection._proto.rid:"sid"===e.toLowerCase()?Pu.connection.sid||Pu.connection._proto.sid:void 0}})}});var Qc=n(4);
/**
 * @module converse-caps
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */const{Strophe:Kc,$build:Zc}=Xu.env;function ed(e,t){return e.sort((e,n)=>e[t]>n[t]?-1:1)}function td(e){const t=e.api.disco.own.identities.get(),n=e.api.disco.own.features.get();t.length>1&&(ed(t,"category"),ed(t,"type"),ed(t,"lang"));let r=t.reduce((e,t)=>{var n;return`${e}${t.category}/${t.type}/${null!==(n=null==t?void 0:t.lang)&&void 0!==n?n:""}/${t.name}<`},"");return n.sort(),r=n.reduce((e,t)=>`${e}${t}<`,r),Qc.a.b64_sha1(r)}
/**
 * @module converse-carbons
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description Implements support for XEP-0280 Message Carbons
 */
function nd(e){var t,n;e&&(null===(n=Pu.session)||void 0===n||n.set({carbons_enabled:!1}));if(!zu.settings.get("message_carbons")||null!==(t=Pu.session)&&void 0!==t&&t.get("carbons_enabled"))return;const r=new Aa.e.Builder("iq",{from:Pu.connection.jid,id:"enablecarbons",type:"set"}).c("enable",{xmlns:Aa.e.NS.CARBONS});Pu.connection.addHandler(e=>{e.querySelectorAll("error").length>0?kn.warn("An error occurred while trying to enable message carbons."):(Pu.session.set({carbons_enabled:!0}),kn.debug("Message carbons have been enabled.")),Pu.session.save()},null,"iq",null,"enablecarbons"),Pu.connection.send(r)}Kc.addNamespace("CAPS","http://jabber.org/protocol/caps"),Xu.plugins.add("converse-caps",{overrides:{XMPPStatus:{constructPresence(){const e=this.__super__.constructPresence.apply(this,arguments);var t;return e.root().cnode((t=this.__super__._converse,Zc("c",{xmlns:Kc.NS.CAPS,hash:"sha-1",node:"https://conversejs.org",ver:td(t)}).nodeTree)),e}}}}),Xu.plugins.add("converse-carbons",{initialize(){zu.settings.extend({message_carbons:!0}),zu.listen.on("afterResourceBinding",nd)}});
/**
 * @module converse-chatboxes
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */
const{Strophe:rd}=Xu.env;rd.addNamespace("MESSAGE_CORRECT","urn:xmpp:message-correct:0"),rd.addNamespace("RECEIPTS","urn:xmpp:receipts"),rd.addNamespace("REFERENCE","urn:xmpp:reference:0"),rd.addNamespace("MARKERS","urn:xmpp:chat-markers:0"),Xu.plugins.add("converse-chatboxes",{dependencies:["converse-emoji","converse-roster","converse-vcard"],initialize(){async function e(e,t,n){let r;e=rd.getBareJidFromJid(e.toLowerCase()),Object.assign(t,{jid:e,id:e});try{r=new n(t,{collection:Pu.chatboxes})}catch(e){return kn.error(e),null}return await r.initialized,r.isValid()?(Pu.chatboxes.add(r),r):(r.destroy(),null)}zu.promises.add(["chatBoxesFetched","chatBoxesInitialized","privateChatsAutoJoined"]),Pu.ChatBoxes=ea.extend({comparator:"time_opened",model:(e,t)=>new Pu.ChatBox(e,t),onChatBoxesFetched(e){e.filter(e=>!e.isValid()).forEach(e=>e.destroy()),zu.trigger("chatBoxesFetched")},onConnected(e){e||(this.browserStorage=Pu.createStore("converse.chatboxes-"+Pu.bare_jid),this.fetch({add:!0,success:e=>this.onChatBoxesFetched(e)}))}}),zu.listen.on("addClientFeatures",()=>{zu.disco.own.features.add(rd.NS.MESSAGE_CORRECT),zu.disco.own.features.add(rd.NS.HTTPUPLOAD),zu.disco.own.features.add(rd.NS.OUTOFBAND)}),zu.listen.on("pluginsInitialized",()=>{Pu.chatboxes=new Pu.ChatBoxes,zu.trigger("chatBoxesInitialized")}),zu.listen.on("presencesInitialized",e=>Pu.chatboxes.onConnected(e)),zu.listen.on("reconnected",()=>Pu.chatboxes.forEach(e=>e.onReconnection())),Object.assign(zu,{chatboxes:{create:async(t=[],n={},r)=>(await zu.waitUntil("chatBoxesFetched"),"string"==typeof t?e(t,n,r):Promise.all(t.map(t=>e(t,n,r)))),get:async e=>(await zu.waitUntil("chatBoxesFetched"),void 0===e?Pu.chatboxes.models:"string"==typeof e?Pu.chatboxes.get(e.toLowerCase()):(e=e.map(e=>e.toLowerCase()),Pu.chatboxes.models.filter(t=>e.includes(t.get("jid")))))}})}}),Xu.plugins.add("converse-headlines",{dependencies:["converse-chat"],overrides:{ChatBoxes:{model(e,t){const{_converse:n}=this.__super__;return e.type==n.HEADLINES_TYPE?new n.HeadlinesBox(e,t):this.__super__.model.apply(this,arguments)}}},initialize(){function e(){Pu.connection.addHandler(e=>async function(e){if(fs.isHeadline(e)||fs.isServerMessage(e)){const t=e.getAttribute("from");if(t.includes("@")&&!Pu.roster.get(t)&&!zu.settings.get("allow_non_roster_messaging"))return;if(null===e.querySelector("body"))return;const n=Pu.chatboxes.create({id:t,jid:t,type:Pu.HEADLINES_TYPE,from:t}),r=await fs.parseMessage(e,Pu);await n.createMessage(r),zu.trigger("message",{chatbox:n,stanza:e,attrs:r})}}(e)||!0,null,"message")}Pu.HeadlinesBox=Pu.ChatBox.extend({defaults(){return{bookmarked:!1,hidden:["mobile","fullscreen"].includes(zu.settings.get("view_mode")),message_type:"headline",num_unread:0,time_opened:this.get("time_opened")||(new Date).getTime(),type:Pu.HEADLINES_TYPE}},async initialize(){this.set({box_id:"box-"+this.get("jid")}),this.initMessages(),await this.fetchMessages(),zu.trigger("headlinesBoxInitialized",this)}}),zu.listen.on("connected",e),zu.listen.on("reconnected",e),Object.assign(zu,{headlines:{async get(e,t={},n=!1){async function r(e){let r=await zu.chatboxes.get(e);return!r&&n?r=await zu.chatboxes.create(e,t,Pu.HeadlinesBox):(r=r&&r.get("type")===Pu.HEADLINES_TYPE?r:null,r&&Object.keys(t).length&&r.save(t)),r}if(void 0===e){return(await zu.chatboxes.get()).filter(e=>e.get("type")===Pu.HEADLINES_TYPE)}return"string"==typeof e?r(e):Promise.all(e.map(e=>r(e)))}}})}});
/**
 * @module converse-rsm
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description XEP-0059 Result Set Management
 *   Some code taken from the Strophe RSM plugin, licensed under the MIT License
 *   Copyright 2006-2017 Strophe (https://github.com/strophe/strophejs)
 */
const{Strophe:id,$build:od}=Xu.env;id.addNamespace("RSM","http://jabber.org/protocol/rsm");const sd=["after","before","index","max"],ad=e=>Number(e),ud=e=>e.toString(),cd={after:ud,before:ud,count:ad,first:ud,index:ad,last:ud,max:ad},dd=e=>void 0===e,ld=Object.keys(cd);class fd{static getQueryParameters(e={}){return Lo(e,sd)}static parseXMLResult(e){const t={};for(var n=0;n<ld.length;n++){const r=ld[n],i=e.getElementsByTagName(r)[0];dd(i)||null===i||(t[r]=cd[r](id.getText(i)),"first"==r&&(t.index=cd.index(i.getAttribute("index"))))}return t}constructor(e={}){this.query=fd.getQueryParameters(e),this.result=e.xml?fd.parseXMLResult(e.xml):{}}toXML(){const e=od("set",{xmlns:id.NS.RSM});return sd.reduce((e,t)=>dd(this.query[t])?e:e.c(t).t((this.query[t]||"").toString()).up(),e).tree()}next(e,t){const n=Object.assign({},this.query,{after:this.result.last,before:t,max:e});return new fd(n)}previous(e,t){const n=Object.assign({},this.query,{after:t,before:this.result.first,max:e});return new fd(n)}}Pu.RSM_ATTRIBUTES=ld,Pu.RSM=fd;
/**
 * @module converse-mam
 * @description XEP-0313 Message Archive Management
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */
const{Strophe:hd,$iq:pd,dayjs:gd}=Xu.env,{NS:md}=hd,vd=Xu.env.utils,_d={fetchNewestMessages(){if(this.disable_mam)return;const e=this.getMostRecentMessage();if(e&&!zu.settings.get("clear_messages_on_reconnection")){const t=e.get("stanza_id "+this.get("jid"));t?this.fetchArchivedMessages({after:t},"forwards"):this.fetchArchivedMessages({start:e.get("time")},"forwards")}else this.fetchArchivedMessages({before:""})},async handleMAMResult(e,t,n,r){await zu.emojis.initialize();const i=this.get("type")===Pu.CHATROOMS_TYPE;e.messages=e.messages.map(e=>i?fs.parseMUCMessage(e,this,Pu):fs.parseMessage(e,Pu));const o={query:t,chatbox:this,messages:e.messages};if(await zu.trigger("MAMResult",o,{synchronous:!0}),e.messages.forEach(e=>this.queueMessage(e)),e.error){const t=e.error.retry_event_id=vd.getUniqueId();zu.listen.once(t,()=>this.fetchArchivedMessages(n,r)),this.createMessageFromError(e.error)}},async fetchArchivedMessages(e={},t){if(this.disable_mam)return;const n=this.get("type")===Pu.CHATROOMS_TYPE,r=n?this.get("jid"):Pu.bare_jid;if(!await zu.disco.supports(md.MAM,r))return;const i=zu.settings.get("archived_messages_page_size"),o=Object.assign({groupchat:n,max:i,with:this.get("jid")},e),s=await zu.archive.query(o);return await this.handleMAMResult(s,o,e,t),t&&s.rsm&&!s.complete?("forwards"===t?e=s.rsm.next(i,e.before).query:"backwards"===t&&(e=s.rsm.previous(i,e.after).query),this.fetchArchivedMessages(e,t)):void 0}};Xu.plugins.add("converse-mam",{dependencies:["converse-disco","converse-muc"],initialize(){function e(e){zu.settings.get("muc_show_logs_before_join")&&e.features.get("mam_enabled")&&!e.get("prejoin_mam_fetched")&&(e.fetchNewestMessages(),e.save({prejoin_mam_fetched:!0}))}zu.settings.extend({archived_messages_page_size:"50",message_archiving:void 0,message_archiving_timeout:2e4}),Object.assign(Pu.ChatBox.prototype,_d),Pu.onMAMError=function(e){null!=e&&e.querySelectorAll("feature-not-implemented").length?kn.warn("Message Archive Management (XEP-0313) not supported by "+e.getAttribute("from")):(kn.error(`Error while trying to set archiving preferences for ${e.getAttribute("from")}.`),kn.error(e))},Pu.onMAMPreferences=function(e,t){const n=fr()(`prefs[xmlns="${md.MAM}"]`,e).pop();if(n.getAttribute("default")!==zu.settings.get("message_archiving")){const e=pd({type:"set"}).c("prefs",{xmlns:md.MAM,default:zu.settings.get("message_archiving")});Array.from(n.children).forEach(t=>e.cnode(t).up()),zu.sendIQ(e).then(()=>t.save({preferences:{default:zu.settings.get("message_archiving")}})).catch(Pu.onMAMError)}else t.save({preferences:{default:zu.settings.get("message_archiving")}})},zu.listen.on("addClientFeatures",()=>zu.disco.own.features.add(md.MAM)),zu.listen.on("serviceDiscovered",(function(e){const t=e.get("preferences")||{};e.get("var")===md.MAM&&void 0!==zu.settings.get("message_archiving")&&t.default!==zu.settings.get("message_archiving")&&zu.sendIQ(pd({type:"get"}).c("prefs",{xmlns:md.MAM})).then(t=>Pu.onMAMPreferences(t,e)).catch(Pu.onMAMError)})),zu.listen.on("chatRoomViewInitialized",t=>{zu.settings.get("muc_show_logs_before_join")&&(e(t.model),t.model.features.on("change:mam_enabled",()=>e(t.model)))}),zu.listen.on("enteredNewRoom",e=>e.features.get("mam_enabled")&&e.fetchNewestMessages()),zu.listen.on("chatReconnected",e=>{e.get("type")===Pu.PRIVATE_CHAT_TYPE&&e.fetchNewestMessages()}),zu.listen.on("afterMessagesFetched",e=>{e.get("type")!==Pu.PRIVATE_CHAT_TYPE||Pu.connection.restored||e.fetchNewestMessages()}),Object.assign(zu,{archive:{async query(e){if(!zu.connection.connected())throw new Error("Can't call `api.archive.query` before having established an XMPP session");const t={type:"set"};if(e&&e.groupchat){if(!e.with)throw new Error('You need to specify a "with" value containing the chat room JID, when querying groupchat messages.');t.to=e.with}const n=t.to||Pu.bare_jid;if(!await zu.disco.supports(md.MAM,n))return kn.warn(`Did not fetch MAM archive for ${n} because it doesn't support ${md.MAM}`),{messages:[]};const r=vd.getUniqueId(),i=pd(t).c("query",{xmlns:md.MAM,queryid:r});if(e){i.c("x",{xmlns:md.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t(md.MAM).up().up(),e.with&&!e.groupchat&&i.c("field",{var:"with"}).c("value").t(e.with).up().up(),["start","end"].forEach(t=>{if(e[t]){const n=gd(e[t]);if(!n.isValid())throw new TypeError("archive.query: invalid date provided for: "+t);i.c("field",{var:t}).c("value").t(n.toISOString()).up().up()}}),i.up();const t=new fd(e);Object.keys(t.query).length&&i.cnode(t.toXML())}const o=[],s=Pu.connection.addHandler(t=>{const n=fr()(`message > result[xmlns="${md.MAM}"]`,t).pop();if(void 0===n||n.getAttribute("queryid")!==r)return!0;const i=t.getAttribute("from")||Pu.bare_jid;if(e.groupchat){if(i!==e.with)return kn.warn("Ignoring alleged groupchat MAM message from "+t.getAttribute("from")),!0}else if(i!==Pu.bare_jid)return kn.warn("Ignoring alleged MAM message from "+t.getAttribute("from")),!0;return o.push(t),!0},md.MAM);let a;const u=await zu.sendIQ(i,zu.settings.get("message_archiving_timeout"),!1);if(null===u){const{__:e}=Pu,t=e("Timeout while trying to fetch archived messages.");return kn.error(t),a=new Pu.TimeoutError(t),{messages:o,error:a}}if(vd.isErrorStanza(u)){const{__:e}=Pu,t=e("An error occurred while querying for archived messages.");return kn.error(t),kn.error(u),a=new Error(t),{messages:o,error:a}}let c;Pu.connection.deleteHandler(s);const d=u&&fr()(`fin[xmlns="${md.MAM}"]`,u).pop(),l="true"===(null==d?void 0:d.getAttribute("complete")),f=fr()(`set[xmlns="${md.RSM}"]`,d).pop();return f&&(c=new fd({...e,xml:f})),{messages:o,rsm:c,complete:l}}}})}});
/**
 * @module converse-ping
 * @description
 * Converse.js plugin which add support for application-level pings
 * as specified in XEP-0199 XMPP Ping.
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */
const{Strophe:yd,$iq:bd}=Xu.env,wd=Xu.env.utils;yd.addNamespace("PING","urn:xmpp:ping"),Xu.plugins.add("converse-ping",{initialize(){let e;function t(t){e=new Date;const n=t.getAttribute("from"),r=t.getAttribute("id"),i=bd({type:"result",to:n,id:r});return Pu.connection.sendIQ(i),!0}zu.settings.extend({ping_interval:60}),setTimeout(()=>{if(zu.settings.get("ping_interval")>0){const t=new Date;return e||(e=t),!((t-e)/1e3>zu.settings.get("ping_interval"))||zu.ping()}},1e3);const n=function(){void 0!==Pu.connection.disco&&zu.disco.own.features.add(yd.NS.PING),Pu.connection.addHandler(t,yd.NS.PING,"iq","get"),Pu.connection.addHandler(()=>{if(zu.settings.get("ping_interval")>0)return e=new Date,!0})};zu.listen.on("connected",n),zu.listen.on("reconnected",n),zu.listen.on("windowStateChanged",(function(e){"visible"===e.state&&zu.connection.connected()&&zu.ping(null,5e3)})),Object.assign(zu,{async ping(t,n){if(e=new Date,t=t||yd.getDomainFromJid(Pu.bare_jid),Pu.connection){const e=bd({type:"get",to:t,id:wd.getUniqueId("ping")}).c("ping",{xmlns:yd.NS.PING}),r=await zu.sendIQ(e,n||1e4,!1);return null===r?(kn.warn("Timeout while pinging "+t),t===yd.getDomainFromJid(Pu.bare_jid)&&zu.connection.reconnect()):wd.isErrorStanza(r)&&(kn.error("Error while pinging "+t),kn.error(r)),!0}return!1}})}});
/**
 * @module converse-pubsub
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */
const{Strophe:Sd,$iq:xd}=Xu.env;Sd.addNamespace("PUBSUB_ERROR",Sd.NS.PUBSUB+"#errors"),Xu.plugins.add("converse-pubsub",{dependencies:["converse-disco"],initialize(){Object.assign(Pu.api,{pubsub:{async publish(e,t,n,r,i=!0){const o=xd({from:Pu.bare_jid,type:"set",to:e}).c("pubsub",{xmlns:Sd.NS.PUBSUB}).c("publish",{node:t}).cnode(n.tree()).up().up();r&&(e=e||Pu.bare_jid,await zu.disco.supports(Sd.NS.PUBSUB+"#publish-options",e)?(o.c("publish-options").c("x",{xmlns:Sd.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t(Sd.NS.PUBSUB+"#publish-options").up().up(),Object.keys(r).forEach(e=>o.c("field",{var:e}).c("value").t(r[e]).up().up())):kn.warn(`_converse.api.publish: ${e} does not support #publish-options, so we didn't set them even though they were provided.`));try{await zu.sendIQ(o)}catch(e){if(!(e instanceof Element&&i&&e.querySelector(`precondition-not-met[xmlns="${Sd.NS.PUBSUB_ERROR}"]`)))throw e;{const e=o.nodeTree;e.querySelector("publish-options").outerHTML="",kn.warn("PubSub: Republishing without publish options. "+e.outerHTML),await zu.sendIQ(e)}}}}})}});var Ed=function(e){return"number"==typeof e||Se(e)&&"[object Number]"==O(e)};var Ad=function(e){return Ed(e)&&e!=+e};
/**
 * @module converse-status
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */const{Strophe:Nd,$build:Td,$pres:Od}=Xu.env;Xu.plugins.add("converse-status",{initialize(){function e(e){zu.trigger("statusInitialized",e)}function t(t){if(t=void 0!==Pu.xmppstatus&&t)e(t);else{const n="converse.xmppstatus-"+Pu.bare_jid;Pu.xmppstatus=new Pu.XMPPStatus({id:n}),Pu.xmppstatus.browserStorage=Pu.createStore(n,"session"),Pu.xmppstatus.fetch({success:()=>e(t),error:()=>e(t),silent:!0})}}zu.settings.extend({auto_away:0,auto_xa:0,csi_waiting_time:0,default_state:"online",priority:0}),zu.promises.add(["statusInitialized"]),Pu.XMPPStatus=Uo.extend({defaults:()=>({status:zu.settings.get("default_state")}),initialize(){this.on("change",e=>{j(e.changed)&&("status"in e.changed||"status_message"in e.changed)&&zu.user.presence.send(this.get("status"),null,this.get("status_message"))})},getNickname:()=>Pu.nickname,getFullname:()=>"",constructPresence(e,t=null,n){let r;e="string"==typeof e?e:this.get("status")||zu.settings.get("default_state"),n="string"==typeof n?n:this.get("status_message");const i={to:t};"unavailable"===e||"probe"===e||"error"===e||"unsubscribe"===e||"unsubscribed"===e||"subscribe"===e||"subscribed"===e?(i.type=e,r=Od(i)):"offline"===e?(i.type="unavailable",r=Od(i)):r="online"===e?Od(i):Od(i).c("show").t(e).up(),n&&r.c("status").t(n).up();const o=zu.settings.get("priority");if(r.c("priority").t(Ad(Number(o))?0:o).up(),Pu.idle){const e=new Date;e.setSeconds(e.getSeconds()-Pu.idle_seconds),r.c("idle",{xmlns:Nd.NS.IDLE,since:e.toISOString()})}return r}}),Pu.sendCSI=function(e){zu.send(Td(e,{xmlns:Nd.NS.CSI})),Pu.inactive=e===Pu.INACTIVE},Pu.onUserActivity=function(){var e;Pu.idle_seconds>0&&(Pu.idle_seconds=0),null!==(e=Pu.connection)&&void 0!==e&&e.authenticated&&(Pu.inactive&&Pu.sendCSI(Pu.ACTIVE),Pu.idle&&(Pu.idle=!1,zu.user.presence.send()),!0===Pu.auto_changed_status&&(Pu.auto_changed_status=!1,Pu.xmppstatus.set("status",zu.settings.get("default_state"))))},Pu.onEverySecond=function(){var e;if(null===(e=Pu.connection)||void 0===e||!e.authenticated)return;const t=Pu.xmppstatus.get("status");Pu.idle_seconds++,zu.settings.get("csi_waiting_time")>0&&Pu.idle_seconds>zu.settings.get("csi_waiting_time")&&!Pu.inactive&&Pu.sendCSI(Pu.INACTIVE),zu.settings.get("idle_presence_timeout")>0&&Pu.idle_seconds>zu.settings.get("idle_presence_timeout")&&!Pu.idle&&(Pu.idle=!0,zu.user.presence.send()),zu.settings.get("auto_away")>0&&Pu.idle_seconds>zu.settings.get("auto_away")&&"away"!==t&&"xa"!==t&&"dnd"!==t?(Pu.auto_changed_status=!0,Pu.xmppstatus.set("status","away")):zu.settings.get("auto_xa")>0&&Pu.idle_seconds>zu.settings.get("auto_xa")&&"xa"!==t&&"dnd"!==t&&(Pu.auto_changed_status=!0,Pu.xmppstatus.set("status","xa"))},Pu.registerIntervalHandler=function(){if(zu.settings.get("auto_away")<1&&zu.settings.get("auto_xa")<1&&zu.settings.get("csi_waiting_time")<1&&zu.settings.get("idle_presence_timeout")<1)return;Pu.idle_seconds=0,Pu.auto_changed_status=!1;const{unloadevent:e}=Pu;window.addEventListener("click",Pu.onUserActivity),window.addEventListener("focus",Pu.onUserActivity),window.addEventListener("keypress",Pu.onUserActivity),window.addEventListener("mousemove",Pu.onUserActivity),window.addEventListener(e,Pu.onUserActivity,{once:!0,passive:!0}),window.addEventListener(e,()=>{var e;return null===(e=Pu.session)||void 0===e?void 0:e.save("active",!1)}),Pu.everySecondTrigger=window.setInterval(Pu.onEverySecond,1e3)},zu.listen.on("presencesInitialized",e=>{e||Pu.registerIntervalHandler()}),zu.listen.on("clearSession",()=>{Pu.shouldClearCache()&&Pu.xmppstatus&&(Pu.xmppstatus.destroy(),delete Pu.xmppstatus,zu.promises.add(["statusInitialized"]))}),zu.listen.on("connected",()=>t(!1)),zu.listen.on("reconnected",()=>t(!0)),Object.assign(Pu.api.user,{presence:{async send(e,t,n){await zu.waitUntil("statusInitialized"),zu.send(Pu.xmppstatus.constructPresence(e,t,n))}},status:{get:async()=>(await zu.waitUntil("statusInitialized"),Pu.xmppstatus.get("status")),async set(e,t){const n={status:e};if(!Object.keys(Pu.STATUS_WEIGHTS).includes(e))throw new Error("Invalid availability value. See https://xmpp.org/rfcs/rfc3921.html#rfc.section.2.2.2.1");"string"==typeof t&&(n.status_message=t),await zu.waitUntil("statusInitialized"),Pu.xmppstatus.save(n)},message:{get:async()=>(await zu.waitUntil("statusInitialized"),Pu.xmppstatus.get("status_message")),async set(e){await zu.waitUntil("statusInitialized"),Pu.xmppstatus.save({status_message:e})}}}})}});var jd=function(e){return function(t){return null==e?void 0:po(e,t)}};var Cd=function(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n};var Id=function(e){return e&&e.length?Cd(e,gr):0};
/**
 * @module converse-roster
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */const{Strophe:Rd,$iq:Md,$pres:kd,dayjs:Dd,sizzle:Pd}=Xu.env,Fd=Xu.env.utils;Xu.plugins.add("converse-roster",{dependencies:["converse-status"],initialize(){const{__:e}=Pu;zu.settings.extend({allow_contact_requests:!0,auto_subscribe:!1,synchronize_availability:!0}),zu.promises.add(["cachedRoster","roster","rosterContactsFetched","rosterGroupsFetched","rosterInitialized"]),Pu.HEADER_CURRENT_CONTACTS=e("My contacts"),Pu.HEADER_PENDING_CONTACTS=e("Pending contacts"),Pu.HEADER_REQUESTING_CONTACTS=e("Contact requests"),Pu.HEADER_UNGROUPED=e("Ungrouped"),Pu.HEADER_UNREAD=e("New messages");const t={};t[Pu.HEADER_UNREAD]=0,t[Pu.HEADER_REQUESTING_CONTACTS]=1,t[Pu.HEADER_CURRENT_CONTACTS]=2,t[Pu.HEADER_UNGROUPED]=3,t[Pu.HEADER_PENDING_CONTACTS]=4,Pu.registerPresenceHandler=function(){Pu.unregisterPresenceHandler(),Pu.presence_ref=Pu.connection.addHandler(e=>(Pu.roster.presenceHandler(e),!0),null,"presence",null)},Pu.rejectPresenceSubscription=function(e,t){const n=kd({to:e,type:"unsubscribed"});t&&""!==t&&n.c("status").t(t),zu.send(n)},Pu.sendInitialPresence=function(){Pu.send_initial_presence&&zu.user.presence.send()},Pu.populateRoster=async function(e=!1){e&&(Pu.send_initial_presence=!0);try{await Pu.rostergroups.fetchRosterGroups(),zu.trigger("rosterGroupsFetched"),await Pu.roster.fetchRosterContacts(),zu.trigger("rosterContactsFetched")}catch(e){kn.error(e)}finally{Pu.sendInitialPresence()}};const n=Uo.extend({idAttribute:"name"}),r=ea.extend({model:n});function i(e){const t=Pu.roster&&Pu.roster.findWhere({jid:e.get("jid")});void 0!==t&&t.save({num_unread:e.get("num_unread")})}async function o(){Pu.presences&&await Pu.presences.clearStore()}Pu.Presence=Uo.extend({defaults:{show:"offline"},initialize(){this.resources=new r;const e="converse.identities-"+this.get("jid");this.resources.browserStorage=Pu.createStore(e,"session"),this.listenTo(this.resources,"update",this.onResourcesChanged),this.listenTo(this.resources,"change",this.onResourcesChanged)},onResourcesChanged(){var e;const t=this.getHighestPriorityResource(),n=(null==t||null===(e=t.attributes)||void 0===e?void 0:e.show)||"offline";this.get("show")!==n&&this.save({show:n})},getHighestPriorityResource(){return this.resources.sortBy(e=>`${e.get("priority")}-${e.get("timestamp")}`).reverse()[0]},addResource(e){const t=e.getAttribute("from"),n=Rd.getResourceFromJid(t),r=Pd(`delay[xmlns="${Rd.NS.DELAY}"]`,e).pop(),i=jd(e.querySelector("priority"))("textContent")||0,o=this.resources.get(n),s={name:n,priority:Ad(parseInt(i,10))?0:parseInt(i,10),show:jd(e.querySelector("show"))("textContent")||"online",timestamp:r?Dd(r.getAttribute("stamp")).toISOString():(new Date).toISOString()};o?o.save(s):this.resources.create(s)},removeResource(e){const t=this.resources.get(e);t&&t.destroy()}}),Pu.Presences=ea.extend({model:Pu.Presence}),Pu.RosterContact=Uo.extend({defaults:{chat_state:void 0,image:Pu.DEFAULT_IMAGE,image_type:Pu.DEFAULT_IMAGE_TYPE,num_unread:0,status:void 0},async initialize(e){this.initialized=Fd.getResolveablePromise(),this.setPresence();const{jid:t}=e,n=Rd.getBareJidFromJid(t).toLowerCase();e.jid=n,this.set(Object.assign({groups:[],id:n,jid:n,user_id:Rd.getNodeFromJid(t)},e)),this.listenTo(this.presence,"change:show",()=>zu.trigger("contactPresenceChanged",this)),this.listenTo(this.presence,"change:show",()=>this.trigger("presenceChanged")),await zu.trigger("rosterContactInitialized",this,{Synchronous:!0}),this.initialized.resolve()},setPresence(){const e=this.get("jid");this.presence=Pu.presences.findWhere({jid:e})||Pu.presences.create({jid:e})},openChat(){const e=this.attributes;zu.chats.open(e.jid,e,!0)},getFilterCriteria(){const e=this.get("nickname"),t=this.get("jid");let n=this.getDisplayName();return n=n.includes(t)?n:n.concat("   "+t),n=n.includes(e)?n:n.concat("   "+e),n.toLowerCase()},getDisplayName(){return this.get("nickname")?this.get("nickname"):this.get("jid")},getFullname(){return this.get("jid")},subscribe(e){const t=kd({to:this.get("jid"),type:"subscribe"});e&&""!==e&&t.c("status").t(e).up();const n=Pu.xmppstatus.getNickname()||Pu.xmppstatus.getFullname();return n&&t.c("nick",{xmlns:Rd.NS.NICK}).t(n).up(),zu.send(t),this.save("ask","subscribe"),this},ackSubscribe(){zu.send(kd({type:"subscribe",to:this.get("jid")}))},ackUnsubscribe(){zu.send(kd({type:"unsubscribe",to:this.get("jid")})),this.removeFromRoster(),this.destroy()},unauthorize(e){return Pu.rejectPresenceSubscription(this.get("jid"),e),this},authorize(e){const t=kd({to:this.get("jid"),type:"subscribed"});return e&&""!==e&&t.c("status").t(e),zu.send(t),this},removeFromRoster(){const e=Md({type:"set"}).c("query",{xmlns:Rd.NS.ROSTER}).c("item",{jid:this.get("jid"),subscription:"remove"});return zu.sendIQ(e)}}),Pu.RosterContacts=ea.extend({model:Pu.RosterContact,comparator(e,t){const n=e.presence.get("show")||"offline",r=t.presence.get("show")||"offline";if(Pu.STATUS_WEIGHTS[n]===Pu.STATUS_WEIGHTS[r]){const n=e.getDisplayName().toLowerCase(),r=t.getDisplayName().toLowerCase();return n<r?-1:n>r?1:0}return Pu.STATUS_WEIGHTS[n]<Pu.STATUS_WEIGHTS[r]?-1:1},onConnected(){this.registerRosterHandler(),this.registerRosterXHandler()},registerRosterHandler(){Pu.connection.addHandler(e=>(Pu.roster.onRosterPush(e),!0),Rd.NS.ROSTER,"iq","set")},registerRosterXHandler(){let e=0;Pu.connection.addHandler((function(t){return window.setTimeout((function(){Pu.connection.flush(),Pu.roster.subscribeToSuggestedItems.bind(Pu.roster)(t)}),e),e+=250*t.querySelectorAll("item").length,!0}),Rd.NS.ROSTERX,"message",null)},async fetchRosterContacts(){const e=await new Promise((e,t)=>{this.fetch({add:!0,silent:!0,success:e,error:(e,n)=>t(n)})});if(Fd.isErrorObject(e)&&(kn.error(e),Pu.session.set("roster_cached",!1),this.data.save("version",void 0)),!Pu.session.get("roster_cached"))return Pu.send_initial_presence=!0,Pu.roster.fetchFromServer();zu.trigger("cachedRoster",e)},subscribeToSuggestedItems:e=>(Array.from(e.querySelectorAll("item")).forEach(e=>{"add"===e.getAttribute("action")&&Pu.roster.addAndSubscribe(e.getAttribute("jid"),Pu.xmppstatus.getNickname()||Pu.xmppstatus.getFullname())}),!0),isSelf:e=>Fd.isSameBareJID(e,Pu.connection.jid),async addAndSubscribe(e,t,n,r,i){const o=await this.addContactToRoster(e,t,n,i);o instanceof Pu.RosterContact&&o.subscribe(r)},sendContactAddIQ(e,t,n){t=t||null;const r=Md({type:"set"}).c("query",{xmlns:Rd.NS.ROSTER}).c("item",{jid:e,name:t});return n.forEach(e=>r.c("group").t(e).up()),zu.sendIQ(r)},async addContactToRoster(t,n,r,i){await zu.waitUntil("rosterContactsFetched"),r=r||[];try{await this.sendContactAddIQ(t,n,r)}catch(r){return kn.error(r),alert(e("Sorry, there was an error while trying to add %1$s as a contact.",n||t)),r}return this.create(Object.assign({ask:void 0,nickname:n,groups:r,jid:t,requesting:!1,subscription:"none"},i),{sort:!1})},async subscribeBack(e,t){const n=this.get(e);if(n instanceof Pu.RosterContact)n.authorize().subscribe();else{var r;const n=(null===(r=Pd(`nick[xmlns="${Rd.NS.NICK}"]`,t).pop())||void 0===r?void 0:r.textContent)||null,i=await this.addContactToRoster(e,n,[],{subscription:"from"});i instanceof Pu.RosterContact&&i.authorize().subscribe()}},getNumOnlineContacts(){const e=["offline","unavailable"];return Id(this.models.filter(t=>!e.includes(t.presence.get("show"))))},onRosterPush(e){const t=e.getAttribute("id"),n=e.getAttribute("from");if(n&&n!==Pu.bare_jid)return void kn.warn("Ignoring roster illegitimate roster push message from "+e.getAttribute("from"));zu.send(Md({type:"result",id:t,from:Pu.connection.jid}));const r=Pd(`query[xmlns="${Rd.NS.ROSTER}"]`,e).pop();this.data.save("version",r.getAttribute("ver"));const i=Pd("item",r);if(i.length>1)throw kn.error(e),new Error('Roster push query may not contain more than one "item" element.');if(0===i.length)return kn.warn(e),void kn.warn('Received a roster push stanza without an "item" element.');this.updateContact(i.pop()),zu.trigger("rosterPush",e)},rosterVersioningSupported(){return zu.disco.stream.getFeature("ver","urn:xmpp:features:rosterver")&&this.data.get("version")},async fetchFromServer(){const e=Md({type:"get",id:Fd.getUniqueId("roster")}).c("query",{xmlns:Rd.NS.ROSTER});this.rosterVersioningSupported()&&e.attrs({ver:this.data.get("version")});const t=await zu.sendIQ(e,null,!1);if("error"!==t.getAttribute("type")){const e=Pd(`query[xmlns="${Rd.NS.ROSTER}"]`,t).pop();if(e){Pd("item",e).forEach(e=>this.updateContact(e)),this.data.save("version",e.getAttribute("ver"))}}else if(!Fd.isServiceUnavailableError(t))return kn.error(t),void kn.error("Error while trying to fetch roster from the server");Pu.session.save("roster_cached",!0),zu.trigger("roster",t)},updateContact(e){const t=e.getAttribute("jid"),n=this.get(t),r=e.getAttribute("subscription"),i=e.getAttribute("ask"),o=Array.from(e.getElementsByTagName("group")).map(e=>e.textContent);if(n){if("remove"===r)return n.destroy();n.save({subscription:r,ask:i,nickname:e.getAttribute("name"),requesting:null,groups:o})}else{if("none"===r&&null===i||"remove"===r)return;this.create({ask:i,nickname:e.getAttribute("name"),groups:o,jid:t,subscription:r},{sort:!1})}},createRequestingContact(e){var t;const n={jid:Rd.getBareJidFromJid(e.getAttribute("from")),subscription:"none",ask:null,requesting:!0,nickname:(null===(t=Pd(`nick[xmlns="${Rd.NS.NICK}"]`,e).pop())||void 0===t?void 0:t.textContent)||null};zu.trigger("contactRequest",this.create(n))},handleIncomingSubscription(t){const n=t.getAttribute("from"),r=Rd.getBareJidFromJid(n),i=this.get(r);zu.settings.get("allow_contact_requests")||Pu.rejectPresenceSubscription(n,e("This client does not allow presence subscriptions")),zu.settings.get("auto_subscribe")?i&&"to"===i.get("subscription")?i.authorize():this.subscribeBack(r,t):i?("none"!==i.get("subscription")||"subscribe"===i.get("ask"))&&i.authorize():this.createRequestingContact(t)},handleOwnPresence(e){const t=e.getAttribute("from"),n=Rd.getResourceFromJid(t),r=e.getAttribute("type");if(Pu.connection.jid!==t&&"unavailable"!==r&&(!0===zu.settings.get("synchronize_availability")||zu.settings.get("synchronize_availability")===n)){const t=jd(e.querySelector("show"))("textContent")||"online";Pu.xmppstatus.save({status:t},{silent:!0});const n=jd(e.querySelector("status"))("textContent");n&&Pu.xmppstatus.save({status_message:n})}Pu.jid===t&&"unavailable"===r&&zu.user.presence.send()},presenceHandler(e){const t=e.getAttribute("type");if("error"===t)return!0;const n=e.getAttribute("from"),r=Rd.getBareJidFromJid(n);if(this.isSelf(r))return this.handleOwnPresence(e);if(Pd(`query[xmlns="${Rd.NS.MUC}"]`,e).length)return;const i=jd(e.querySelector("status"))("textContent"),o=this.get(r);if(o&&i!==o.get("status")&&o.save({status:i}),"subscribed"===t&&o)o.ackSubscribe();else if("unsubscribed"===t&&o)o.ackUnsubscribe();else{if("unsubscribe"===t)return;if("subscribe"===t)this.handleIncomingSubscription(e);else if("unavailable"===t&&o){const e=Rd.getResourceFromJid(n);o.presence.removeResource(e)}else o&&o.presence.addResource(e)}}}),Pu.RosterGroup=Uo.extend({initialize(t){this.set(Object.assign({description:e("Click to hide these contacts"),state:Pu.OPENED},t)),this.contacts=new Pu.RosterContacts}}),Pu.RosterGroups=ea.extend({model:Pu.RosterGroup,comparator(e,n){e=e.get("name"),n=n.get("name");const r=t,i=Object.keys(t),o=i.includes(e),s=i.includes(n);if(!o&&!s)return e.toLowerCase()<n.toLowerCase()?-1:e.toLowerCase()>n.toLowerCase()?1:0;if(o&&s)return r[e]<r[n]?-1:r[e]>r[n]?1:0;if(!o&&s){const e=Pu.HEADER_CURRENT_CONTACTS;return r[e]<r[n]?-1:r[e]>r[n]?1:0}if(o&&!s){const t=Pu.HEADER_CURRENT_CONTACTS;return r[e]<r[t]?-1:r[e]>r[t]?1:0}},fetchRosterGroups(){return new Promise(e=>{this.fetch({success:e,silent:!0})})}}),Pu.unregisterPresenceHandler=function(){void 0!==Pu.presence_ref&&(Pu.connection.deleteHandler(Pu.presence_ref),delete Pu.presence_ref)},zu.listen.on("chatBoxesInitialized",()=>{Pu.chatboxes.on("change:num_unread",i),Pu.chatboxes.on("add",e=>{e.get("type")===Pu.PRIVATE_CHAT_TYPE&&e.setRosterContact(e.get("jid"))})}),zu.listen.on("beforeTearDown",()=>Pu.unregisterPresenceHandler()),zu.waitUntil("rosterContactsFetched").then(()=>{Pu.roster.on("add",e=>{const t=Pu.chatboxes.findWhere({jid:e.get("jid")});t&&t.setRosterContact(e.get("jid"))})}),zu.listen.on("streamResumptionFailed",()=>Pu.session.set("roster_cached",!1)),zu.listen.on("clearSession",async()=>{await o(),Pu.shouldClearCache()&&(Pu.rostergroups&&(await Pu.rostergroups.clearStore(),delete Pu.rostergroups),Pu.roster&&(Ca(Pu,"roster.data.destroy"),await Pu.roster.clearStore(),delete Pu.roster))}),zu.listen.on("statusInitialized",async e=>{if(e)!Pu.connection.hasResumed()&&await o();else{Pu.presences=new Pu.Presences;const e="converse.presences-"+Pu.bare_jid;Pu.presences.browserStorage=Pu.createStore(e,"session"),Pu.presences.fetch()}zu.trigger("presencesInitialized",e)}),zu.listen.on("presencesInitialized",async e=>{e?zu.trigger("rosterReadyAfterReconnection"):await async function(){await zu.waitUntil("VCardsInitialized"),Pu.roster=new Pu.RosterContacts;let e="converse.contacts-"+Pu.bare_jid;Pu.roster.browserStorage=Pu.createStore(e),Pu.roster.data=new Uo,e="converse-roster-model-"+Pu.bare_jid,Pu.roster.data.id=e,Pu.roster.data.browserStorage=Pu.createStore(e),Pu.roster.data.fetch(),e="converse.roster.groups"+Pu.bare_jid,Pu.rostergroups=new Pu.RosterGroups,Pu.rostergroups.browserStorage=Pu.createStore(e),zu.trigger("rosterInitialized")}(),Pu.roster.onConnected(),Pu.registerPresenceHandler(),Pu.populateRoster(!Pu.connection.restored)}),Object.assign(Pu.api,{contacts:{async get(e){await zu.waitUntil("rosterContactsFetched");const t=e=>Pu.roster.get(Rd.getBareJidFromJid(e));if(void 0===e)e=Pu.roster.pluck("jid");else if("string"==typeof e)return t(e);return e.map(t)},async add(e,t){if(await zu.waitUntil("rosterContactsFetched"),"string"!=typeof e||!e.includes("@"))throw new TypeError("contacts.add: invalid jid");return Pu.roster.addAndSubscribe(e,t)}}})}});
/**
 * @module converse-smacks
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description Converse.js plugin which adds support for XEP-0198: Stream Management
 */
const{Strophe:Ld}=Xu.env,Ud=Xu.env.utils;function zd(){return!(zu.connection.isType("bosh")&&!Pu.isTestEnv())&&zu.disco.stream.getFeature("sm",Ld.NS.SM)}function Bd(e){if(!Pu.session.get("smacks_enabled"))return!0;const t=parseInt(e.getAttribute("h"),10),n=Pu.session.get("num_stanzas_handled_by_server"),r=t-n;if(r<0){const e=`New reported stanza count lower than previous. New: ${t} - Previous: ${n}`;kn.error(e)}const i=Pu.session.get("unacked_stanzas");if(r>i.length){const e=`Higher reported acknowledge count than unacknowledged stanzas. Reported Acknowledged Count: ${r} -Unacknowledged Stanza Count: ${i.length} -New: ${t} - Previous: ${n}`;kn.error(e)}return Pu.session.save({num_stanzas_handled_by_server:t,num_stanzas_since_last_ack:0,unacked_stanzas:i.slice(r)}),!0}function $d(){if(Pu.session.get("smacks_enabled")){const e=Pu.session.get("num_stanzas_handled"),t=Ud.toStanza(`<a xmlns="${Ld.NS.SM}" h="${e}"/>`);zu.send(t)}return!0}function Hd(e){if(Pu.session.get("smacks_enabled")&&(Ud.isTagEqual(e,"iq")||Ud.isTagEqual(e,"presence")||Ud.isTagEqual(e,"message"))){const e=Pu.session.get("num_stanzas_handled");Pu.session.save("num_stanzas_handled",e+1)}return!0}function qd(){Pu.session.save({smacks_enabled:Pu.session.get("smacks_enabled")||!1,num_stanzas_handled:Pu.session.get("num_stanzas_handled")||0,num_stanzas_handled_by_server:Pu.session.get("num_stanzas_handled_by_server")||0,num_stanzas_since_last_ack:Pu.session.get("num_stanzas_since_last_ack")||0,unacked_stanzas:Pu.session.get("unacked_stanzas")||[]})}function Jd(){Pu.session&&Pu.session.save({smacks_enabled:!1,num_stanzas_handled:0,num_stanzas_handled_by_server:0,num_stanzas_since_last_ack:0,unacked_stanzas:[]})}function Wd(e){const t={smacks_enabled:!0};return["1","true"].includes(e.getAttribute("resume"))&&(t.smacks_stream_id=e.getAttribute("id")),Pu.session.save(t),!0}function Vd(e){return e.querySelector("item-not-found")?kn.warn("Could not resume previous SMACKS session, session id not found. A new session will be established."):(kn.error("Failed to enable stream management"),kn.error(e.outerHTML)),Jd(),zu.trigger("streamResumptionFailed"),!0}function Gd(e){Wd(e),Bd(e),function(){const e=Pu.session.get("unacked_stanzas");Pu.session.save("unacked_stanzas",[]),e.forEach(e=>zu.send(e))}(),Pu.connection.do_bind=!1,Pu.connection.authenticated=!0,Pu.connection.restored=!0,Pu.connection._changeConnectStatus(Ld.Status.CONNECTED,null)}async function Yd(){if(zu.settings.get("enable_smacks")&&!Pu.session.get("smacks_enabled")&&await zd()){const e=Ud.getResolveablePromise();Pu.connection._addSysHandler(t=>e.resolve(Wd(t)),Ld.NS.SM,"enabled"),Pu.connection._addSysHandler(t=>e.resolve(Vd(t)),Ld.NS.SM,"failed");const t=zu.connection.isType("websocket")||Pu.isTestEnv(),n=Ud.toStanza(`<enable xmlns="${Ld.NS.SM}" resume="${t}"/>`);zu.send(n),Pu.connection.flush(),await e}}Ld.addNamespace("SM","urn:xmpp:sm:3");const Xd=[];async function Qd(){if(!zu.settings.get("enable_smacks"))return;if(!await zd())return;const e=Pu.connection;for(;Xd.length;)e.deleteHandler(Xd.pop());Xd.push(e.addHandler(Hd)),Xd.push(e.addHandler($d,Ld.NS.SM,"r")),Xd.push(e.addHandler(Bd,Ld.NS.SM,"a")),Pu.session.get("smacks_stream_id")?await async function(){const e=Ud.getResolveablePromise();Pu.connection._addSysHandler(t=>e.resolve(Gd(t)),Ld.NS.SM,"resumed"),Pu.connection._addSysHandler(t=>e.resolve(Vd(t)),Ld.NS.SM,"failed");const t=Pu.session.get("smacks_stream_id"),n=Pu.session.get("num_stanzas_handled"),r=Ud.toStanza(`<resume xmlns="${Ld.NS.SM}" h="${n}" previd="${t}"/>`);zu.send(r),Pu.connection.flush(),await e}():Jd()}function Kd(e){if(Pu.session){if(Pu.session.get("smacks_enabled")&&(Ud.isTagEqual(e,"iq")||Ud.isTagEqual(e,"presence")||Ud.isTagEqual(e,"message"))){const t=Ld.serialize(e);Pu.session.save("unacked_stanzas",(Pu.session.get("unacked_stanzas")||[]).concat([t]));const n=zu.settings.get("smacks_max_unacked_stanzas");if(n>0){const e=Pu.session.get("num_stanzas_since_last_ack")+1;e%n==0&&zu.send(Ud.toStanza(`<r xmlns="${Ld.NS.SM}"/>`)),Pu.session.save({num_stanzas_since_last_ack:e})}}}else kn.warn("No _converse.session!")}Xu.plugins.add("converse-smacks",{initialize(){zu.settings.extend({enable_smacks:!0,smacks_max_unacked_stanzas:5}),zu.listen.on("afterResourceBinding",Yd),zu.listen.on("beforeResourceBinding",Qd),zu.listen.on("send",Kd),zu.listen.on("userSessionInitialized",qd)}});
/**
 * @module converse-vcard
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */
const{Strophe:Zd,$iq:el,dayjs:tl}=Xu.env,nl=Xu.env.utils;Xu.plugins.add("converse-vcard",{dependencies:["converse-status","converse-roster"],overrides:{XMPPStatus:{getNickname(){const{_converse:e}=this.__super__,t=this.__super__.getNickname.apply(this);return!t&&e.xmppstatus.vcard?e.xmppstatus.vcard.get("nickname"):t},getFullname(){const{_converse:e}=this.__super__,t=this.__super__.getFullname.apply(this);return!t&&e.xmppstatus.vcard?e.xmppstatus.vcard.get("fullname"):t}},RosterContact:{getDisplayName(){return!this.get("nickname")&&this.vcard?this.vcard.getDisplayName():this.__super__.getDisplayName.apply(this)},getFullname(){return this.vcard?this.vcard.get("fullname"):this.__super__.getFullname.apply(this)}}},initialize(){function e(e,t,n){const r=el(t?{type:e,to:t}:{type:e});return n?r.cnode(n):r.c("vCard",{xmlns:Zd.NS.VCARD}),r}async function t(t,n){const r=Zd.getBareJidFromJid(n)===t.bare_jid?null:n;let i;try{i=await zu.sendIQ(e("get",r))}catch(i){return{stanza:i,jid:n,vcard_error:(new Date).toISOString()}}return async function(e,t){const n=t.querySelector("vCard");let r={};var i,o,s,a,u,c,d;if(null!==n&&(r={stanza:t,fullname:null===(i=n.querySelector("FN"))||void 0===i?void 0:i.textContent,nickname:null===(o=n.querySelector("NICKNAME"))||void 0===o?void 0:o.textContent,image:null===(s=n.querySelector("PHOTO BINVAL"))||void 0===s?void 0:s.textContent,image_type:null===(a=n.querySelector("PHOTO TYPE"))||void 0===a?void 0:a.textContent,url:null===(u=n.querySelector("URL"))||void 0===u?void 0:u.textContent,role:null===(c=n.querySelector("ROLE"))||void 0===c?void 0:c.textContent,email:null===(d=n.querySelector("EMAIL USERID"))||void 0===d?void 0:d.textContent,vcard_updated:(new Date).toISOString(),vcard_error:void 0}),r.image){const e=nl.base64ToArrayBuffer(r.image),t=await crypto.subtle.digest("SHA-1",e);r.image_hash=nl.arrayBufferToHex(t)}return r}(0,i)}async function n(e){let t;if(e instanceof Pu.Message){if("error"===e.get("type"))return;t=e.get("from")}else t=e.get("jid");await zu.waitUntil("VCardsInitialized"),e.vcard=Pu.vcards.findWhere({jid:t}),e.vcard||(e.vcard=Pu.vcards.create({jid:t})),e.vcard.on("change",()=>e.trigger("vcard:change"))}async function r(e){await zu.waitUntil("VCardsInitialized"),["error","info"].includes(e.get("type"))||(e.vcard=function(e){var t;const n=null==e||null===(t=e.collection)||void 0===t?void 0:t.chatbox,r=Zd.getResourceFromJid(e.get("from"));if(n&&n.get("nick")===r)return Pu.xmppstatus.vcard;{const t=e.occupant&&e.occupant.get("jid")||e.get("from");return t?Pu.vcards.findWhere({jid:t})||Pu.vcards.create({jid:t}):void kn.error("Could not assign VCard for message because no JID found! msgid: "+e.get("msgid"))}}(e))}zu.promises.add("VCardsInitialized"),Pu.VCard=Uo.extend({defaults:{image:Pu.DEFAULT_IMAGE,image_type:Pu.DEFAULT_IMAGE_TYPE},set(e,t,n){let r;return"object"==typeof e?(r=e,n=t):(r={})[e]=t,"image"in r&&!r.image?(r.image=Pu.DEFAULT_IMAGE,r.image_type=Pu.DEFAULT_IMAGE_TYPE,Uo.prototype.set.call(this,r,n)):Uo.prototype.set.apply(this,arguments)},getDisplayName(){return this.get("nickname")||this.get("fullname")||this.get("jid")}}),Pu.VCards=ea.extend({model:Pu.VCard,initialize(){this.on("add",e=>e.get("jid")&&zu.vcard.update(e))}}),Pu.initVCardCollection=async function(){Pu.vcards=new Pu.VCards,Pu.vcards.browserStorage=Pu.createStore(Pu.bare_jid+"-converse.vcards"),await new Promise(e=>{Pu.vcards.fetch({success:e,error:e},{silent:!0})});const e=Pu.vcards;if(Pu.session){const t=Pu.session.get("bare_jid");Pu.xmppstatus.vcard=e.findWhere({jid:t})||e.create({jid:t})}zu.trigger("VCardsInitialized")},zu.listen.on("chatBoxInitialized",e=>n(e)),zu.listen.on("chatRoomInitialized",e=>n(e)),zu.listen.on("chatRoomMessageInitialized",e=>r(e)),zu.listen.on("addClientFeatures",()=>zu.disco.own.features.add(Zd.NS.VCARD)),zu.listen.on("clearSession",()=>{Pu.shouldClearCache()&&(zu.promises.add("VCardsInitialized"),Pu.vcards&&(Pu.vcards.clearStore(),delete Pu.vcards))}),zu.listen.on("messageInitialized",e=>n(e)),zu.listen.on("rosterContactInitialized",e=>n(e)),zu.listen.on("statusInitialized",Pu.initVCardCollection),Object.assign(Pu.api,{vcard:{async set(t,n){if(!t)throw Error("No jid provided for the VCard data");const r=document.createElement("div"),i=nl.toStanza(`\n                        <vCard xmlns="vcard-temp">\n                            <FN>${n.fn}</FN>\n                            <NICKNAME>${n.nickname}</NICKNAME>\n                            <URL>${n.url}</URL>\n                            <ROLE>${n.role}</ROLE>\n                            <EMAIL><INTERNET/><PREF/><USERID>${n.email}</USERID></EMAIL>\n                            <PHOTO>\n                                <TYPE>${n.image_type}</TYPE>\n                                <BINVAL>${n.image}</BINVAL>\n                            </PHOTO>\n                        </vCard>`,r);let o;try{o=await zu.sendIQ(e("set",t,i))}catch(e){throw e}return await zu.vcard.update(t,!0),o},get(e,n){if("string"==typeof e)return t(Pu,e);if(!n&&e.get("vcard_updated")&&tl(e.get("vcard_error")).isSame(new Date,"day"))return Promise.resolve({});{const n=e.get("jid");return n||kn.error("No JID to get vcard for"),t(Pu,n)}},async update(e,t){const n=await this.get(e,t);(e="string"==typeof e?Pu.vcards.findWhere({jid:e}):e)?(delete n.stanza,e.save(n)):kn.error("Could not find a VCard model for "+e)}}})}});t.default=Xu}]);
//# sourceMappingURL=converse-headless.min.js.map